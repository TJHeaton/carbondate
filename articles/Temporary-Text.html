<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="carbondate">
<title>Temporary-Text â€¢ carbondate</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Temporary-Text">
<meta property="og:description" content="carbondate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">carbondate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/carbondate.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Independent_calibration.html">Independent and Joint Radiocarbon Calibration</a>
    <a class="dropdown-item" href="../articles/Against_SPDs.html">Why not to Use SPDs</a>
    <a class="dropdown-item" href="../articles/Non-parametric-summed-density.html">Non-parametric Summed Density</a>
    <a class="dropdown-item" href="../articles/Poisson-process-modelling.html">Poisson Process Modelling</a>
    <a class="dropdown-item" href="../articles/determining-convergence.html">Determining Convergence</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TJHeaton/carbondate/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Temporary-Text</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/TJHeaton/carbondate/blob/HEAD/vignettes/Temporary-Text.Rmd" class="external-link"><code>vignettes/Temporary-Text.Rmd</code></a></small>
      <div class="d-none name"><code>Temporary-Text.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TJHeaton/carbondate" class="external-link">carbondate</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="todo---remove-this-at-end">TODO - Remove this at end<a class="anchor" aria-label="anchor" href="#todo---remove-this-at-end"></a>
</h4>
<p>For all functions, the radiocarbon determinations can be entered as
F<sup>14</sup>C concentrations or as the <sup>14</sup>C age BP. The flag
<code>F14C_inputs</code> used above (and in other functions) lets the
function know what units have been used for the radiocarbon
determinations.</p>
</div>
<div class="section level3">
<h3 id="implementing-sh-calibration">Implementing SH calibration<a class="anchor" aria-label="anchor" href="#implementing-sh-calibration"></a>
</h3>
<p>To change to using the Southern Hemisphere calibration curve SHCal20,
we can modify the function arguments accordingly:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calibration_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CalibrateSingleDetermination.html">CalibrateSingleDetermination</a></span><span class="op">(</span></span>
<span>  rc_determination <span class="op">=</span> <span class="fl">1413</span>, </span>
<span>  rc_sigma <span class="op">=</span> <span class="fl">25</span>, </span>
<span>  F14C_inputs <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  calibration_curve <span class="op">=</span> <span class="va">shcal20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">calibration_result</span>,</span>
<span>  type<span class="op">=</span><span class="st">"l"</span>, </span>
<span>  xlab <span class="op">=</span> <span class="st">"Calendar age (cal yr BP)"</span>, </span>
<span>  ylab <span class="op">=</span> <span class="st">"Posterior Probability"</span>, </span>
<span>  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Calibration of "</span>, <span class="fl">1413</span>, <span class="st">" \u00B1 "</span>, <span class="fl">25</span>, <span class="st">" "</span><span class="op">^</span><span class="fl">14</span>, <span class="st">"C yr BP using SHCal20"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1500</span>, <span class="fl">1100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Temporary-Text_files/figure-html/single_calibration_SH-1.png" width="100%"><strong>Note:</strong> This simulated SH calibration, of the same
<sup>14</sup>C determination as above, provides a slightly more recent
estimate for the calendar due to the offset (the interhemispheric
<sup>14</sup>C gradient) between <sup>14</sup>C levels in the Southern
and Northern Hemisphere.</p>
<div class="section level4">
<h4 id="old-text">Old Text<a class="anchor" aria-label="anchor" href="#old-text"></a>
</h4>
<p>We model our unknown calendar age density <span class="math inline">\(f(\theta)\)</span> as an infinite mixture of
individual calendar age clusters/phases. These individual calendar age
clusters are normal densities that can have different locations and
spreads. Such a model allows considerable flexibility into the
estimation of the joint calendar age density <span class="math inline">\(f(\theta)\)</span>, not only simple mixtures but
also</p>
<p>In some cases, this mix of normal densities may represent true and
distinct underlying normal archaeological phases, in which case
additional practical inference may be possible. However this is not
required for the method to provide good estimation, and the clusters
will be used</p>
</div>
<div class="section level4">
<h4 id="intuitive-illustration">Intuitive Illustration<a class="anchor" aria-label="anchor" href="#intuitive-illustration"></a>
</h4>
<p>We model the underlying shared calendar age distribution as an
unknown mixture of calendar age <em>clusters/phases</em>: <span class="math display">\[
f(\theta) = w_1 \textrm{Cluster}_1 + w_2 \textrm{Cluster}_2 + w_3
\textrm{Cluster}_3 + \ldots
\]</span> where each <em>cluster</em> has a normal distribution (with
unknown mean <span class="math inline">\(\mu_j\)</span> and precision
<span class="math inline">\(\tau_j^2\)</span>).</p>
<p>Each object is then considered to be drawn from one of the (infinite)
clusters which constitute the overall <span class="math inline">\(f(\theta)\)</span>. The probability that it is
drawn from a particular cluster will depend upon the relative weight
given to that specific cluster.</p>
<p>It will be more likely that an object will come from some clusters
than others. Given an object belongs to a particular cluster, its prior
calendar age will be normally distributed with the mean and variance of
that cluster. The mean and variance of each individual normal cluster
that constitutes the overall <span class="math inline">\(f(\theta)\)</span>, together with the weightings
associated to each cluster, will be estimated based upon the set of
<sup>14</sup>C determinations we observe.</p>
<p>For full technical details of the models used, and explanation of the
model parameters, see <span class="citation">[@heaton2021]</span>.</p>
</div>
</div>
<div class="section level3">
<h3 id="text-from-old-intro">Text from old Intro<a class="anchor" aria-label="anchor" href="#text-from-old-intro"></a>
</h3>
</div>
<div class="section level2">
<h2 id="additional-functions">Additional Functions<a class="anchor" aria-label="anchor" href="#additional-functions"></a>
</h2>
<div class="section level3">
<h3 id="independent-calibration">Independent calibration<a class="anchor" aria-label="anchor" href="#independent-calibration"></a>
</h3>
<p>Although this package is concerned with the calibration of multiple
related <sup>14</sup>C determinations, it can also be useful to
calibrate a single calibration independently, for example to estimate
initial values for the sampler, or for comparison. To calibrate a single
independent determination (using the provided IntCal20 calibration
curve), run the following:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calibration_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CalibrateSingleDetermination.html">CalibrateSingleDetermination</a></span><span class="op">(</span></span>
<span>  rc_determination <span class="op">=</span> <span class="fl">1413</span>, </span>
<span>  rc_sigma <span class="op">=</span> <span class="fl">25</span>, </span>
<span>  F14C_inputs <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  calibration_curve <span class="op">=</span> <span class="va">intcal20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">calibration_result</span>,</span>
<span>  type<span class="op">=</span><span class="st">"l"</span>, </span>
<span>  xlab <span class="op">=</span> <span class="st">"Calendar age (cal yr BP)"</span>, </span>
<span>  ylab <span class="op">=</span> <span class="st">"Posterior Probability"</span>,</span>
<span>  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Calibration of "</span>, <span class="fl">1413</span>, <span class="st">" \u00B1 "</span>, <span class="fl">25</span>, <span class="st">" "</span><span class="op">^</span><span class="fl">14</span>, <span class="st">"C yr BP using IntCal20"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1500</span>, <span class="fl">1100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Temporary-Text_files/figure-html/single_calibration-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="summed-probability-distributions">Summed Probability Distributions<a class="anchor" aria-label="anchor" href="#summed-probability-distributions"></a>
</h3>
<p>Currently, the most commonly-used approach to summarise calendar age
information from multiple <sup>14</sup>C determinations is via summed
probability distributions (SPD). These are <strong>not statistically
valid</strong> estimators of the calendar age of a potential future
sample. It is our view that they should not be used in any dates-as-data
approach to provide a population proxy.</p>
<p>For an SPD, the posterior calendar age density of each object is
first calculated independently) from the others as using the function
above. These individual densities are then summed/averaged to give an
SPD estimate. The independence assumed in the separate calibration of
each sample, followed by subsequent summarisation, generates a
contradiction.</p>
<p>Additionally, the SPDs approach fundamentally does not model the
samples in the calendar age domain. Consequently, it is also not able to
deal with inversions in the calibration curve where there are multiple
disjoint calendar periods which are consistent with the observed
determinations; or with plateau periods.</p>
<p>The SPD function is <strong>ONLY</strong> provided here as a
comparison with the other routines. To calculate the SPD for a set of
radiocarbon determinations (here we use the example dataset
<code>armit</code>) see the example below, where we also plot the
results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FindSummedProbabilityDistribution.html">FindSummedProbabilityDistribution</a></span><span class="op">(</span></span>
<span>  calendar_age_range_BP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">4500</span><span class="op">)</span>, </span>
<span>  rc_determinations <span class="op">=</span> <span class="va">armit</span><span class="op">$</span><span class="va">c14_age</span>, </span>
<span>  rc_sigmas <span class="op">=</span> <span class="va">armit</span><span class="op">$</span><span class="va">c14_sig</span>, </span>
<span>  F14C_inputs <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  calibration_curve <span class="op">=</span> <span class="va">intcal20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">spd</span>,</span>
<span>  type<span class="op">=</span><span class="st">"l"</span>, </span>
<span>  xlab <span class="op">=</span> <span class="st">"Calendar age (cal yr BP)"</span>, </span>
<span>  ylab <span class="op">=</span> <span class="st">"SPD Probability"</span>, </span>
<span>  xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4500</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  yaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Temporary-Text_files/figure-html/find_spd-1.png" width="100%"></p>
<p><strong>Note:</strong> The summary functions for plotting the
predictive joint calendar age density using the rigorous Bayesian
non-parametric alternative to SPDs (described in the vignette <a href="Non-parametric-summed-density.html">Non-parametric Summed
Density</a>) can also optionally plot the SPD without having to
calculate it separately first.</p>
<div class="section level4">
<h4 id="website-stuff">Website stuff<a class="anchor" aria-label="anchor" href="#website-stuff"></a>
</h4>
<p>Due to fluctuations in past radiocarbon levels, all 14C
determinations need to be calibrated (converted) in order to be
understood on the calendar age scale. In many cases, we wish to
calibrate a set of samples which are known to be related to one another
(for example, arising from a particular site, or set of sites, populated
by a particular culture). Each sample has an unknown calendar age but,
since they are related, these calendar ages are assumed to arise from
the same unknown shared calendar age density.</p>
</div>
<div class="section level4">
<h4 id="text-from-independent-calibration">Text from independent calibration<a class="anchor" aria-label="anchor" href="#text-from-independent-calibration"></a>
</h4>
<p>Introduction</p>
<p>This package is concerned with the calibration of multiple related
14C determinations. However it can also be useful to calibrate a single
calibration independently, for example to estimate initial values for
the sampler, or for comparison.</p>
</div>
<div class="section level4">
<h4 id="text-from-determining-convergence">Text from determining convergence<a class="anchor" aria-label="anchor" href="#text-from-determining-convergence"></a>
</h4>
<p>summary</p>
<p>model the posterior calendar ages are not suitable parameters to use
- rather we are interested in the number and distribution of clusters.
However, they cannot be easily compared using this diagnostic as the
number and identity of clusters can change with each iteration. For this
model, the predictive density is a much more useful indicator.</p>
</div>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Timothy J Heaton, Sara Al-assam.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
