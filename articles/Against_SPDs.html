<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Why Not to Use SPDs • carbondate</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Why Not to Use SPDs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">carbondate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/carbondate.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Independent_calibration.html">Independent and Joint Radiocarbon Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/Against_SPDs.html">Why Not to Use SPDs</a></li>
    <li><a class="dropdown-item" href="../articles/Non-parametric-summed-density.html">Non-Parametric Joint Density Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/Poisson-process-modelling.html">Poisson Process Modelling</a></li>
    <li><a class="dropdown-item" href="../articles/determining-convergence.html">Determining Convergence</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TJHeaton/carbondate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Why Not to Use SPDs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/TJHeaton/carbondate/blob/main/vignettes/Against_SPDs.Rmd" class="external-link"><code>vignettes/Against_SPDs.Rmd</code></a></small>
      <div class="d-none name"><code>Against_SPDs.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TJHeaton/carbondate" class="external-link">carbondate</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="summed-probability-distributions">Summed Probability Distributions<a class="anchor" aria-label="anchor" href="#summed-probability-distributions"></a>
</h3>
<p>Currently, the most commonly-used approach to summarise calendar age
information from multiple <sup>14</sup>C determinations is via summed
probability distributions (SPD). These are <strong>not statistically
valid</strong> estimators of the calendar age of a potential future
sample. It is our view that they should not be used in any dates-as-data
approach to provide a population proxy.</p>
<p>For an SPD, the posterior calendar age density of each object is
first calculated independently) from the others as using the function
above. These individual densities are then summed/averaged to give an
SPD estimate. The independence assumed in the separate calibration of
each sample, followed by subsequent summarisation, generates a
contradiction.</p>
<p>Additionally, the SPDs approach fundamentally does not model the
samples in the calendar age domain. Consequently, it is also not able to
deal with inversions in the calibration curve where there are multiple
disjoint calendar periods which are consistent with the observed
determinations; or with plateau periods.</p>
<p>The SPD function is <strong>ONLY</strong> provided here as a
comparison with the other routines. To calculate the SPD for a set of
radiocarbon determinations (here we use the example dataset
<code>armit</code> <span class="citation">(Armit et al. 2014)</span>)
see the example below, where we also plot the results.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FindSummedProbabilityDistribution.html">FindSummedProbabilityDistribution</a></span><span class="op">(</span></span>
<span>  calendar_age_range_BP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">4500</span><span class="op">)</span>, </span>
<span>  rc_determinations <span class="op">=</span> <span class="va">armit</span><span class="op">$</span><span class="va">c14_age</span>, </span>
<span>  rc_sigmas <span class="op">=</span> <span class="va">armit</span><span class="op">$</span><span class="va">c14_sig</span>, </span>
<span>  F14C_inputs <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  calibration_curve <span class="op">=</span> <span class="va">intcal20</span>,</span>
<span>  plot_output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Against_SPDs_files/figure-html/find_spd-1.png" width="100%"></p>
<p><strong>Note:</strong> The summary functions for plotting the
predictive joint calendar age density using the rigorous Bayesian
non-parametric alternative to SPDs (described in the vignette <a href="Non-parametric-summed-density.html">Non-parametric Summed
Density</a>) can also optionally plot the SPD without having to
calculate it separately first.</p>
</div>
<div class="section level3">
<h3 id="illustration-of-why-not-to-use-spds">Illustration of why not to use SPDs<a class="anchor" aria-label="anchor" href="#illustration-of-why-not-to-use-spds"></a>
</h3>
<div class="section level4">
<h4 id="fitting-to-two-normals">Fitting to two Normals<a class="anchor" aria-label="anchor" href="#fitting-to-two-normals"></a>
</h4>
<p>Consider the simulated <code>two_normals</code> dataset. We know that
the calendar age density that underlies these <sup>14</sup>C value is a
mixture of two normal densities - one centred at 3500 cal yr BP (with a
1<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
standard deviation of 200 cal yrs); and another (more concentrated)
centred at 5000 cal yr BP (with a
1<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
standard deviation of 100 cal yrs). However, when we calculate the SPD
we obtain:</p>
<p><img src="Against_SPDs_files/figure-html/two_normals_spd-1.png" width="100%"></p>
<p>Here we have manually overlain the true (known) shared calendar age
density in red. As we can see, the SPD captures does capture some broad
features but does not reconstruct the truth well, and is hard to
interpret. In particular, the SPD is highly variable, showing multiple
peaks, due to the wiggliness of the calibration curve. The SPD peak
shown around 5300 cal yr BP is entirely spurious, yet almost of the same
magnitude as its peak around 3500 cal yr BP (which is a part of the
genuine density).</p>
</div>
<div class="section level4">
<h4 id="an-improvement-using-our-library-approaches">An improvement using our library approaches<a class="anchor" aria-label="anchor" href="#an-improvement-using-our-library-approaches"></a>
</h4>
<p>While this is jumping forward somewhat, to evidence that our methods
provide better reconstructions, we run the same example using our
Bayesian non-parametric summarisation approach (shown in purple as
<em>Polya Urn</em>) and obtain:</p>
<p><img src="Against_SPDs_files/figure-html/two_normals_compare-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-armit2014" class="csl-entry">
Armit, Ian, Graeme T. Swindles, Katharina Becker, Gill Plunkett, and
Maarten Blaauw. 2014. <span>“Rapid Climate Change Did Not Cause
Population Collapse at the End of the European Bronze Age.”</span>
<em>Proceedings of the National Academy of Sciences</em> 111 (48):
17045–49. <a href="https://doi.org/10.1073/pnas.1408028111" class="external-link">https://doi.org/10.1073/pnas.1408028111</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Timothy J Heaton, Sara Al-assam.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
