<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="carbondate">
<title>Non-parametric Summed Density • carbondate</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Non-parametric Summed Density">
<meta property="og:description" content="carbondate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">carbondate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/carbondate.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Independent_calibration.html">Independent and Joint Radiocarbon Calibration</a>
    <a class="dropdown-item" href="../articles/Against_SPDs.html">Why not to Use SPDs</a>
    <a class="dropdown-item" href="../articles/Non-parametric-summed-density.html">Non-parametric Summed Density</a>
    <a class="dropdown-item" href="../articles/Poisson-process-modelling.html">Poisson Process Modelling</a>
    <a class="dropdown-item" href="../articles/determining-convergence.html">Determining Convergence</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TJHeaton/carbondate/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Non-parametric Summed Density</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/TJHeaton/carbondate/blob/HEAD/vignettes/Non-parametric-summed-density.Rmd" class="external-link"><code>vignettes/Non-parametric-summed-density.Rmd</code></a></small>
      <div class="d-none name"><code>Non-parametric-summed-density.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TJHeaton/carbondate" class="external-link">carbondate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="non-parametric-calibration-of-multiple-related-14c-samples">Non-parametric calibration of multiple related <sup>14</sup>C
samples<a class="anchor" aria-label="anchor" href="#non-parametric-calibration-of-multiple-related-14c-samples"></a>
</h2>
<div class="section level3">
<h3 id="model-details">Model details<a class="anchor" aria-label="anchor" href="#model-details"></a>
</h3>
<p>We model the underlying shared calendar age density <span class="math inline">\(f(\theta)\)</span> as an infinite and unknown
mixture of individual calendar age <em>clusters/phases</em>: <span class="math display">\[
f(\theta) = w_1 \textrm{Cluster}_1 + w_2 \textrm{Cluster}_2 + w_3
\textrm{Cluster}_3 + \ldots
\]</span> Each calendar age <em>cluster</em> in the mixture has a normal
distribution with a different location and spread (i.e., an unknown mean
<span class="math inline">\(\mu_j\)</span> and precision <span class="math inline">\(\tau_j^2\)</span>). Each object is then considered
to have been drawn from one of the (infinite) clusters that together
constitute the overall <span class="math inline">\(f(\theta)\)</span>.</p>
<p>Such a model allows considerable flexibility in the estimation of the
joint calendar age density <span class="math inline">\(f(\theta)\)</span> — not only allowing us to build
simple mixtures but also approximate more complex distributions (see
illustration below). In some cases, this mix of normal densities may
represent true and distinct underlying normal archaeological phases, in
which case additional practical inference may be possible. However this
is not required for the method to provide good estimation of a wide
range of underlying <span class="math inline">\(f(\theta)\)</span>
distributions.</p>
<p>The probability that a particular sample is drawn from a particular
cluster will depend upon the relative weight <span class="math inline">\(w_j\)</span> given to that specific cluster. It
will be more likely that an object will come from some clusters than
others. Given an object belongs to a particular cluster, its prior
calendar age will then be normally distributed with the mean <span class="math inline">\(\mu_j\)</span> and precision <span class="math inline">\(\tau_j^2\)</span> of that cluster.</p>
<div class="figure">
<img src="Non-parametric-summed-density_files/figure-html/illustrate_mixture-1.png" alt="_An illustration of building up a potentially complex distribution $f(\theta)$ using mixtures of normals. Left Panel: A simple mixture of three (predominantly disjoint) normal clusters (blue dashed lines) results in an overall $f(\theta)$ that is tri-modal (solid red). Right Panel: Overlapping normal clusters (blue dashed lines) can however create more complex $f(\theta)$ distributions (solid red)._" width="100%"><p class="caption">
<em>An illustration of building up a potentially complex distribution
<span class="math inline">\(f(\theta)\)</span> using mixtures of
normals. Left Panel: A simple mixture of three (predominantly disjoint)
normal clusters (blue dashed lines) results in an overall <span class="math inline">\(f(\theta)\)</span> that is tri-modal (solid red).
Right Panel: Overlapping normal clusters (blue dashed lines) can however
create more complex <span class="math inline">\(f(\theta)\)</span>
distributions (solid red).</em>
</p>
</div>
</div>
<div class="section level3">
<h3 id="estimation-of-the-shared-underlying-density">Estimation of the shared underlying density<a class="anchor" aria-label="anchor" href="#estimation-of-the-shared-underlying-density"></a>
</h3>
<p>To estimate the shared calendar age density <span class="math inline">\(f(\theta)\)</span> based upon our set of
<sup>14</sup>C observations, <span class="math inline">\(X_1, \ldots,
X_N\)</span>, we need to estimate:</p>
<ul>
<li>the mean <span class="math inline">\(\mu_j\)</span> and precision
<span class="math inline">\(\tau_j^2\)</span> of each individual normal
cluster within the overall mixture <span class="math inline">\(f(\theta)\)</span>,</li>
<li>the weighting <span class="math inline">\(w_j\)</span> associated to
that cluster</li>
</ul>
<p>This requires us to also calibrate the <sup>14</sup>C determinations
to obtain their calendar ages <span class="math inline">\(\theta_1,
\ldots, \theta_N\)</span>. Since we assume that the calendar ages of
each object arise from the shared density, this must be performed
simultaneously to the estimation of <span class="math inline">\(f(\theta)\)</span>.</p>
<p>We use Markov Chain Monte Carlo (MCMC) to iterate, for <span class="math inline">\(k = 1, \ldots, M\)</span>, between:</p>
<ul>
<li>Calibrate <span class="math inline">\(X_1, \ldots, X_n\)</span> to
obtain calendar age estimates <span class="math inline">\(\theta_1^{k+1}, \ldots \theta_N^{k+1}\)</span>
given current shared estimate that each <span class="math inline">\(\theta_i \sim \hat{f}^k(\theta)\)</span>
</li>
<li>Update estimate of shared calendar age density (to obtain <span class="math inline">\(\hat{f}_{k+1}(\theta)\)</span> given current set
of calendar ages <span class="math inline">\(\theta_1^{k+1}, \ldots
\theta_N^{k+1}\)</span>
</li>
</ul>
<p>After running the sampler for a large number of iterations (until we
are sufficiently confident that the MCMC has converged) we obtain
estimates for the calendar age <span class="math inline">\(\theta_i\)</span> of each sample, and an estimate
for the shared calendar age density <span class="math inline">\(\hat{f}(\theta)\)</span> from which they arose.
These latter estimates of the shared calendar age density are called
<em>predictive estimates</em>, i.e., they provide estimates of the
calendar age of a hypothetical new sample (based on the set of <span class="math inline">\(N\)</span> samples that we have observed).</p>
<p>Critically, with our Bayesian non-parametric method, the number of
calendar age clusters that are represented in the observed data is
unknown (and is allowed to vary in each MCMC step). This flexibility is
different, and offers a substantial advantage, from other methods that
require the number of clusters to be known <em>a priori</em>. For full
technical details of the models used, and explanation of the model
parameters, see <span class="citation">Heaton (2022)</span>.</p>
</div>
<div class="section level3">
<h3 id="running-the-sampler">Running the sampler<a class="anchor" aria-label="anchor" href="#running-the-sampler"></a>
</h3>
<p>The MCMC updating is performed within an overall Gibbs MCMC scheme.
There are two different schemes provided to update the DPMM — a Polya
Urn approach <span class="citation">(Neal 2000)</span> which integrates
out the mixing weights of each cluster; and a slice sampling approach in
which they are explicitly retained <span class="citation">(Walker
2007)</span>.</p>
<p>Run using the Polya Urn method (our recommended approach based upon
testing):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polya_urn_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PolyaUrnBivarDirichlet.html">PolyaUrnBivarDirichlet</a></span><span class="op">(</span></span>
<span>  rc_determinations <span class="op">=</span> <span class="va">kerr</span><span class="op">$</span><span class="va">c14_age</span>,</span>
<span>  rc_sigmas <span class="op">=</span> <span class="va">kerr</span><span class="op">$</span><span class="va">c14_sig</span>,</span>
<span>  calibration_curve <span class="op">=</span> <span class="va">intcal20</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">1e4</span>,</span>
<span>  n_thin <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>or the Walker method as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">walker_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/WalkerBivarDirichlet.html">WalkerBivarDirichlet</a></span><span class="op">(</span></span>
<span>  rc_determinations <span class="op">=</span> <span class="va">kerr</span><span class="op">$</span><span class="va">c14_age</span>,</span>
<span>  rc_sigmas <span class="op">=</span> <span class="va">kerr</span><span class="op">$</span><span class="va">c14_sig</span>,</span>
<span>  calibration_curve <span class="op">=</span> <span class="va">intcal20</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">1e4</span>,</span>
<span>  n_thin <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> This example only runs for 10,000 iterations -
this is to keep the run time short, but is not enough to lead to a
converged result. We suggest running for at least 100,000 iterations to
arrive at the converged results, which are shown in <span class="citation">Heaton (2022)</span>. More detail on assessing
convergence of the MCMC can be found in the <a href="determining-convergence.html">determining convergence
vignette</a></p>
<p>Both of these methods will output a list containing the sampler
outputs at every <span class="math inline">\(n_{\textrm{thin}}\)</span>
iteration, with the values of the model parameters and the calendar
ages.</p>
</div>
<div class="section level3">
<h3 id="post-processing">Post-processing<a class="anchor" aria-label="anchor" href="#post-processing"></a>
</h3>
<p>Our sampler provides three outputs of particular interest.</p>
<div class="section level5">
<h5 id="calendar-ages">Calendar Ages<a class="anchor" aria-label="anchor" href="#calendar-ages"></a>
</h5>
<p>As described above, the output data includes the calendar age
estimate for each <sup>14</sup>C sample. We can use this to determine
the posterior distribution of the calendar age for each sample. Note
that the calendar age estimates use the joint information provided by
all the <sup>14</sup>C determinations (as opposed to solely the
<sup>14</sup>C determination of the single object that would be found
using <code>CalibrateSingleDetermination</code>) on the understanding
the calendar ages of the objects are related.</p>
<p>You can calculate and plot this using
<code>PlotCalendarAgeDensityIndividualSample</code> - for example to
calculate the posterior calendar age distribution for the 21st
<sup>14</sup>C determination:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PlotCalendarAgeDensityIndividualSample.html">PlotCalendarAgeDensityIndividualSample</a></span><span class="op">(</span><span class="fl">21</span>, <span class="va">polya_urn_output</span><span class="op">)</span></span></code></pre></div>
<p><img src="Non-parametric-summed-density_files/figure-html/plot_individual-1.png" width="100%"></p>
<p>The highest posterior density range for a given probability and the
unmodelled density (i.e. the result of
<code>CalibrateSingleDetermination</code>) can also be shown on the plot
by specifying this in the arguments, as shown below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PlotCalendarAgeDensityIndividualSample.html">PlotCalendarAgeDensityIndividualSample</a></span><span class="op">(</span></span>
<span>  <span class="fl">21</span>, <span class="va">polya_urn_output</span>, show_hpd_ranges <span class="op">=</span> <span class="cn">TRUE</span>, show_unmodelled_density <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Non-parametric-summed-density_files/figure-html/plot_individual_with_hpd-1.png" width="100%"></p>
</div>
<div class="section level5">
<h5 id="density-estimate-to-summarise-objects">Density Estimate to Summarise Objects<a class="anchor" aria-label="anchor" href="#density-estimate-to-summarise-objects"></a>
</h5>
<p>The output data contains information to allow calculation of the
predictive distribution for the calendar age of a new, as yet
undiscovered, object. This density estimate summarises the calendar ages
of all objects. It is generated using the posterior sampled values of
the DPMM component of our MCMC sampler. This calendar age density can be
calculated and plotted using
<code>PlotPredictiveCalendarAgeDensity</code>. The pointwise mean of
<span class="math inline">\(\hat{f}(\theta)\)</span> will be plotted,
together with a corresponding interval at (a user-specified) probability
level.</p>
<p>The function allows calculation using multiple outputs so that their
results can be compared. For example below we compare the results from
the two sampler methods above.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">densities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PlotPredictiveCalendarAgeDensity.html">PlotPredictiveCalendarAgeDensity</a></span><span class="op">(</span></span>
<span>  output_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">walker_output</span>, <span class="va">polya_urn_output</span><span class="op">)</span>,</span>
<span>  n_posterior_samples <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  denscale <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="Non-parametric-summed-density_files/figure-html/plot_density-1.png" width="100%"></p>
<p>We also have the option to plot the SPD, to plot in the
F<sup>14</sup>C scale, and to change the confidence intervals on the
plot.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">densities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PlotPredictiveCalendarAgeDensity.html">PlotPredictiveCalendarAgeDensity</a></span><span class="op">(</span></span>
<span>  output_data <span class="op">=</span> <span class="va">polya_urn_output</span>,</span>
<span>  n_posterior_samples <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  denscale <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  show_SPD <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interval_width <span class="op">=</span> <span class="st">"bespoke"</span>,</span>
<span>  bespoke_probability <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  plot_14C_age <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Non-parametric-summed-density_files/figure-html/plot_density_2-1.png" width="100%"></p>
<p><strong>Note:</strong> Around 1176 cal yr BP, when there appears to
be a potential spike in the summarised estimate of the joint <span class="math inline">\(f(\theta)\)</span>, we see that the 80%
probability interval (dashed line) does not include the mean (solid
line). This is not an error, but rather highlights a benefit of the DPMM
method whereby the number of clusters needed to represent the data is
allowed to vary. This feature occurs because the method is unsure if the
observed data support an additional (highly-concentrated) cluster
located around this period. In some iterations of the MCMC, such a
cluster will be included; but for the majority of iterations, the method
believes it is not required. In theory, one could look at the individual
MCMC iterations to obtain an estimate of how likely such a
highly-concentrated cluster (that results in a sudden spike in samples)
is. Since the plotted 80% interval does not contain the mean, it is
likely that the method thinks there is a less than 10% chance of such a
distinct and highly-concentrated cluster (as fewer than 10% of the MCMC
iterations contain one).</p>
<p><em>Aside:</em> The sharp jump in the IntCal20 calibration curve at
1176 cal yr BP (774 cal AD) is due to an extreme solar particle event
(ESPE) also known as a Miyake Event <span class="citation">(Miyake et
al. 2012)</span>.</p>
</div>
<div class="section level5">
<h5 id="number-of-clusters">Number of Clusters<a class="anchor" aria-label="anchor" href="#number-of-clusters"></a>
</h5>
<p>The output data also contains information about the cluster
allocation of each sampled object, which we can use to build the
probability for there being a given number of total clusters. If we
believe the underlying individual clusters in the model have inherent
meaning in terms of representing genuine and distinct periods of site
usage, as opposed to simply providing a tool to enable a non-parametric
density estimate, this information may be archaeologically useful.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PlotNumberOfClusters.html">PlotNumberOfClusters</a></span><span class="op">(</span>output_data <span class="op">=</span> <span class="va">polya_urn_output</span><span class="op">)</span></span></code></pre></div>
<p><img src="Non-parametric-summed-density_files/figure-html/plot_clusters-1.png" width="50%"></p>
</div>
</div>
<div class="section level3">
<h3 id="when-not-to-use-this-bayesian-non-parametric-method">When not to use this Bayesian non-parametric method<a class="anchor" aria-label="anchor" href="#when-not-to-use-this-bayesian-non-parametric-method"></a>
</h3>
<p>The current implementation of our Bayesian non-parametric approach
<strong>only</strong> supports normally-distributed clusters as the
components in the overall calendar age mixture distribution <span class="math inline">\(f(\theta)\)</span>. While this still allows a
great deal of flexibility in the modelling, as many distributions can be
well approximated by normals, there are certain distributions <span class="math inline">\(f(\theta)\)</span> for which they will struggle.
In particular, you cannot approximate a uniform phase well with a
mixture of normal distributions.</p>
<p>If the underlying shared calendar age density <span class="math inline">\(f(\theta)\)</span> is close to a uniform phase, or
a mixture of uniform phases, then the current (normally-distributed
cluster component) Bayesian non-parametric method is unlikely to work
optimally and provide reliable summaries. In such cases, we advise use
of <code><a href="../reference/PPcalibrate.html">PPcalibrate()</a></code>. This alternative approach is ideally
suited to such situations.</p>
<p>The inhomogeneous Poisson process/changepoint approach taken by
<code><a href="../reference/PPcalibrate.html">PPcalibrate()</a></code> implicitly assumes a shared underlying
calendar age model for <span class="math inline">\(f(\theta)\)</span>
that consists precisely of an unknown mixture of uniform phases.
Implementing <code><a href="../reference/PPcalibrate.html">PPcalibrate()</a></code> and plotting the posterior rate
of the Poisson process (<a href="Poisson-process-modelling.html">see
vignette</a>) will provide an estimate of that shared calendar age
density.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-heaton2021" class="csl-entry">
Heaton, Timothy J. 2022. <span>“<span class="nocase">Non-parametric
Calibration of Multiple Related Radiocarbon Determinations and their
Calendar Age Summarisation</span>.”</span> <em>Journal of the Royal
Statistical Society Series C: Applied Statistics</em> 71 (5): 1918–56.
<a href="https://doi.org/10.1111/rssc.12599" class="external-link">https://doi.org/10.1111/rssc.12599</a>.
</div>
<div id="ref-miyake2012" class="csl-entry">
Miyake, Fusa, Kentaro Nagaya, Kimiaki Masuda, and Toshio Nakamura. 2012.
<span>“<span class="nocase">A signature of cosmic-ray increase in AD
774–775 from tree rings in Japan</span>.”</span> <em>Nature</em> 486
(7402): 240–42. <a href="https://doi.org/10.1038/nature11123" class="external-link">https://doi.org/10.1038/nature11123</a>.
</div>
<div id="ref-neal2000" class="csl-entry">
Neal, Radford M. 2000. <span>“Markov Chain Sampling Methods for
Dirichlet Process Mixture Models.”</span> <em>Journal of Computational
and Graphical Statistics</em> 9 (2): 249. <a href="https://doi.org/10.2307/1390653" class="external-link">https://doi.org/10.2307/1390653</a>.
</div>
<div id="ref-walker2007" class="csl-entry">
Walker, Stephen G. 2007. <span>“Sampling the Dirichlet Mixture Model
with Slices.”</span> <em>Communications in Statistics - Simulation and
Computation</em> 36 (1): 45–54. <a href="https://doi.org/10.1080/03610910601096262" class="external-link">https://doi.org/10.1080/03610910601096262</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Timothy J Heaton, Sara Al-assam.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
