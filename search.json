[{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://tjheaton.github.io/carbondate/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://tjheaton.github.io/carbondate/articles/Against_SPDs.html","id":"summed-probability-distributions","dir":"Articles","previous_headings":"","what":"Summed Probability Distributions","title":"Why Not to Use SPDs","text":"Currently, commonly-used approach summarise calendar age information multiple 14C determinations via summed probability distributions (SPD). statistically valid estimators calendar age potential future sample. view used dates--data approach provide population proxy. SPD, posterior calendar age density object first calculated independently) others using function . individual densities summed/averaged give SPD estimate. independence assumed separate calibration sample, followed subsequent summarisation, generates contradiction. Additionally, SPDs approach fundamentally model samples calendar age domain. Consequently, also able deal inversions calibration curve multiple disjoint calendar periods consistent observed determinations; plateau periods. SPD function provided comparison routines. calculate SPD set radiocarbon determinations (use example dataset armit (Armit et al. 2014)) see example , also plot results.  Note: summary functions plotting predictive joint calendar age density using rigorous Bayesian non-parametric alternative SPDs (described vignette Non-parametric Summed Density) can also optionally plot SPD without calculate separately first.","code":"spd <- FindSummedProbabilityDistribution(   calendar_age_range_BP = c(1000, 4500),    rc_determinations = armit$c14_age,    rc_sigmas = armit$c14_sig,    F14C_inputs = FALSE,    calibration_curve = intcal20,   plot_output = TRUE)"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/articles/Against_SPDs.html","id":"fitting-to-two-normals","dir":"Articles","previous_headings":"Illustration of why not to use SPDs","what":"Fitting to two Normals","title":"Why Not to Use SPDs","text":"Consider simulated two_normals dataset. know calendar age density underlies 14C value mixture two normal densities - one centred 3500 cal yr BP (1σ\\sigma standard deviation 200 cal yrs); another (concentrated) centred 5000 cal yr BP (1σ\\sigma standard deviation 100 cal yrs). However, calculate SPD obtain:  manually overlain true (known) shared calendar age density red. can see, SPD captures capture broad features reconstruct truth well, hard interpret. particular, SPD highly variable, showing multiple peaks, due wiggliness calibration curve. SPD peak shown around 5300 cal yr BP entirely spurious, yet almost magnitude peak around 3500 cal yr BP (part genuine density).","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/Against_SPDs.html","id":"an-improvement-using-our-library-approaches","dir":"Articles","previous_headings":"Illustration of why not to use SPDs","what":"An improvement using our library approaches","title":"Why Not to Use SPDs","text":"jumping forward somewhat, evidence methods provide better reconstructions, run example using Bayesian non-parametric summarisation approach (shown purple Polya Urn) obtain:","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/articles/Independent_calibration.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Independent Single Sample Calibration","text":"package primarily concerned calibration, summarisation, multiple related 14C determinations. set samples, believed arise common calendar distribution related culture/context study, calibration performed jointly. allow calendar age information shared samples calibration process leading improved overall calibration accuracy. also allows us combine summarise calendar age information entire set. However, library also provides functions calibrating single 14C sample independently. can useful one single sample, provide comparison joint calibration approaches.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/Independent_calibration.html","id":"independent-calibration-of-single-14c-samples","dir":"Articles","previous_headings":"Introduction","what":"Independent Calibration of Single 14C Samples","title":"Independent Single Sample Calibration","text":"calibrate single independent determination using provided IntCal20 calibration curve (Reimer et al. 2020), run following:","code":"calibration_result <- CalibrateSingleDetermination(   rc_determination = 1413,    rc_sigma = 25,    F14C_inputs = FALSE,    calibration_curve = intcal20,   plot_output = TRUE)"},{"path":"https://tjheaton.github.io/carbondate/articles/Independent_calibration.html","id":"implementing-sh-calibration","dir":"Articles","previous_headings":"Introduction > Independent Calibration of Single 14C Samples","what":"Implementing SH calibration","title":"Independent Single Sample Calibration","text":"change using Southern Hemisphere calibration curve SHCal20 (Hogg et al. 2020), can modify function arguments accordingly:  Note: simulated SH calibration, 14C determination , provides slightly recent estimate calendar due offset (interhemispheric 14C gradient) atmospheric 14C levels Southern Northern Hemisphere.","code":"calibration_result <- CalibrateSingleDetermination(   rc_determination = 1413,    rc_sigma = 25,    F14C_inputs = FALSE,    calibration_curve = shcal20,   plot_output = TRUE)"},{"path":"https://tjheaton.github.io/carbondate/articles/Independent_calibration.html","id":"selecting-the-calendar-age-scale-when-plotting","dir":"Articles","previous_headings":"Introduction","what":"Selecting the calendar age scale when plotting","title":"Independent Single Sample Calibration","text":"calibration curves, outputs functions, provided cal yr BP scale (0 cal yr BP = 1950 cal AD). However, plots, user can alter calendar age scale shown plot_cal_age_scale variable. default plot calendar ages cal yr BP scale (e.g., see ). instead plot cal AD, set plot_cal_age_scale = \"AD\"; cal BC set plot_cal_age_scale = \"AD\". example,","code":"calibration_result <- CalibrateSingleDetermination(   rc_determination = 1413,    rc_sigma = 25,    F14C_inputs = FALSE,    calibration_curve = intcal20,   plot_output = TRUE,   plot_cal_age_scale = \"AD\")"},{"path":[]},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/articles/Non-parametric-summed-density.html","id":"model-details","dir":"Articles","previous_headings":"Non-parametric calibration of multiple related 14C samples","what":"Model details","title":"Non-Parametric Joint Density Estimation","text":"model underlying shared calendar age density f(θ)f(\\theta) infinite unknown mixture individual calendar age clusters/phases: f(θ)=w1Cluster1+w2Cluster2+w3Cluster3+… f(\\theta) = w_1 \\textrm{Cluster}_1 + w_2 \\textrm{Cluster}_2 + w_3 \\textrm{Cluster}_3 + \\ldots   calendar age cluster mixture normal distribution different location spread (.e., unknown mean μj\\mu_j precision τj2\\tau_j^2). object considered drawn one (infinite) clusters together constitute overall f(θ)f(\\theta). model allows considerable flexibility estimation joint calendar age density f(θ)f(\\theta) — allowing us build simple mixtures also approximate complex distributions (see illustration ). cases, mix normal densities may represent true distinct underlying normal archaeological phases, case additional practical inference may possible. However required method provide good estimation wide range underlying f(θ)f(\\theta) distributions. probability particular sample drawn particular cluster depend upon relative weight wjw_j given specific cluster. likely object come clusters others. Given object belongs particular cluster, prior calendar age normally distributed mean μj\\mu_j precision τj2\\tau_j^2 cluster. illustration building potentially complex distribution f(θ)f(\\theta) using mixtures normals. Left Panel: simple mixture three (predominantly disjoint) normal clusters (blue dashed lines) results overall f(θ)f(\\theta) tri-modal (solid red). Right Panel: Overlapping normal clusters (blue dashed lines) can however create complex f(θ)f(\\theta) distributions (solid red).","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/Non-parametric-summed-density.html","id":"estimation-of-the-shared-underlying-density","dir":"Articles","previous_headings":"Non-parametric calibration of multiple related 14C samples","what":"Estimation of the shared underlying density","title":"Non-Parametric Joint Density Estimation","text":"estimate shared calendar age density f(θ)f(\\theta) based upon set 14C observations, X1,…,XNX_1, \\ldots, X_N, need estimate: mean μj\\mu_j precision τj2\\tau_j^2 individual normal cluster within overall mixture f(θ)f(\\theta), weighting wjw_j associated cluster requires us also calibrate 14C determinations obtain calendar ages θ1,…,θN\\theta_1, \\ldots, \\theta_N. Since assume calendar ages object arise shared density, must performed simultaneously estimation f(θ)f(\\theta). use Markov Chain Monte Carlo (MCMC) iterate, k=1,…,Mk = 1, \\ldots, M, : Calibrate X1,…,XnX_1, \\ldots, X_n obtain calendar age estimates θ1k+1,…θNk+1\\theta_1^{k+1}, \\ldots \\theta_N^{k+1} given current shared estimate θi∼f̂k(θ)\\theta_i \\sim \\hat{f}^k(\\theta) Update estimate shared calendar age density (obtain f̂k+1(θ)\\hat{f}_{k+1}(\\theta) given current set calendar ages θ1k+1,…θNk+1\\theta_1^{k+1}, \\ldots \\theta_N^{k+1} running sampler large number iterations (sufficiently confident MCMC converged) obtain estimates calendar age θi\\theta_i sample, estimate shared calendar age density f̂(θ)\\hat{f}(\\theta) arose. latter estimates shared calendar age density called predictive estimates, .e., provide estimates calendar age hypothetical new sample (based set NN samples observed). Critically, Bayesian non-parametric method, number calendar age clusters represented observed data unknown (allowed vary MCMC step). flexibility different, offers substantial advantage, methods require number clusters known priori. full technical details models used, explanation model parameters, see Heaton (2022).","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/Non-parametric-summed-density.html","id":"running-the-sampler","dir":"Articles","previous_headings":"Non-parametric calibration of multiple related 14C samples","what":"Running the sampler","title":"Non-Parametric Joint Density Estimation","text":"MCMC updating performed within overall Gibbs MCMC scheme. two different schemes provided update DPMM — Polya Urn approach (Neal 2000) integrates mixing weights cluster; slice sampling approach explicitly retained (Walker 2007). Run using Polya Urn method (recommended approach based upon testing): Walker method follows: Note: example runs MCMC default choice 100,000 iterations. However, discuss , challenging dataset need greater number iterations confident convergence. always suggest running MCMC least 100,000 iterations arrive converged results. However, complex datasets, longer runs may required. detail assessing convergence MCMC can found determining convergence vignette methods output list containing sampler outputs every nthinn_{\\textrm{thin}} iteration, values model parameters calendar ages.","code":"polya_urn_output <- PolyaUrnBivarDirichlet(   rc_determinations = kerr$c14_age,   rc_sigmas = kerr$c14_sig,   calibration_curve = intcal20,   n_iter = 1e5,   n_thin = 5) walker_output <- WalkerBivarDirichlet(   rc_determinations = kerr$c14_age,   rc_sigmas = kerr$c14_sig,   calibration_curve = intcal20,   n_iter = 1e5,   n_thin = 5)"},{"path":"https://tjheaton.github.io/carbondate/articles/Non-parametric-summed-density.html","id":"post-processing","dir":"Articles","previous_headings":"Non-parametric calibration of multiple related 14C samples","what":"Post-processing","title":"Non-Parametric Joint Density Estimation","text":"sampler provides three outputs particular interest.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/Non-parametric-summed-density.html","id":"density-estimate-to-summarise-objects","dir":"Articles","previous_headings":"Non-parametric calibration of multiple related 14C samples > Post-processing","what":"Density Estimate to Summarise Objects","title":"Non-Parametric Joint Density Estimation","text":"output data contains information allow calculation predictive distribution calendar age new, yet undiscovered, object. density estimate summarises calendar ages objects. generated using posterior sampled values DPMM component MCMC sampler. calendar age density can calculated plotted using PlotPredictiveCalendarAgeDensity(). pointwise mean f̂(θ)\\hat{f}(\\theta) plotted, together corresponding interval (user-specified) probability level. assign function variable (shown ) pointwise mean corresponding interval also stored can accessed. function allows calculation using multiple outputs results can compared. example compare results two sampler methods .  also option plot SPD, plot F14C scale, change confidence intervals plot.  Note: fact two different MCMC samplers provide matching probability intervals flag us might reached convergence, need run MCMC longer. investigations generally showed PolyaUrnBivarDirichlet() better reaching convergence, recommend use WalkerBivarDirichlet(). longer run 1,000,000 iterations indicates plotted Polya Urn output (green) accurate representation predictive distribution. Around 1176 cal yr BP, see substantial change 95% intervals summarised (predictive) estimate joint f(θ)f(\\theta) (large spike) 80% intervals (smooth). error, rather highlights benefit DPMM method whereby number clusters needed represent data allowed vary. feature occurs method unsure observed data support additional (highly-concentrated) cluster located around time period. iterations MCMC, cluster included; majority iterations, method believes required. Since plotted 80% interval contain spike, 95% , likely method thinks 2.5–10% chance distinct highly-concentrated cluster (proportion MCMC iterations containing one). detailed inference needed, one look actual individual MCMC iterations estimate likely highly-concentrated cluster, resulting sudden spike samples, . Aside: sharp jump IntCal20 calibration curve 1176 cal yr BP (774 cal AD) due extreme solar particle event (ESPE) also known Miyake Event (Miyake et al. 2012).","code":"densities <- PlotPredictiveCalendarAgeDensity(   output_data = list(polya_urn_output, walker_output),   denscale = 2.5) # The mean (and default 2sigma intervals) are stored in densities head(densities[[1]]) # The Polya Urn estimate #>   calendar_age_BP density_mean density_ci_lower density_ci_upper #> 1             471 2.388155e-06     6.820028e-08     1.662975e-05 #> 2             472 2.414024e-06     6.850713e-08     1.674722e-05 #> 3             473 2.440255e-06     6.975724e-08     1.684074e-05 #> 4             474 2.466856e-06     7.089821e-08     1.690925e-05 #> 5             475 2.493833e-06     7.155962e-08     1.700700e-05 #> 6             476 2.521193e-06     7.237446e-08     1.711630e-05  head(densities[[2]]) # The Walker estimate #>   calendar_age_BP density_mean density_ci_lower density_ci_upper #> 1             471 2.471499e-06     7.294953e-11     2.007406e-05 #> 2             472 2.488287e-06     7.431770e-11     2.007812e-05 #> 3             473 2.505414e-06     7.667058e-11     2.018940e-05 #> 4             474 2.522936e-06     7.858181e-11     2.051766e-05 #> 5             475 2.540896e-06     7.987301e-11     2.061738e-05 #> 6             476 2.559333e-06     8.491911e-11     2.079426e-05 densities <- PlotPredictiveCalendarAgeDensity(   output_data = polya_urn_output,   denscale = 2.5,   show_SPD = TRUE,   interval_width = \"bespoke\",   bespoke_probability = 0.8,   plot_14C_age = FALSE) head(densities[[1]]) #>   calendar_age_BP density_mean density_ci_lower density_ci_upper #> 1             471 2.417808e-06     1.828800e-07     6.463847e-06 #> 2             472 2.443581e-06     1.850626e-07     6.550466e-06 #> 3             473 2.469702e-06     1.872705e-07     6.598948e-06 #> 4             474 2.496178e-06     1.889666e-07     6.693827e-06 #> 5             475 2.523014e-06     1.904662e-07     6.738775e-06 #> 6             476 2.550217e-06     1.924577e-07     6.853425e-06"},{"path":"https://tjheaton.github.io/carbondate/articles/Non-parametric-summed-density.html","id":"posterior-calendar-age-estimates-of-individual-samples","dir":"Articles","previous_headings":"Non-parametric calibration of multiple related 14C samples > Post-processing","what":"Posterior Calendar Age Estimates of Individual Samples","title":"Non-Parametric Joint Density Estimation","text":"output data also includes calendar age estimate 14C sample. can use determine posterior distribution calendar age sample. Note calendar age estimates use joint information provided 14C determinations (opposed solely 14C determination single object found using CalibrateSingleDetermination()) understanding calendar ages objects related. can calculate plot using PlotCalendarAgeDensityIndividualSample() - example calculate posterior calendar age distribution 21st 14C determination:  highest posterior density range given probability unmodelled density (.e., result CalibrateSingleDetermination()) can also shown plot specifying arguments, shown .","code":"PlotCalendarAgeDensityIndividualSample(21, polya_urn_output) PlotCalendarAgeDensityIndividualSample(   21, polya_urn_output, show_hpd_ranges = TRUE, show_unmodelled_density = TRUE)"},{"path":"https://tjheaton.github.io/carbondate/articles/Non-parametric-summed-density.html","id":"number-of-clusters","dir":"Articles","previous_headings":"Non-parametric calibration of multiple related 14C samples > Post-processing","what":"Number of Clusters","title":"Non-Parametric Joint Density Estimation","text":"output data also contains information cluster allocation sampled object, can use build probability given number total clusters. believe underlying individual clusters model inherent meaning terms representing genuine distinct periods site usage, opposed simply providing tool enable non-parametric density estimate, information may archaeologically useful.","code":"PlotNumberOfClusters(output_data = polya_urn_output)"},{"path":"https://tjheaton.github.io/carbondate/articles/Non-parametric-summed-density.html","id":"changing-the-calendar-age-plotting-scale","dir":"Articles","previous_headings":"Non-parametric calibration of multiple related 14C samples","what":"Changing the calendar age plotting scale","title":"Non-Parametric Joint Density Estimation","text":"plotting functions present calendar ages (.e., PlotCalendarAgeDensityIndividualSample() PlotPredictiveCalendarAgeDensity()) can change calendar age scale shown x-axis. default plot cal yr BP scale (examples ). instead plot cal AD, set plot_cal_age_scale = \"AD\"; cal BC, set plot_cal_age_scale = \"AD\", e.g.,","code":"densities <- PlotPredictiveCalendarAgeDensity(   output_data = polya_urn_output,   show_SPD = TRUE,   plot_cal_age_scale = \"AD\")"},{"path":"https://tjheaton.github.io/carbondate/articles/Non-parametric-summed-density.html","id":"when-not-to-use-this-bayesian-non-parametric-method","dir":"Articles","previous_headings":"Non-parametric calibration of multiple related 14C samples","what":"When not to use this Bayesian non-parametric method","title":"Non-Parametric Joint Density Estimation","text":"current implementation Bayesian non-parametric approach supports normally-distributed clusters components overall calendar age mixture distribution f(θ)f(\\theta). still allows great deal flexibility modelling, many distributions can well approximated normals, certain distributions f(θ)f(\\theta) struggle. particular, approximate uniform phase well mixture normal distributions. underlying shared calendar age density f(θ)f(\\theta) close uniform phase, mixture uniform phases, current (normally-distributed cluster component) Bayesian non-parametric method unlikely work optimally provide reliable summaries. cases, advise use PPcalibrate(). alternative approach ideally suited situations. inhomogeneous Poisson process/changepoint approach taken PPcalibrate() implicitly assumes shared underlying calendar age model f(θ)f(\\theta) consists precisely unknown mixture uniform phases. Implementing PPcalibrate() plotting posterior rate Poisson process (see vignette) provide estimate shared calendar age density.","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Poisson Process Modelling","text":"component library allows model (estimate) occurrence radiocarbon samples variable-rate (inhomogeneous) Poisson process. done using function PPcalibrate(). aim function primarily allow user estimate variable (calendar year) rate set radiocarbon samples observed, identify changepoints rate. Poisson process model can also used “dates--data” approach (Rick 1987) provide proxy changes population activity, dependent upon representativeness underlying sampling. method, estimated rate Poisson process provides proxy.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"modelling-ideas","dir":"Articles","previous_headings":"Introduction","what":"Modelling Ideas","title":"Poisson Process Modelling","text":"Suppose series nn events, occur calendar times {θi,=1,…,n}\\{\\theta_i, = 1,\\ldots,n \\} cal yr BP. event assumed result generation radiocarbon sample, {Xi,=1,…,n}\\{ X_i, = 1,\\ldots,n \\}. Examples events might : death animal (leaves bone) creation cave painting (leaves painting) construction settlement (leaves farmstead) palaeofire (leaves behind charcoal) model occurrence events random aim investigate whether, , rate occur varies calendar time. Specifically, assume events occur according Poisson Process variable rate λ(t)\\lambda(t). rate λ(t)\\lambda(t) considered piecewise-constant, changes unknown number times unknown calendar ages. aim estimate λ(t)\\lambda(t) hence infer rate events occur changes calendar time. Time periods rate λ(t)\\lambda(t) high typically expected generate greater number events (perhaps since activity, greater population, site/sites); periods rate λ(t)\\lambda(t) lower (perhaps due lower activity site/sites) expected fewer events. calendar ages events {θi,=1,…,n}\\{\\theta_i , =1,\\ldots,n\\} known exactly, estimation variable rate λ(t)\\lambda(t) can tackled directly via reversible jump Markov Chain Monte Carlo (RJ-MCMC) (Green 1995). However, observe radiocarbon ages samples ({Xi,=1,…,n}\\{ X_i, = 1,\\ldots,n \\}) underlying calendar ages θi\\theta_i uncertain must estimated via radiocarbon calibration. complicates process estimating λ(t)\\lambda(t) especially calibration must done simultaneously estimation (modelling influence set θi\\theta_i vice versa). library, provide rigorous approach estimation λ(t)\\lambda(t). Modelling sample occurence using Poisson process latent occurence/activity rate. Left Panel: illustration Poisson process two changepoints occurrence rate. samples (shown rug purple) occur random calendar times, proportional underlying occurrence rate. therefore samples (2700, 2300) cal yr BP times. Right Panel: sample 14C age (shown black ticks y-axis). wish reconstruct underlying Poisson process rate given 14C determination.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"an-inhomogeneous-poisson-process","dir":"Articles","previous_headings":"Introduction","what":"An Inhomogeneous Poisson process","title":"Poisson Process Modelling","text":"Poisson process common statistical process used model occurrence random events. described specifying random variables N(s,t)N(s,t) 0≤s≤t0 \\leq s \\leq t, N(s,t)N(s,t) represents number events occurred time interval (s,t](s,t]. Poisson process parameter λ(t)\\lambda(t), known rate process. controls expected number events particular time interval. case inhomogeneous Poisson process, rate λ(t)\\lambda(t) varies time time periods expected greater number event others. (inhomogeneous) Poisson process defined following two properties: 0≤s≤t0 \\leq s \\leq t, distribution N(s,t)N(s,t) Poisson parameter ∫θ=stλ(θ)dθ\\int_{\\theta = s}^t \\lambda(\\theta) d\\theta. (s1,t1],(s2,t2],…,(sn,tn](s_1,t_1] , (s_2,t_2 ], \\ldots ,(s_n,t_n] disjoint intervals (.e., non-overlapping) N(s1,t1),N(s2,t2),…,N(sn,tn)N(s_1,t_1),N(s_2,t_2 ),\\ldots ,N(s_n,t_n) independent random variables. particular, first properties implies expected number events specific time interval (s,t](s,t] ∫θ=stλ(θ)dθ\\int_{\\theta = s}^t \\lambda(\\theta) d\\theta. Hence time periods higher rates λ(t)\\lambda(t) expected greater number events. second implies , conditional rate λ(t)\\lambda(t), number events occurred one time period affected number events different, non-overlapping time period. also implies events clustered beyond effect variable rate, e.g., occurrence one event increase/decrease probability another event occurs shortly afterwards. Note last assumption quite strong clustering might occur many instances, example animal bones date result hunting single (short-lived) group individuals, date multiple buildings settlement.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"final-radiocarbon-model","dir":"Articles","previous_headings":"Introduction","what":"Final Radiocarbon Model","title":"Poisson Process Modelling","text":"Given set multiple 14^{14}C samples, X1,…,XnX_1, \\ldots, X_n function PPcalibrate() simultaneously: calibrate provide posterior calendar ages estimates θ1,…,θn\\theta_1, \\ldots, \\theta_n estimate rate λ(t)\\lambda(t) underlying process. estimate λ̂(t)\\hat{\\lambda}(t) may provide useful proxy make archaeological /environmental inference, e.g., model changes culture, useage, population size time. (calendar) rate samples occur modelled Poisson process variable rate λ(t)\\lambda(t). Specifically, λ(t)\\lambda(t) modelled piecewise constant function unknown number changepoints: λ(t)={hiif si≤t<si+10otherwise \\lambda(t) = \\left\\{ \\begin{array}{ll}    h_i \\quad & \\textrm{} s_i \\leq t < s_{+1} \\\\   0 & \\textrm{otherwise}   \\end{array} \\right.  TA<s1<s2<…<sk<TBT_A < s_1 < s_2 < \\ldots < s_k < T_B calendar ages changes Poisson process rate, TAT_A TBT_B bounding calendar ages. use reversible jump MCMC (RJMCMC) alternate calibrating samples updating estimate underlying rate lambda.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"example","dir":"Articles","previous_headings":"Introduction","what":"Example","title":"Poisson Process Modelling","text":"basic example shows solve common problem. simulated example, assume events (samples) can must lie within calendar period [700, 300] cal yr BP. Within period, create 40 artificial samples 14^{14}C determinations corresponding (narrower) calendar period [550, 500] cal yr BP. Effectively, underlying model Poisson process rate λ(t){h1=0if 300≤t<500 cal yr BPh2if 500≤t<550 cal yr BPh3=0if 550≤t<700 cal yr BP \\lambda(t)  \\left\\{ \\begin{array}{ll}   h_1 = 0 & \\textrm{} 300 \\leq t < 500 \\textrm{ cal yr BP} \\\\   h_2 \\qquad & \\textrm{} 500 \\leq t < 550 \\textrm{ cal yr BP}\\\\   h_3 = 0 & \\textrm{} 550 \\leq t < 700 \\textrm{ cal yr BP}    \\end{array} \\right.  investigate can reconstruct underlying information, just 14^{14}C values, knew calendar ages samples lay bounding [700, 300] cal yr BP. creates object PP_fit_output can access directly use -built plotting functions.","code":"set.seed(15)  # Set initial values  n_observed <- 40 rc_sigmas <- rep(15, n_observed)  # Create artificial rc_determinations calendar_age_range <- c(300, 700)  observed_age_range <- c(500, 550)  true_theta <- seq(       from = observed_age_range[1],       to = observed_age_range[2],       length = n_observed) intcal_mean <- approx(       x = intcal20$calendar_age_BP,       y = intcal20$c14_age,       xout = true_theta)$y intcal_sd <- approx(       x = intcal20$calendar_age_BP,       y = intcal20$c14_sig,       xout = true_theta)$y rc_determinations <- rnorm(       n = n_observed,       mean = intcal_mean,       sd = sqrt(rc_sigmas^2 + intcal_sd^2))  # Fit the model PP_fit_output <- PPcalibrate(     rc_determinations = rc_determinations,     rc_sigmas = rc_sigmas,     calibration_curve = intcal20,     calendar_age_range = calendar_age_range,     calendar_grid_resolution = 1,     n_iter = 1e5,     n_thin = 10,     show_progress = FALSE)"},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"calculating-and-plotting-the-posterior-estimate-of-the-occurrence-rate","dir":"Articles","previous_headings":"Introduction > Example","what":"Calculating and plotting the posterior estimate of the occurrence rate","title":"Poisson Process Modelling","text":"calculate plot posterior estimate λ(t)\\lambda(t) use -built PlotPosteriorMeanRate() function. recommend assign function variable (shown ). means create plot, also store posterior mean rate (associated probability intervals) regular calendar grid wish access :  plots posterior mean rate sample occurrence (shown purple). 14^{14}C determinations (X1,…,XnX_1, \\ldots, X_n) shown y-axis rug. rug x-axis plots posterior mean corresponding calendar ages (.e., θ1,…,θn\\theta_1, \\ldots, \\theta_n) calibration illustration purposes. Note: cases (particular individual calibrated age estimates θi\\theta_i bimodal) posterior calendar mean good summary. can see, posterior estimate λ(t)\\lambda(t) identifies calendar period hypothetical samples created [550, 500] cal yr BP. , λ̂(t)\\hat{\\lambda}(t) non-zero, time periods rate (correctly) drops near zero. Aside: can also run function without assigning output, just create plot, without storing mean:","code":"# Run plotting function and assign output to PP_posterior_mean_rate_2sigma PP_posterior_mean_rate_2sigma <- PlotPosteriorMeanRate(PP_fit_output) # Note: You can change the PP line widths using the plot_lwd argument   # Look at PP_posterior_mean_rate_2sigma (posterior mean and 2 sigma intervals)  head(PP_posterior_mean_rate_2sigma) #>   calendar_age_BP   rate_mean rate_ci_lower rate_ci_upper #> 1             300 0.008011871  0.0001862987    0.04248661 #> 2             301 0.007986965  0.0001862987    0.04232088 #> 3             302 0.007963215  0.0001862987    0.04211068 #> 4             303 0.007914135  0.0001862987    0.04164114 #> 5             304 0.007861676  0.0001862987    0.04094373 #> 6             305 0.007703460  0.0001862987    0.03952506 # Run plotting function PlotPosteriorMeanRate(PP_fit_output)"},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"plotting-the-estimated-number-of-changepoints","dir":"Articles","previous_headings":"Introduction > Example","what":"Plotting the estimated number of changepoints","title":"Poisson Process Modelling","text":"can plot posterior estimate number internal changes rate λ(t)\\lambda(t) using command:  , can see method estimates likely two changes. , corresponds underlying (simulated) data, step occurrence rate zero samples/cal yr rate ca. 0.8 samples/cal yr 550 cal yr BP, step back return sample occurrence rate zero 500 cal yr BP.","code":"PlotNumberOfInternalChanges(PP_fit_output)"},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"plotting-estimates-of-changepoint-locations","dir":"Articles","previous_headings":"Introduction > Example","what":"Plotting estimates of changepoint locations","title":"Poisson Process Modelling","text":"can plot density estimates locations (calendar times) changepoints λ(t)\\lambda(t), conditional number changes, using PlotPosteriorChangePoints() function. default shows density estimates calendar times changes occurrence rate, conditional ninternal changes=1,2,n_{\\textrm{internal changes}} = 1, 2, 33 changes λ(t)\\lambda(t) time period study. can however changed specifying n_changes function:  figure can interpreted follows. example, model thinks two changepoints underlying occurrence rate samples, changepoints located around 500 cal yr BP 550 cal yr BP (two distinct dashed density estimates shown dark green). model thinks three changepoints rate, located according location shown dotted red densities (note three locations overlay one another, effectively adding double changepoint either 500 550 cal yr BP). information contained plot combined PlotNumberOfInternalChanges() indicates likely number changepoints two. may therefore wish focus interpretation locations/times changepoints conditional number (.e., ninternal changes=2n_{\\textrm{internal changes}} = 2). Note R warning : simulated data, posterior model (correctly) never thinks one changepoint. indicated warning message returned R absence solid blue density plot.","code":"PlotPosteriorChangePoints(PP_fit_output) #> Warning in PlotPosteriorChangePoints(PP_fit_output): No posterior samples with #> 1 internal changes # Can add an n_changes argument, e.g., n_changes = c(2, 3, 4) # if want to condition on a different number of changes"},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"plotting-estimates-of-occurrence-rate","dir":"Articles","previous_headings":"Introduction > Example","what":"Plotting estimates of occurrence rate","title":"Poisson Process Modelling","text":"can also plot, conditional number changes rate step function λ(t)\\lambda(t), posterior density estimates heights individual segments (.e., rates sample occurrence constant periods)  , conditional two changes λ(t)\\lambda(t) 700–300 cal yr BP (three different values rates) two rates ca. 0 events per cal yr (correspond periods 700–550 500–300 cal yr BP), period rate ca. 0.6-0.8 events per cal yr (corresponding period 550–500 cal yr BP).","code":"PlotPosteriorHeights(PP_fit_output) #> Warning in PlotPosteriorHeights(PP_fit_output): No posterior samples with 1 #> internal changes # As above can add an n_changes argument, e.g., n_changes = c(2, 3, 4) # if want to condition on a different number of changes"},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"plotting-the-posterior-calendar-age-estimates-of-individual-samples","dir":"Articles","previous_headings":"Introduction > Example","what":"Plotting the posterior calendar age estimates of individual samples","title":"Poisson Process Modelling","text":"Finally, possible plot posterior calendar age estimates individual samples using PlotCalendarAgeDensityIndividualSample() function:","code":"PlotCalendarAgeDensityIndividualSample(   9, PP_fit_output, show_hpd_ranges = TRUE, show_unmodelled_density = TRUE)"},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"changing-the-calendar-age-plotting-scale","dir":"Articles","previous_headings":"Introduction","what":"Changing the calendar age plotting scale","title":"Poisson Process Modelling","text":"elsewhere library, calendar age scale (cal yr BP, cal AD, cal BC) shown plotting can selected via plot_cal_age_scale variable within relevant functions. case Poisson process modelling, calendar age scale can set PlotPosteriorMeanRate() PlotPosteriorChangePoints(), e.g.,","code":"PlotPosteriorChangePoints(PP_fit_output,                            plot_cal_age_scale = \"AD\") #> Warning in PlotPosteriorChangePoints(PP_fit_output, plot_cal_age_scale = \"AD\"): #> No posterior samples with 1 internal changes"},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"calculating-the-posterior-estimate-of-the-occurrence-rate-on-a-bespoke-grid","dir":"Articles","previous_headings":"Introduction > Changing the calendar age plotting scale","what":"Calculating the posterior estimate of the occurrence rate on a bespoke grid","title":"Poisson Process Modelling","text":"calculate posterior estimate λ(t)\\lambda(t) user-specified calendar age grid user-specified probability intervals (default 2σ2\\sigma) can also use -built FindPosteriorMeanRate() function:","code":"# Calculating 2 sigma (95.4%) intervals on posterior mean occurrence rate  PP_posterior_mean_rate_2sigma <- FindPosteriorMeanRate(   PP_fit_output,   calendar_age_sequence = seq(300, 500, by = 1),   interval_width = \"2sigma\")  # Look at posterior mean with 2 sigma probability interval head(PP_posterior_mean_rate_2sigma) #>   calendar_age_BP   rate_mean rate_ci_lower rate_ci_upper #> 1             300 0.008010096  0.0001862987    0.04248661 #> 2             301 0.007985190  0.0001862987    0.04232088 #> 3             302 0.007961441  0.0001862987    0.04211068 #> 4             303 0.007912361  0.0001862987    0.04164114 #> 5             304 0.007859902  0.0001862987    0.04094373 #> 6             305 0.007701685  0.0001862987    0.03952506"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"calculating-and-plotting-the-posterior-estimate-of-the-occurrence-rate-over-time-conditioned-on-a-specific-number-of-changes","dir":"Articles","previous_headings":"Introduction > Additional Plotting Features","what":"Calculating and plotting the posterior estimate of the occurrence rate over time conditioned on a specific number of changes","title":"Poisson Process Modelling","text":"user wish, possible calculate plot posterior mean estimate occurrence rate time conditioned user-specified number changes. can done specifying optional n_changes argument either PlotPosteriorMeanRate() FindPosteriorMeanRate() functions:  Note: expect functionality particularly relevant users unless known, advance, many changes rate time period. instead advise users consider number changes rate unknown allow MCMC determine appropriate number rate changes (averaging possible values). Even one conditions specific number rate changes, since locations changes remain unknown different realisation, conditioned posterior mean necessarily reflect number sharp discontinuities (can see jumps posterior mean remain somewhat smoothed).","code":"# Conditional on TWO internal changes in the occurrence rate,  # Calculate and plot the posterior mean rate over time  # (with its 2 sigma intervals) conditional_2_changes_posterior_mean_rate <- PlotPosteriorMeanRate(   PP_fit_output,   n_changes = 2) # here n_changes must have length one (i.e., a single number) # Look at conditional posterior mean with 2 sigma probability interval head(conditional_2_changes_posterior_mean_rate) #>   calendar_age_BP   rate_mean rate_ci_lower rate_ci_upper #> 1             300 0.007879740  1.942084e-05    0.04850640 #> 2             301 0.007879740  1.942084e-05    0.04850640 #> 3             302 0.007879740  1.942084e-05    0.04850640 #> 4             303 0.007774786  1.942084e-05    0.04810404 #> 5             304 0.007692820  1.942084e-05    0.04684532 #> 6             305 0.007679320  1.942084e-05    0.04684532"},{"path":"https://tjheaton.github.io/carbondate/articles/Poisson-process-modelling.html","id":"plotting-individual-posterior-mcmc-realistions-of-the-occurrence-rate","dir":"Articles","previous_headings":"Introduction > Additional Plotting Features","what":"Plotting individual posterior MCMC realistions of the occurrence rate","title":"Poisson Process Modelling","text":"Finally, PlotRateIndividualRealisation() function allows users plot individual realisations occurrence rate drawn MCMC. One can specify number realisations plot, whether realisations randomly chosen correspond specific iterations MCMC, well plotting colours:","code":"# Choose some nice plotting colours (from Okabe-Ito) realisation_colours <- c(\"#000000\", \"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\" )  # Plot 5 random realisations from posterior PlotRateIndividualRealisation(      PP_fit_output,      n_realisations = 5,      plot_realisations_colour = realisation_colours)"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/articles/carbondate.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to carbondate","text":"carbondate package contains functions analysing sets related radiocarbon (14C) determinations. Suppose set NN archaeological samples, 14C determination XiX_i. Furthermore, suppose samples known related one another (example, arising particular site, set sites, populated particular culture). want estimate calendar ages samples investigate changes/variations (calendar age) frequency samples arose (potential proxy activity, population size, …): Illustration challenge. observe set related samples, 14C determination (shown red ticks radiocarbon age axis). Can jointly calibrate samples, summarise combined calendar age information provide? sample unknown calendar age θi\\theta_i (=1,…,Ni = 1, \\ldots, N). Since related, set calendar ages θ1,…,θn\\theta_1, \\ldots, \\theta_n samples assumed arise shared, unknown, calendar age density f(θ)f(\\theta). However, don’t observe true calendar ages samples: 14C determinations X1,…,XnX_1, \\ldots, X_n. Due fluctuations past radiocarbon levels, 14C determinations need calibrated (converted) order understood calendar age scale obtain estimates θi\\theta_i. calibration must done simultaneously summarisation, introducing additional complexity overall process. library serves two purposes: calibration set 14C determinations, .e., calendar age estimation θi\\theta_i, can improved significantly incorporating knowledge samples related; summarisation underlying calendar age distribution samples arise, .e., estimating f(θ)f(\\theta), provides potentially useful proxy activity, population size, frequency past events, … concept uses principle dates--data (Rick 1987) provide two distinct, albeit ideologically linked, approaches achieve : PolyaUrnBivarDirichlet() WalkerBivarDirichlet() — non-parametric Bayesian density estimation approach using Dirichlet process mixture model (DPMM) implemented via two different Markov Chain Monte Carlo (MCMC) algorithms (Heaton 2022). statistically-rigorous alternative summed probability distributions (SPDs) kernel density estimates (KDE models). PPcalibrate() — inhomogeneous Poisson process/Changepoint approach using Reversible Jump Markov Chain Monte Carlo (RJ-MCMC) estimate changing rate 14C samples occur calendar time. Separate vignettes provided describe approach. approach appropriate apply situation dependent, determined nature underlying shared calendar age distribution f(θ)f(\\theta): Can set potential samples (population) well approximated mixture , potentially overlapping, clusters? case PolyaUrnBivarDirichlet() WalkerBivarDirichlet() likely suitable. likely occurrence samples characterised distinct calendar times rate samples arise changes? case PPcalibrate() appropriate.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/carbondate.html","id":"dates-as-data-frequency-of-samples-as-a-proxy-for-activity","dir":"Articles","previous_headings":"Introduction","what":"Dates-as-Data – Frequency of samples as a proxy for activity","title":"Introduction to carbondate","text":"commonly-used approach estimate changes frequency past events size populations looks variations rate archaeological environmental samples (e.g., charcoal fires, human/animal bones, evidence occupation) found site time. Time periods large numbers samples suggest increased activity, samples indicate reduced level activity. paradigm known dates--data (Rick 1987). reliability dates--data approach highly dependent upon ability estimate calendar ages discoveries. archaeological/environmental dates obtained using radiocarbon. need calibration 14C samples introduces considerable uncertainties resultant calendar ages complicates use dates--data, making challenging identify variations calendar year density/rates samples occur. library, provide two theoretically-underpinned approaches overcome challenges, set vignettes: statistically-rigorous alternative summed probability distributions (SPDs) models samples arising mixture distribution containing unknown number distinct clusters (Heaton 2022). Non-parametric summed density estimation vignette ; changepoint-based approach models occurrence 14C samples inhomogeneous Poisson process. aim reconstruct rate samples occur varies calendar time, identify statistically significant changepoints (.e., specific calendar times rate samples changes abruptly). Poisson process modelling vignette","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/carbondate.html","id":"strengths-and-weaknesses-of-dates-as-data","dir":"Articles","previous_headings":"Introduction > Dates-as-Data – Frequency of samples as a proxy for activity","what":"Strengths and Weaknesses of Dates-as-Data","title":"Introduction to carbondate","text":"Used appropriately, dates--data approaches allow users borrow strength data hence identify longer-term trends less-obvious effects possible smaller sets data. potential provide greater insight mechanisms processes. However, like scientific tool, must used uncritically, treated black-box. particular, reliability dates--data inference depend hugely upon representativeness, otherwise, underlying sampling. Two particular considerations must taken account : Potential Taphonomic Loss — certain kinds samples /less likely remain archaeological record (e.g., due preservation) fewer older samples remain. One can (probably) deal can provide likelihood loss different objects/periods. library however currently address . Extent (non)-representativeness underlying sampling — underlying model assumes sample representative overall population/activity. Using sets 14C data dominated large studies looked particular time periods, particular materials/samples, unlikely provide reliable representation overall population. One must always consider sample wishing summarise represents.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/carbondate.html","id":"data-requirements","dir":"Articles","previous_headings":"Introduction","what":"Data Requirements","title":"Introduction to carbondate","text":"(-automated) version library requires two vectors: 14C determinations XiX_i: rc_determinations accompanying (lab-reported) measurement uncertainties σi,lab\\sigma_{,\\textrm{lab}}: rc_sigmas Note: values can either provided 14C ages, F14C concentrations (setting flag F14C_inputs = FALSE TRUE accordingly). model parameters adaptively chosen based upon . experienced users (external independent information) may however wish manually set parameters (see help files information).","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/carbondate.html","id":"additional-information","dir":"Articles","previous_headings":"Introduction","what":"Additional Information","title":"Introduction to carbondate","text":"library also provides joint data (can used either method) described ","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/carbondate.html","id":"calibration-curve","dir":"Articles","previous_headings":"Introduction","what":"Calibration Curve","title":"Introduction to carbondate","text":"calibration curve mapping providing, object true calendar age θ\\theta, corresponding radiocarbon age μ(θ)\\mu(\\theta). Estimates calibration curves created using reference material 14C measurements independently-known (estimated) calendar ages. radiocarbon determination individual sample assumed noisy observation calibration curve, .e., Xi∼N(μ(θi),σi,lab2) X_i \\sim N(\\mu(\\theta_i), \\sigma_{,\\textrm{lab}}^2) Given undated object obtain 14C determination one can estimate calendar age inverting mapping. calibration curve required input functions package. internationally-ratified standard radiocarbon calibration curve known IntCal, regular updates provided IntCal working group: IntCal20 (Reimer et al. 2020) current version agreed use community calibrating samples obtain 14C Northern Hemispheric atmosphere. SHCal20 (Hogg et al. 2020) current version calibrating atmospheric samples Southern Hemisphere. products provides pointwise estimates mean m(θ)m(\\theta) sd ρ(θ)\\rho(\\theta) relevant (NH SH) calibration curve, can integrated calibration, .e.,: μ(θ)|θ∼N(m(θ),ρ(θ)2), ⇒Xi∼N(m(θi),ρ(θi)2+σi,lab2)\\begin{align*} \\mu(\\theta) | \\theta & \\sim N(m(\\theta), \\rho(\\theta)^2), \\textrm{ } \\\\ \\Rightarrow X_i & \\sim N(m(\\theta_i), \\rho(\\theta_i)^2 + \\sigma_{,\\textrm{lab}}^2) \\end{align*} curve data intcal20 shcal20 provided package. However possible load use another calibration curve wish.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/carbondate.html","id":"example-data","dir":"Articles","previous_headings":"Introduction","what":"Example Data","title":"Introduction to carbondate","text":"example 14C data sets provided package, contain number radiocarbon determinations uncertainties real-life cases: kerr: 255 radiocarbon determinations collated Kerr McCormick (2014) related building use raths Ireland. armit: 2021 radiocarbon determinations collated Armit et al. (2014) archaeological groups operating Ireland, investigate whether wetter environment around 2700 cal yr BP led population collapse. buchanan: 628 radiocarbon determinations collated Buchanan, Collard, Edinborough (2008) representing ages distinct archaeological sites found across Canada North America time palaeoindians. alces, bison, cervus, equus, human, mammuthus: radiocarbon determinations related variety megafauna (humans) Yukon Alaska (Dale Guthrie 2006). Samples restricted 25,000–6000 14C yrs BP.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/carbondate.html","id":"package-user-guide","dir":"Articles","previous_headings":"Introduction","what":"Package User Guide","title":"Introduction to carbondate","text":"new calibration provide introductory vignettes: Independent Joint Calibration Radiocarbon Samples Use SPDs learn functions (methods) library, look : Rigorous Bayesian non-parametric alternative SPDs Variable-Rate Poisson Process estimation Changepoint Identification pages provide details methods, simple examples usage.","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/articles/determining-convergence.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Determining Convergence","text":"tools determine well MCMC various approaches converged.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/determining-convergence.html","id":"examining-the-gelman-rubin-convergence-diagnostic","dir":"Articles","previous_headings":"Introduction","what":"Examining the Gelman-Rubin convergence diagnostic","title":"Determining Convergence","text":"often used evaluate MCMC convergence. compares -chains variance within-chains variance model parameters multiple MCMC chains. MCMC converged target posterior, values similar. assess convergence methods, apply individual posterior calendar age estimates 14C samples. NN samples, individual sequence sampled calendar age values stored within overall MCMC. calculate potential scale reduction factor (PSRF) individual sample’s calendar age sequence, generating NN PSRF values. MCMC converged target posterior distribution, PSRFs close 1. first case, relevant MCMC function can run multiple times. generate different chains.  can also calculated taking single MCMC run, splitting multiple parts compare within-segment variance -segment variance calendar age observation.  can see, even iterations (expect result converged yet) PSRF values close one.","code":"all_outputs <- list() for (i in 1:3) {   set.seed(i + 1)   all_outputs[[i]] <- PolyaUrnBivarDirichlet(       kerr$c14_age, kerr$c14_sig, intcal20, n_iter = 1e4) } PlotGelmanRubinDiagnosticMultiChain(all_outputs) set.seed(3) output <- PolyaUrnBivarDirichlet(     kerr$c14_age, kerr$c14_sig, intcal20, n_iter = 2e4)  PlotGelmanRubinDiagnosticSingleChain(output, n_burn = 5e3)"},{"path":"https://tjheaton.github.io/carbondate/articles/determining-convergence.html","id":"examining-the-predictive-distribution-or-posterior-occurrence-rate","dir":"Articles","previous_headings":"Introduction","what":"Examining the predictive distribution or posterior occurrence rate","title":"Determining Convergence","text":"calibrating multiple 14C determinations, primary interest frequently summarised (predictive) calendar age estimate using Bayesian non-parametric method, posterior occurrence rate using Poisson process approach, rather age individual sample. Information predictive estimate encapsulated model parameters relating underlying clusters (e.g., weights distributions). occurrence rate defined locations changepoints, segment heights, Poisson process model. Unfortunately, chains storing parameters suitable Gelman-Rubin diagnostic. case predictive Bayesian non-parametric estimate, number identity clusters stored MCMC can change iteration (clusters drop-, relabelled). case Poisson process occurrence rate, number labelling changepoints varies throughout MCMC. therefore provide diagnostic, based upon assessing predictive calendar age estimate posterior occurrence rate, may much useful indicator MCMC convergence.","code":""},{"path":"https://tjheaton.github.io/carbondate/articles/determining-convergence.html","id":"visually-comparing-multiple-runs","dir":"Articles","previous_headings":"Introduction > Examining the predictive distribution or posterior occurrence rate","what":"Visually comparing multiple runs","title":"Determining Convergence","text":"Running functions time different random number seeds can give idea many iterations needed convergence. MCMC converged, run lead similar result predictive density (posterior occurrence rate case POisson process model). example,  can see, case (255 determinations collated Kerr McCormick (Kerr McCormick 2014)) different runs similar outputs, iterations needed ensure convergence. contrast, run much simpler example (artificial data comprised two normals), can see convergence appears achieved small number iterations.  approach assessing convergence can taken either Bayesian non-parametric method, Poisson process modelling.","code":"outputs <- list() for (i in 1:3) {   set.seed(i+1)   outputs[[i]] <- PolyaUrnBivarDirichlet(       rc_determinations = kerr$c14_age,       rc_sigmas = kerr$c14_sig,       calibration_curve=intcal20,       n_iter = 1e4)   outputs[[i]]$label <- paste(\"Seed =\", i) } PlotPredictiveCalendarAgeDensity(   outputs, n_posterior_samples = 500, denscale = 2, interval_width = \"1sigma\") outputs <- list() for (i in 1:3) {   set.seed(i + 1)   outputs[[i]] <- PolyaUrnBivarDirichlet(   rc_determinations = two_normals$c14_age,   rc_sigmas = two_normals$c14_sig,   calibration_curve=intcal20,   n_iter = 1e4)   outputs[[i]]$label <- paste(\"Seed =\", i) } PlotPredictiveCalendarAgeDensity(   outputs, n_posterior_samples = 500, denscale = 2, interval_width = \"1sigma\")"},{"path":"https://tjheaton.github.io/carbondate/articles/determining-convergence.html","id":"examining-the-kullbackleibler-divergence-bayesian-non-parametrics-only","dir":"Articles","previous_headings":"Introduction > Examining the predictive distribution or posterior occurrence rate","what":"Examining the Kullback–Leibler divergence (Bayesian non-parametrics only)","title":"Determining Convergence","text":"also provide diagnostic specifically Bayesian non-parametric approach (applicable Poisson process model). diagnostic gives measure difference initial (baseline) predictive density predictive density MCMC progresses.  can give idea convergence well iteration number use n_burn calculating predictive density (default set half chain).","code":"set.seed(50) output <- WalkerBivarDirichlet(     rc_determinations = kerr$c14_age,     rc_sigmas = kerr$c14_sig,     calibration_curve=intcal20,     n_iter = 1e5)  PlotConvergenceData(output)"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Timothy J Heaton. Author, maintainer, copyright holder. Sara Al-assam. Author, copyright holder.","code":""},{"path":"https://tjheaton.github.io/carbondate/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Heaton TJ, Al-Assam S (2024). carbondate: Calibration Summarisation Radiocarbon Dates. R package version 1.1.0.9000, https://tjheaton.github.io/carbondate/. Heaton TJ (2022). “Non-parametric calibration multiple related radiocarbon determinations calendar age summarisation.” Journal Royal Statistical Society Series C: Applied Statistics, 71(5), 1918–1956. doi:10.1111/rssc.12599.","code":"@Manual{,   title = {{carbondate}: Calibration and Summarisation of Radiocarbon Dates},   author = {Timothy J. Heaton and Sara Al-Assam},   year = {2024},   note = {R package version 1.1.0.9000},   url = {https://tjheaton.github.io/carbondate/}, } @Article{,   title = {Non-parametric calibration of multiple related radiocarbon determinations and their calendar age summarisation},   journal = {Journal of the Royal Statistical Society Series C: Applied Statistics},   author = {Timothy J. Heaton},   volume = {71},   number = {5},   pages = {1918--1956},   year = {2022},   month = {10},   doi = {10.1111/rssc.12599}, }"},{"path":"https://tjheaton.github.io/carbondate/index.html","id":"carbondate","dir":"","previous_headings":"","what":"Calibration and Summarisation of Radiocarbon Dates","title":"Calibration and Summarisation of Radiocarbon Dates","text":"R package analyse, summarise, multiple radiocarbon (14C) determinations. package provides two linked (distinct) Bayesian approaches can used obtain rigorous robust alternatives summed probability distributions (SPDs): Bayesian Non-Parametric Density Estimation (Modelling joint, summary, calendar distribution unknown mixture calendar age clusters) — see “Non-parametric calibration multiple related radiocarbon determinations calendar age summarisation” (Heaton, 2022). Variable-Rate Poisson Process Estimation (Modelling changes occurrence rate 14C samples calendar time) — see “New Approach Radiocarbon Summarisation: Rigorous Identification Variations/Changepoints Occurrence Rate Radiocarbon Samples using Poisson Process” (Heaton et al., appear) methods implemented using Markov Chain Monte Carlo (MCMC).","code":""},{"path":"https://tjheaton.github.io/carbondate/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Calibration and Summarisation of Radiocarbon Dates","text":"easiest way install latest release via CRAN, typing following R console: can alternatively install development version carbondate GitHub : installed library either methods, need load using:","code":"install.packages(\"carbondate\") devtools::install_github(\"TJHeaton/carbondate\") library(carbondate)"},{"path":"https://tjheaton.github.io/carbondate/index.html","id":"data","dir":"","previous_headings":"","what":"Data","title":"Calibration and Summarisation of Radiocarbon Dates","text":"example datasets radiocarbon determinations (e.g., two_normals, kerr, pp_uniform_phase, buchanan, alces, equus, human, …) provided, can used try calibration functions. two_normals small simulated dataset underlying calendar ages drawn known mixture two normals. included simply give quick--run example Bayesian Non-Parametric Density calibration functions. pp_uniform_phase another small simulated dataset, underlying calendar ages drawn uniformly random short calendar interval (equivalent single uniform phase). included give quick--run example Poisson Process modelling functions. remaining datasets real-life data. Northern Hemisphere IntCal calibration curves Southern Hemisphere SHCal calibration curves also provided.","code":""},{"path":"https://tjheaton.github.io/carbondate/index.html","id":"bayesian-non-parametric-calibration-quick-start-example","dir":"","previous_headings":"","what":"Bayesian Non-Parametric Calibration: Quick-Start Example","title":"Calibration and Summarisation of Radiocarbon Dates","text":"example implements Bayesian non-parametric calibration summarisation approach simulated two_normal data using IntCal20 curve via two (slightly) different MCMC methods. calibration run, resultant estimate joint (summary) calendar age density can plotted. summary estimates generated Bayesian non-parametric approach (shown purple green) called predictive densities. aim predict calendar age future (new) sample based upon set 14C samples summarised.","code":"polya_urn_output <- PolyaUrnBivarDirichlet(   rc_determinations = two_normals$c14_age,   rc_sigmas = two_normals$c14_sig,   calibration_curve=intcal20)  walker_output <- WalkerBivarDirichlet(   rc_determinations = two_normals$c14_age,   rc_sigmas = two_normals$c14_sig,   calibration_curve=intcal20) PlotPredictiveCalendarAgeDensity(   output_data = list(polya_urn_output, walker_output),   show_SPD = TRUE)"},{"path":"https://tjheaton.github.io/carbondate/index.html","id":"poisson-process-modelling-quick-start-example","dir":"","previous_headings":"","what":"Poisson Process Modelling: Quick-Start Example","title":"Calibration and Summarisation of Radiocarbon Dates","text":"example implements Poisson process modelling approach using simulated pp_uniform_phase data IntCal20 curve. calibration run, posterior estimate occurrence rate samples can plotted. estimated rate, changes within , can interpreted equivalently methods calendar age summarisation.","code":"pp_output <- PPcalibrate(   rc_determinations = pp_uniform_phase$c14_age,   rc_sigmas = pp_uniform_phase$c14_sig,   calibration_curve=intcal20) PlotPosteriorMeanRate(output_data = pp_output)"},{"path":"https://tjheaton.github.io/carbondate/reference/CalibrateSingleDetermination.html","id":null,"dir":"Reference","previous_headings":"","what":"Calibrate a Single Radiocarbon Determination — CalibrateSingleDetermination","title":"Calibrate a Single Radiocarbon Determination — CalibrateSingleDetermination","text":"Uses supplied calibration curve calibrate single radiocarbon determination uncertainty (expressed either terms radiocarbon age, F\\({}^{14}\\)C concentration) obtain calendar age probability density estimate.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/CalibrateSingleDetermination.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calibrate a Single Radiocarbon Determination — CalibrateSingleDetermination","text":"","code":"CalibrateSingleDetermination(   rc_determination,   rc_sigma,   calibration_curve,   F14C_inputs = FALSE,   resolution = 1,   plot_output = FALSE,   plot_cal_age_scale = \"BP\",   interval_width = \"2sigma\",   bespoke_probability = NA,   denscale = 3,   plot_pretty = TRUE )"},{"path":"https://tjheaton.github.io/carbondate/reference/CalibrateSingleDetermination.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calibrate a Single Radiocarbon Determination — CalibrateSingleDetermination","text":"rc_determination single observed radiocarbon determination provided either radiocarbon age (\\({}^{14}\\)C yr BP) F\\({}^{14}\\)C concentration. rc_sigma corresponding measurement uncertainty radiocarbon determination (must units , .e., reported \\({}^{14}\\)C age F\\({}^{14}\\)C) calibration_curve dataframe must contain one column calendar_age_BP, also columns c14_age c14_sig f14c f14c_sig (sets). format matches curves supplied package, e.g., intcal20, intcal13, contain 5 columns. F14C_inputs TRUE provided rc_determination F\\({}^{14}\\)C concentration FALSE radiocarbon age. Defaults FALSE. resolution distance calendar ages calculate calendar age probability. Default 1. plot_output TRUE wish plot determination, calibration curve, posterior calibrated age estimate plot. Defaults FALSE plot_cal_age_scale usage plot_output = TRUE. calendar scale use x-axis. Allowed values \"BP\", \"AD\" \"BC\". default \"BP\", corresponding plotting cal yr BP. interval_width usage plot_output = TRUE. confidence intervals show calibration curve highest posterior density ranges. Choose one \"1sigma\" (68.3%), \"2sigma\" (95.4%) \"bespoke\". Default \"2sigma\". bespoke_probability probability use confidence interval \"bespoke\" chosen . E.g. 0.95 chosen, 95% confidence interval calculated. Ignored \"bespoke\" chosen. denscale Whether scale vertical range calendar age density plot relative calibration curve plot (optional). Default 3 means maximum calendar age density 1/3 height plot. plot_pretty logical, defaulting TRUE. set TRUE select pretty plotting margins (create sufficient space axis titles rotates y-axis labels). FALSE implement current user values.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/CalibrateSingleDetermination.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calibrate a Single Radiocarbon Determination — CalibrateSingleDetermination","text":"data frame one column calendar_age_BP containing calendar ages, column probability containing probability calendar age.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/CalibrateSingleDetermination.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calibrate a Single Radiocarbon Determination — CalibrateSingleDetermination","text":"","code":"# Calibration of a single determination expressed as 14C age BP calib <- CalibrateSingleDetermination(860, 35, intcal20) plot(calib, type = \"l\", xlim = c(1000, 600))   # Incorporating an automated plot to visualise the calibration CalibrateSingleDetermination(860, 35, intcal20, plot_output = TRUE)   # Calibration of a single (old) determination expressed as 14C age BP calib <- CalibrateSingleDetermination(31020, 100, intcal20) plot(calib, type = \"l\", xlim = c(36500, 34500))   # Calibration of a single (old) determination expressed as F14C concentration calib <- CalibrateSingleDetermination(     0.02103493, 0.0002618564, intcal20, F14C_inputs = TRUE) plot(calib, type = \"l\", xlim = c(36500, 34500))   # Calibration of a single determination expressed as 14C age BP # against SHCal20 (and creating an automated plot) CalibrateSingleDetermination(1413, 25, shcal20, plot_output = TRUE)   # Implementing a bespoke confidence interval level and plot in AD CalibrateSingleDetermination(     1413,     25,     shcal20,     plot_output = TRUE,     plot_cal_age_scale = \"AD\",     interval_width = \"bespoke\",     bespoke_probability = 0.8)   # Changing denscale (so the calendar age density takes up less space) CalibrateSingleDetermination(     1413,     25,     shcal20,     plot_output = TRUE,     interval_width = \"bespoke\",     bespoke_probability = 0.8,     denscale = 5)"},{"path":"https://tjheaton.github.io/carbondate/reference/FindPosteriorMeanRate.html","id":null,"dir":"Reference","previous_headings":"","what":"Find Posterior Mean Rate of Sample Occurrence for Poisson Process Model — FindPosteriorMeanRate","title":"Find Posterior Mean Rate of Sample Occurrence for Poisson Process Model — FindPosteriorMeanRate","text":"Given output Poisson process fitting function PPcalibrate calculate posterior mean rate sample occurrence (.e., underlying Poisson process rate \\(\\lambda(t)\\)) together specified probability intervals, given calendar age grid (provided cal yr BP). option also provided calculate posterior mean rate conditional upon number internal changepoints within period study (specified input function). Note: want calculate plot result, use PlotPosteriorMeanRate instead. information read vignette: vignette(\"Poisson-process-modelling\", package = \"carbondate\")","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/FindPosteriorMeanRate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find Posterior Mean Rate of Sample Occurrence for Poisson Process Model — FindPosteriorMeanRate","text":"","code":"FindPosteriorMeanRate(   output_data,   calendar_age_sequence,   n_posterior_samples = 5000,   n_changes = NULL,   interval_width = \"2sigma\",   bespoke_probability = NA,   n_burn = NA,   n_end = NA )"},{"path":"https://tjheaton.github.io/carbondate/reference/FindPosteriorMeanRate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find Posterior Mean Rate of Sample Occurrence for Poisson Process Model — FindPosteriorMeanRate","text":"output_data return value updating function PPcalibrate. Optionally, output data can extra list item named label used set label plot legend. calendar_age_sequence vector containing calendar age grid (cal yr BP) calculate posterior mean rate. n_posterior_samples Number samples draw, removed n_burn, (thinned) MCMC realisations stored output_data estimate rate \\(\\lambda(t)\\). samples may repeats number , post burn-, realisations less n_posterior_samples. given, 5000 used. n_changes (Optional) wish condition calculation posterior mean number internal changepoints. function, specified, n_changes must single integer. interval_width confidence intervals show calibration curve predictive density. Choose one \"1sigma\" (68.3%), \"2sigma\" (95.4%) \"bespoke\". Default \"2sigma\". bespoke_probability probability use confidence interval \"bespoke\" chosen . E.g., 0.95 chosen, 95% confidence interval calculated. Ignored \"bespoke\" chosen. n_burn number MCMC iterations discarded burn-(.e., considered occurring MCMC converged). relates number iterations (n_iter) running original update functions (thinned output_data). MCMC iterations used calculations. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PPcalibrate) leave 100 (thinned) values output_data. n_end last iteration original MCMC chain use calculations. Assumed total number iterations performed, .e. n_iter, given.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/FindPosteriorMeanRate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find Posterior Mean Rate of Sample Occurrence for Poisson Process Model — FindPosteriorMeanRate","text":"list, item containing data frame calendar_age_BP, rate_mean confidence intervals rate - rate_ci_lower rate_ci_upper.","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/FindPosteriorMeanRate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find Posterior Mean Rate of Sample Occurrence for Poisson Process Model — FindPosteriorMeanRate","text":"","code":"# NOTE: All these examples are shown with a small n_iter and n_posterior_samples # to speed up execution. # Try n_iter and n_posterior_samples as the function defaults.  pp_output <- PPcalibrate(     pp_uniform_phase$c14_age,     pp_uniform_phase$c14_sig,     intcal20,     n_iter = 1000,     show_progress = FALSE)  # Default plot with 2 sigma interval FindPosteriorMeanRate(pp_output, seq(450, 640, length=10), n_posterior_samples = 100) #>    calendar_age_BP  rate_mean rate_ci_lower rate_ci_upper #> 1         450.0000 0.02652925   0.002534426    0.05217793 #> 2         471.1111 0.02934888   0.005977875    0.06644602 #> 3         492.2222 0.03138208   0.005977875    0.09191301 #> 4         513.3333 0.79113405   0.613138526    0.88529633 #> 5         534.4444 0.79113405   0.613138526    0.88529633 #> 6         555.5556 0.34909595   0.002836854    0.78321291 #> 7         576.6667 0.01912272   0.005036594    0.09166295 #> 8         597.7778 0.01484077   0.005036594    0.02796642 #> 9         618.8889 0.01642518   0.009355194    0.04376152 #> 10        640.0000 0.01568299   0.004895063    0.04376152"},{"path":"https://tjheaton.github.io/carbondate/reference/FindPredictiveCalendarAgeDensity.html","id":null,"dir":"Reference","previous_headings":"","what":"Find Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — FindPredictiveCalendarAgeDensity","title":"Find Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — FindPredictiveCalendarAgeDensity","text":"Given output one Bayesian non-parametric summarisation functions (either PolyaUrnBivarDirichlet WalkerBivarDirichlet) calculate predictive (summarised/shared) calendar age density probability intervals given calendar age grid (provided cal yr BP). Note: want calculate plot result, use PlotPredictiveCalendarAgeDensity instead.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/FindPredictiveCalendarAgeDensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — FindPredictiveCalendarAgeDensity","text":"","code":"FindPredictiveCalendarAgeDensity(   output_data,   calendar_age_sequence,   n_posterior_samples = 5000,   interval_width = \"2sigma\",   bespoke_probability = NA,   n_burn = NA,   n_end = NA )"},{"path":"https://tjheaton.github.io/carbondate/reference/FindPredictiveCalendarAgeDensity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — FindPredictiveCalendarAgeDensity","text":"output_data return value one Bayesian non-parametric DPMM functions, e.g. PolyaUrnBivarDirichlet WalkerBivarDirichlet, list, item containing one return values. Optionally, output data can extra list item named label used set label plot legend. calendar_age_sequence vector containing calendar age grid (cal yr BP) calculate predictive (summarised/shared) density. n_posterior_samples Number samples draw, removed n_burn, (thinned) realisations stored DPMM outputs estimate predictive calendar age density. samples may repeats number , post burn-, realisations less n_posterior_samples. given, 5000 used. interval_width confidence intervals show calibration curve predictive density. Choose one \"1sigma\" (68.3%), \"2sigma\" (95.4%) \"bespoke\". Default \"2sigma\". bespoke_probability probability use confidence interval \"bespoke\" chosen . E.g., 0.95 chosen, 95% confidence interval calculated. Ignored \"bespoke\" chosen. n_burn number MCMC iterations discarded burn-(.e., considered occurring MCMC converged). relates number iterations (n_iter) running original update functions (thinned output_data). MCMC iterations used calculations. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PolyaUrnBivarDirichlet WalkerBivarDirichlet) leave 100 (thinned) values output_data. n_end last iteration original MCMC chain use calculations. Assumed total number iterations performed, .e. n_iter, given.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/FindPredictiveCalendarAgeDensity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — FindPredictiveCalendarAgeDensity","text":"data frame calendar_age_BP, density_mean confidence intervals density density_ci_lower density_ci_upper.","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/FindPredictiveCalendarAgeDensity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — FindPredictiveCalendarAgeDensity","text":"","code":"# NOTE: All these examples are shown with a small n_iter and n_posterior_samples # to speed up execution. # Try n_iter and n_posterior_samples as the function defaults.  # First generate output data polya_urn_output <- PolyaUrnBivarDirichlet(     two_normals$c14_age,     two_normals$c14_sig,     intcal20,     n_iter = 100,     show_progress = FALSE)  # Find results for example output, 2-sigma confidence interval (default) FindPredictiveCalendarAgeDensity(     polya_urn_output, seq(3600, 4700, length=12), n_posterior_samples = 500) #>    calendar_age_BP density_mean density_ci_lower density_ci_upper #> 1             3600 7.555309e-04     5.927833e-04     8.815453e-04 #> 2             3700 5.966265e-04     3.593694e-04     7.484916e-04 #> 3             3800 3.831980e-04     1.741983e-04     5.140313e-04 #> 4             3900 2.014323e-04     6.768471e-05     2.777326e-04 #> 5             4000 8.757076e-05     2.129438e-05     1.189600e-04 #> 6             4100 3.204235e-05     5.677310e-06     4.973936e-05 #> 7             4200 1.028096e-05     1.558970e-06     1.781786e-05 #> 8             4300 3.289998e-06     6.904306e-07     5.737949e-06 #> 9             4400 1.520525e-06     5.295331e-07     2.026711e-06 #> 10            4500 2.767692e-06     5.785619e-07     7.625474e-06 #> 11            4600 2.172633e-05     4.368764e-06     5.706649e-05 #> 12            4700 1.601356e-04     6.924276e-05     2.736710e-04"},{"path":"https://tjheaton.github.io/carbondate/reference/FindSummedProbabilityDistribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Find the summed probability distribution (SPD) for a set of radiocarbon observations — FindSummedProbabilityDistribution","title":"Find the summed probability distribution (SPD) for a set of radiocarbon observations — FindSummedProbabilityDistribution","text":"Takes set radiocarbon determinations uncertainties, independently calibrates one, averages resultant calendar age estimates give SPD estimate. Important: function used inference SPDs statistically rigorous. Instead use either : Bayesian non-parametric summarisation approaches PolyaUrnBivarDirichlet WalkerBivarDirichlet; Poisson process rate approach PPcalibrate SPD function provided intended comparison. provide inbuilt plotting option show SPD alongside determinations calibration curve.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/FindSummedProbabilityDistribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find the summed probability distribution (SPD) for a set of radiocarbon observations — FindSummedProbabilityDistribution","text":"","code":"FindSummedProbabilityDistribution(   calendar_age_range_BP,   rc_determinations,   rc_sigmas,   calibration_curve,   F14C_inputs = FALSE,   resolution = 1,   plot_output = FALSE,   plot_cal_age_scale = \"BP\",   interval_width = \"2sigma\",   bespoke_probability = NA,   denscale = 3,   plot_pretty = TRUE )"},{"path":"https://tjheaton.github.io/carbondate/reference/FindSummedProbabilityDistribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find the summed probability distribution (SPD) for a set of radiocarbon observations — FindSummedProbabilityDistribution","text":"calendar_age_range_BP vector length 2 start end calendar age BP calculate SPD . two values must order start value less end value, e.g., (600, 1700) cal yr BP. code extend range (400 cal yrs side) conservativeness rc_determinations vector observed radiocarbon determinations. Can provided either \\({}^{14}\\)C ages (\\({}^{14}\\)C yr BP) F\\({}^{14}\\)C concentrations. rc_sigmas vector (1-sigma) measurement uncertainties radiocarbon determinations. Must length rc_determinations given units. calibration_curve dataframe must contain one column calendar_age_BP, also columns c14_age c14_sig f14c f14c_sig (sets). format matches curves supplied package, e.g., intcal20, intcal13, contain 5 columns. F14C_inputs TRUE provided rc_determinations F\\({}^{14}\\)C concentrations FALSE radiocarbon ages. Defaults FALSE. resolution distance calendar ages calculate calendar age probability. Default 1. plot_output TRUE wish plot determinations, calibration curve, SPD plot. Defaults FALSE plot_cal_age_scale usage plot_output = TRUE. calendar scale use x-axis. Allowed values \"BP\", \"AD\" \"BC\". default \"BP\", corresponding plotting cal yr BP. interval_width usage plot_output = TRUE. confidence intervals show calibration curve. Choose one \"1sigma\" (68.3%), \"2sigma\" (95.4%) \"bespoke\". Default \"2sigma\". bespoke_probability probability use confidence interval \"bespoke\" chosen . E.g. 0.95 chosen, 95% confidence interval calculated. Ignored \"bespoke\" chosen. denscale Whether scale vertical range calendar age density plot relative calibration curve plot (optional). Default 3 means maximum SPD 1/3 height plot. plot_pretty logical, defaulting TRUE. set TRUE select pretty plotting margins (create sufficient space axis titles rotates y-axis labels). FALSE implement current user values.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/FindSummedProbabilityDistribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find the summed probability distribution (SPD) for a set of radiocarbon observations — FindSummedProbabilityDistribution","text":"data frame one column calendar_age_BP containing calendar ages, column probability containing probability calendar age","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/FindSummedProbabilityDistribution.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find the summed probability distribution (SPD) for a set of radiocarbon observations — FindSummedProbabilityDistribution","text":"","code":"# An example using 14C age BP and the IntCal 20 curve SPD <- FindSummedProbabilityDistribution(    calendar_age_range_BP=c(400, 1700),    rc_determinations=c(602, 805, 1554),    rc_sigmas=c(35, 34, 45),    calibration_curve=intcal20) plot(SPD, type = \"l\",    xlim = rev(range(SPD$calendar_age_BP)),    xlab = \"Calendar Age (cal yr BP)\")   # Using the inbuilt plotting features SPD <- FindSummedProbabilityDistribution(    calendar_age_range_BP=c(400, 1700),    rc_determinations=c(602, 805, 1554),    rc_sigmas=c(35, 34, 45),    calibration_curve=intcal20,    plot_output = TRUE,    interval_width = \"bespoke\",    bespoke_probability = 0.8)   # An different example using F14C concentrations and the IntCal 13 curve SPD <- FindSummedProbabilityDistribution(    calendar_age_range_BP=c(400, 2100),    rc_determinations=c(0.8, 0.85, 0.9),    rc_sigmas=c(0.01, 0.015, 0.012),    F14C_inputs=TRUE,    calibration_curve=intcal13) plot(SPD, type = \"l\",    xlim = rev(range(SPD$calendar_age_BP)),    xlab = \"Calendar Age (cal yr BP)\")"},{"path":"https://tjheaton.github.io/carbondate/reference/GenerateOxcalCode.html","id":null,"dir":"Reference","previous_headings":"","what":"Outputs code suitable for running in OxCal from a series of radiocarbon determinations — GenerateOxcalCode","title":"Outputs code suitable for running in OxCal from a series of radiocarbon determinations — GenerateOxcalCode","text":"Outputs code suitable running OxCal series radiocarbon determinations can given either \\({}^{14}\\)C age F\\({}^{14}\\)C.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/GenerateOxcalCode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Outputs code suitable for running in OxCal from a series of radiocarbon determinations — GenerateOxcalCode","text":"","code":"GenerateOxcalCode(   model_name,   rc_determinations,   rc_sigmas,   rc_names = NULL,   F14C_inputs = FALSE,   outfile_path = NULL )"},{"path":"https://tjheaton.github.io/carbondate/reference/GenerateOxcalCode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Outputs code suitable for running in OxCal from a series of radiocarbon determinations — GenerateOxcalCode","text":"model_name name given model OxCal code. rc_determinations vector observed radiocarbon determinations. Can provided either \\({}^{14}\\)C ages (\\({}^{14}\\)C yr BP) F\\({}^{14}\\)C concentrations. rc_sigmas vector (1-sigma) measurement uncertainties radiocarbon determinations. Must length rc_determinations given units. rc_names Optional. name data point - given must length rc_determinations. F14C_inputs TRUE provided rc_determinations F\\({}^{14}\\)C concentrations FALSE radiocarbon ages. Defaults FALSE. outfile_path Optional. given OxCal code output file path given, otherwise output terminal.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/GenerateOxcalCode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Outputs code suitable for running in OxCal from a series of radiocarbon determinations — GenerateOxcalCode","text":"None","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/GenerateOxcalCode.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Outputs code suitable for running in OxCal from a series of radiocarbon determinations — GenerateOxcalCode","text":"","code":"# Generate names automatically and outputs to the screen for 14C ages GenerateOxcalCode(\"My_data\", c(1123, 1128, 1135), c(32, 24, 25)) #>  Plot() #>  { #>   NP_Model(\"My_data\") #>   { #>   R_Date(\"1\",1123,32); #>   R_Date(\"2\",1128,24); #>   R_Date(\"3\",1135,25); #>   }; #>  };  # Provide name automatically and outputs to the screen for F14C concentrations GenerateOxcalCode(   \"My_data\",   c(0.832, 0.850, 0.846),   c(0.004, 0.003, 0.009),   c(\"P-1\", \"P-2\", \"P-3\"),   F14C_inputs=TRUE) #>  Plot() #>  { #>   NP_Model(\"My_data\") #>   { #>   R_F14C(\"P-1\",0.832,0.004); #>   R_F14C(\"P-2\",0.85,0.003); #>   R_F14C(\"P-3\",0.846,0.009); #>   }; #>  };"},{"path":"https://tjheaton.github.io/carbondate/reference/InterpolateCalibrationCurve.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolate a calibration curve at a set of calendar ages — InterpolateCalibrationCurve","title":"Interpolate a calibration curve at a set of calendar ages — InterpolateCalibrationCurve","text":"Interpolate calibration curve set calendar ages","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/InterpolateCalibrationCurve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolate a calibration curve at a set of calendar ages — InterpolateCalibrationCurve","text":"","code":"InterpolateCalibrationCurve(   new_calendar_ages_BP,   calibration_curve,   F14C_outputs = NA )"},{"path":"https://tjheaton.github.io/carbondate/reference/InterpolateCalibrationCurve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolate a calibration curve at a set of calendar ages — InterpolateCalibrationCurve","text":"new_calendar_ages_BP scalar vector containing calendar ages (cal yr BP) interpolate values (means uncertainties) given calibration curve. provided (NA given), use range minimum calendar age maximum calendar age original calibration curve spaced 1. calibration_curve dataframe must contain one column calendar_age_BP, also columns c14_age c14_sig f14c f14c_sig (sets). format matches curves supplied package, e.g., intcal20, intcal13, contain 5 columns. F14C_outputs TRUE F\\({}^{14}\\)C concentrations required, FALSE radiocarbon ages (\\({}^{14}\\)C yrs BP) required NA required new curve.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/InterpolateCalibrationCurve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolate a calibration curve at a set of calendar ages — InterpolateCalibrationCurve","text":"new dataframe entries interpolated c14_age, c14_sig, f14c f14c_sig values calendar_age_BP values given new_calendar_ages_BP.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/InterpolateCalibrationCurve.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Interpolate a calibration curve at a set of calendar ages — InterpolateCalibrationCurve","text":"","code":"# Interpolate intcal20 at a single calendar age. Generates both 14C ages and F14C scales. InterpolateCalibrationCurve(51020, intcal20) #>   calendar_age_BP c14_age c14_sig        f14c     f14c_sig #> 1           51020   48225     413 0.002470435 0.0001270123  # Interpolate intcal20 at two calendar ages. Generates F14C estimates only. InterpolateCalibrationCurve(c(51017, 51021), intcal20, TRUE) #>   calendar_age_BP        f14c     f14c_sig #> 1           51017 0.002470619 0.0001267448 #> 2           51021 0.002470389 0.0001271021  # Interpolate intcal20 at two calendar ages. Generate 14C age estimates (cal yr BP) only. InterpolateCalibrationCurve(c(51017, 51021), intcal20, FALSE) #>   calendar_age_BP  c14_age c14_sig #> 1           51017 48224.40   412.1 #> 2           51021 48225.15   413.3  # Interpolate intcal20 at every integer calendar age within the range of dates # (for intcal20 this is 0 to 55000 cal yr BP), and create estimates for both radiocarbon scales. cal_curve <- InterpolateCalibrationCurve(NA, intcal20)"},{"path":"https://tjheaton.github.io/carbondate/reference/PPcalibrate.html","id":null,"dir":"Reference","previous_headings":"","what":"Model Occurrence of Multiple Radiocarbon Samples as a Variable-Rate Poisson Process — PPcalibrate","title":"Model Occurrence of Multiple Radiocarbon Samples as a Variable-Rate Poisson Process — PPcalibrate","text":"function calibrates set radiocarbon (\\({}^{14}\\)C) samples, provides estimate underlying rate samples occurred varies calendar time (including specific changepoints rate). method can used alternative approach summarise calendar age information contained set related \\({}^{14}\\)C samples, enabling inference latent activity rate led creation. takes input set \\({}^{14}\\)C determinations associated \\(1\\sigma\\) uncertainties, well radiocarbon age calibration curve used. (calendar age) occurrence radiocarbon (\\({}^{14}\\)C) samples modelled Poisson process. underlying rate Poisson process \\(\\lambda(t)\\), represents rate samples occurred, considered unknown assumed vary calendar time. Specifically, sample occurrence rate \\(\\lambda(t)\\) modelled piecewise constant, unknown number changepoints, can occur unknown times. value \\(\\lambda(t)\\) set changepoints also unknown. function jointly calibrates given \\({}^{14}\\)C samples model, simultaneously provides estimate \\(\\lambda(t)\\). Fitting performed using reversible-jump MCMC within Gibbs. returns estimates calendar age individual radiocarbon sample input set; broader output estimated value \\(\\lambda(t)\\) can used library functions. Analysis estimated changepoints piecewise \\(\\lambda(t)\\) permits wider inference whether occurrence rate samples changed significantly particular calendar time , , much. information read vignette: vignette(\"Poisson-process-modelling\", package = \"carbondate\")","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PPcalibrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model Occurrence of Multiple Radiocarbon Samples as a Variable-Rate Poisson Process — PPcalibrate","text":"","code":"PPcalibrate(   rc_determinations,   rc_sigmas,   calibration_curve,   F14C_inputs = FALSE,   n_iter = 1e+05,   n_thin = 10,   use_F14C_space = TRUE,   show_progress = TRUE,   calendar_age_range = NA,   calendar_grid_resolution = 1,   prior_h_shape = NA,   prior_h_rate = NA,   prior_n_internal_changepoints_lambda = 3,   k_max_internal_changepoints = 30,   rescale_factor_rev_jump = 0.9,   bounding_range_prob_cutoff = 0.001,   initial_n_internal_changepoints = 10,   grid_extension_factor = 0.1,   use_fast = TRUE,   fast_approx_prob_cutoff = 0.001 )"},{"path":"https://tjheaton.github.io/carbondate/reference/PPcalibrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model Occurrence of Multiple Radiocarbon Samples as a Variable-Rate Poisson Process — PPcalibrate","text":"rc_determinations vector observed radiocarbon determinations. Can provided either \\({}^{14}\\)C ages (\\({}^{14}\\)C yr BP) F\\({}^{14}\\)C concentrations. rc_sigmas vector (1-sigma) measurement uncertainties radiocarbon determinations. Must length rc_determinations given units. calibration_curve dataframe must contain one column calendar_age_BP, also columns c14_age c14_sig f14c f14c_sig (sets). format matches curves supplied package, e.g., intcal20, intcal13, contain 5 columns. F14C_inputs TRUE provided rc_determinations F\\({}^{14}\\)C concentrations FALSE radiocarbon ages. Defaults FALSE. n_iter number MCMC iterations (optional). Default 100,000. n_thin much thin MCMC output (optional). store every n_thin\\({}^\\textrm{th}\\) iteration. 1 thinning, larger number result thinning. Default 10. Must choose integer greater 1. Overall number MCMC realisations stored \\(n_{\\textrm{}} = \\textrm{floor}( n_{\\textrm{iter}}/n_{\\textrm{thin}}) + 1\\) choose n_thin large ensure enough samples posterior use later inference. use_F14C_space TRUE (default) calculations within function carried F\\({}^{14}\\)C space. FALSE carried \\({}^{14}\\)C age space. recommend selecting TRUE , old samples, calibrating F\\({}^{14}\\)C space removes potential affect asymmetry radiocarbon age uncertainty. Note: flag can set independently format/scale rc_determinations originally provided. show_progress Whether show progress bar console execution. Default TRUE. calendar_age_range (Optional) Overall minimum maximum calendar ages (cal yr BP) permitted set radiocarbon samples, .e., calendar_age_range[1] < \\(\\theta_1, \\ldots, \\theta_n\\) < calendar_age_range[1]. used bound start end Poisson process (events permitted occur outside interval). selected automated selection made based given rc_determinations value bounding_range_prob_cutoff calendar_grid_resolution spacing calendar age grid restrict potential calendar ages samples, e.g., calendar ages samples limited one t, t + resolution, t + 2 * resolution, ... Default 1 (.e., calendar years overall calendar range considered). Primarily used speed-code large range, may select larger resolution. prior_h_shape, prior_h_rate (Optional) Prior value Poisson Process rate (height rate_h) specific interval: $$\\textrm{rate}\\_\\textrm{h} \\sim \\textrm{Gamma}( \\textrm{shape} = \\textrm{prior}\\_\\textrm{h}\\_\\textrm{shape}, \\textrm{rate} = \\textrm{prior}\\_\\textrm{h}\\_\\textrm{rate}).$$ NA prior_h_shape selected 1 (rate_h follows Exponential distribution) prior_h_rate chosen adaptively (internally) match n_observations. prior_n_internal_changepoints_lambda Prior mean number internal changepoints rate \\(\\lambda(t)\\). $$\\textrm{n}\\_\\textrm{internal}\\_\\textrm{changepoints} \\sim \\textrm{Po}(\\textrm{prior}\\_\\textrm{n}\\_\\textrm{internal}\\_\\textrm{changepoints}\\_\\textrm{lambda})$$ k_max_internal_changepoints Maximum permitted number internal changepoints rescale_factor_rev_jump Factor weighting probability dimension change reversible jump update step Poisson process rate_h rate_s bounding_range_prob_cutoff Probability cut-choosing bounds potential calendar ages observations initial_n_internal_changepoints Number internal changepoints initialise MCMC sampler . default 10 (initialise diffuse state). place initial changepoints uniformly random within overall calendar age range. grid_extension_factor adaptively select calendar_age_range rc_determinations, far wish extend grid beyond adaptive minimum maximum. final range extended (equally sides) cover (1 + grid_extension_factor) * (calendar_age_range) use_fast, fast_approx_prob_cutoff flag allow trimming calendar age likelihood (.e., reducing range calendar ages) individual sample speed sampler. TRUE (default), individual sample, tail calendar ages (overall calendar_age_grid) small likelihoods trimmed (speeding updating calendar ages). TRUE probability cut-remove tails fast_approx_prob_cutoff.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PPcalibrate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model Occurrence of Multiple Radiocarbon Samples as a Variable-Rate Poisson Process — PPcalibrate","text":"list 7 items. first 4 items contain output model, one dimension size \\(n_{\\textrm{}} = \\textrm{floor}( n_{\\textrm{iter}}/n_{\\textrm{thin}}) + 1\\). rows items store state MCMC every \\(n_{\\textrm{thin}}\\)\\({}^\\textrm{th}\\) iteration: rate_s list length \\(n_{\\textrm{}}\\) entry giving current set (calendar age) changepoint locations piecewise-constant rate \\(\\lambda(t)\\). rate_h list length \\(n_{\\textrm{}}\\) entry giving current set heights (values rate) piecewise-constant section \\(\\lambda(t)\\). calendar_ages \\(n_{\\textrm{}}\\) \\(n_{\\textrm{obs}}\\) matrix. Gives current estimate calendar age individual observation. n_internal_changes vector length \\(n_{\\textrm{}}\\) giving current number internal changes value \\(\\lambda(t)\\). \\(n_{\\textrm{obs}}\\) number radiocarbon observations, .e., length rc_determinations. remaining items give information input data, input parameters (calculated) update_type update_type string always value \"RJPP\". input_data list containing \\({}^{14}\\)C data used, name calibration curve used. input_parameters list containing values fixed parameters pp_cal_age_range, prior_n_internal_changepoints_lambda, k_max_internal_changepoints, prior_h_shape, prior_h_rate, rescale_factor_rev_jump, calendar_age_grid, calendar_grid_resolution, n_iter n_thin.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PPcalibrate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Model Occurrence of Multiple Radiocarbon Samples as a Variable-Rate Poisson Process — PPcalibrate","text":"","code":"# NOTE: This example is shown with a small n_iter to speed up execution. # When you run ensure n_iter gives convergence (try function default).  pp_output <- PPcalibrate(     pp_uniform_phase$c14_age,     pp_uniform_phase$c14_sig,     intcal20,     n_iter = 100,     show_progress = FALSE)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotCalendarAgeDensityIndividualSample.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Posterior Calendar Age Estimate for an Individual Determination after Joint Calibration — PlotCalendarAgeDensityIndividualSample","title":"Plot Posterior Calendar Age Estimate for an Individual Determination after Joint Calibration — PlotCalendarAgeDensityIndividualSample","text":"joint calibration function (PolyaUrnBivarDirichlet, WalkerBivarDirichlet PPcalibrate) run calibrate set related radiocarbon determinations, function plots posterior calendar age estimate given single determination. Shown (direct) histogram posterior calendar ages generated MCMC chain also (smoothed) kernel density estimate obtained using Gaussian kernel. highest posterior density (HPD) interval also shown interval width specified (default 2\\(\\sigma\\)). information read vignettes: vignette(\"Non-parametric-summed-density\", package = \"carbondate\") vignette(\"Poisson-process-modelling\", package = \"carbondate\") Note: output function provide different results independent calibration determination. jointly, simultaneously, calibrating related \\({}^{14}\\)C determinations using library functions able share available calendar information samples. result improved individual calibration.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotCalendarAgeDensityIndividualSample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Posterior Calendar Age Estimate for an Individual Determination after Joint Calibration — PlotCalendarAgeDensityIndividualSample","text":"","code":"PlotCalendarAgeDensityIndividualSample(   ident,   output_data,   calibration_curve = NULL,   plot_14C_age = TRUE,   plot_cal_age_scale = \"BP\",   hist_resolution = 5,   density_resolution = 1,   interval_width = \"2sigma\",   bespoke_probability = NA,   n_burn = NA,   n_end = NA,   show_hpd_ranges = FALSE,   show_unmodelled_density = FALSE,   plot_pretty = TRUE )"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotCalendarAgeDensityIndividualSample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Posterior Calendar Age Estimate for an Individual Determination after Joint Calibration — PlotCalendarAgeDensityIndividualSample","text":"ident individual determination want plot posterior density estimate calendar age. output_data return value either one Bayesian non-parametric DPMM functions (PolyaUrnBivarDirichlet WalkerBivarDirichlet); Poisson process modelling function (PPcalibrate). calibration_curve usually required since name calibration curve variable saved output data. However, variable name longer environment pass calibration curve . provided, dataframe contain least 3 columns entitled calendar_age, c14_age c14_sig. format matches intcal20. plot_14C_age Whether use radiocarbon age (\\({}^{14}\\)C yr BP) units y-axis plot. Defaults TRUE. FALSE uses F\\({}^{14}\\)C concentration instead. plot_cal_age_scale calendar scale use x-axis. Allowed values \"BP\", \"AD\" \"BC\". default \"BP\" corresponding plotting cal yr BP. hist_resolution distance histogram breaks plotting individual posterior calendar age density. Default 5. density_resolution distance calendar ages returned smoothed calendar age probability. Default 1. interval_width confidence intervals show calibration curve highest posterior density ranges. Choose one \"1sigma\" (68.3%), \"2sigma\" (95.4%) \"bespoke\". Default \"2sigma\". bespoke_probability probability use confidence interval \"bespoke\" chosen . E.g., 0.95 chosen, 95% confidence interval calculated. Ignored \"bespoke\" chosen. n_burn number MCMC iterations discarded burn-(.e., considered occurring MCMC converged). relates number iterations (n_iter) running original update functions (thinned output_data). MCMC iterations used calculations. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PolyaUrnBivarDirichlet WalkerBivarDirichlet) leave 100 (thinned) values output_data. n_end iteration number last sample output_data use calculations. Assumed total number (thinned) realisations stored given. show_hpd_ranges Set TRUE also show highest posterior density (HPD) range plot. show_unmodelled_density Set TRUE also show unmodelled density (.e., result independent calibration using CalibrateSingleDetermination) plot. Default FALSE. plot_pretty logical, defaulting TRUE. set TRUE select pretty plotting margins (create sufficient space axis titles rotates y-axis labels). FALSE implement current user values.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotCalendarAgeDensityIndividualSample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Posterior Calendar Age Estimate for an Individual Determination after Joint Calibration — PlotCalendarAgeDensityIndividualSample","text":"data frame one column calendar_age_BP containing calendar ages, column probability containing (smoothed) kernel density estimate probability calendar age.","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/PlotCalendarAgeDensityIndividualSample.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Posterior Calendar Age Estimate for an Individual Determination after Joint Calibration — PlotCalendarAgeDensityIndividualSample","text":"","code":"# NOTE 1: These examples are shown with a small n_iter to speed up execution. # When you run ensure n_iter gives convergence (try function default).  # NOTE 2: The examples only show application to  PolyaUrnBivarDirichlet output. # The function can also be used with WalkerBivarDirichlet and PPcalibrate output.  polya_urn_output <- PolyaUrnBivarDirichlet(     two_normals$c14_age,     two_normals$c14_sig,     intcal20,     n_iter = 500,     n_thin = 2,     show_progress = FALSE)  # Result for 15th determination PlotCalendarAgeDensityIndividualSample(15, polya_urn_output)   # Now change to show 1 sigma interval for HPD range and calibration curve # and plot in yr AD PlotCalendarAgeDensityIndividualSample(     15,     polya_urn_output,     plot_cal_age_scale = \"AD\",     interval_width = \"1sigma\",     show_hpd_ranges = TRUE,     show_unmodelled_density = TRUE)   # Plot and then assign the returned probability posterior_dens <- PlotCalendarAgeDensityIndividualSample(15, polya_urn_output)  # Use this to find the mean posterior calendar age weighted.mean(posterior_dens$calendar_age_BP, posterior_dens$probability) #> [1] 4995.078"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotConvergenceData.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot KL Divergence of Predictive Density to Assess Convergence of Bayesian Non-Parametric DPMM Sampler — PlotConvergenceData","title":"Plot KL Divergence of Predictive Density to Assess Convergence of Bayesian Non-Parametric DPMM Sampler — PlotConvergenceData","text":"plots Kullback-Leibler (KL) divergence fixed (initial/baseline) predictive density predictive density calculated later individual realisations MCMC run one Bayesian non-parametric summarisation approach. divergence initial predictive density plotted function realisation/iteration number. aims identify divergence, initial estimate shared \\(f(\\theta)\\) current estimate, begun stabilise. Hence, (informally) assess MCMC chain converged equilibrium shared, underlying, predictive \\(f(\\theta)\\). information read vignette: vignette(\"determining-convergence\", package = \"carbondate\")","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotConvergenceData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot KL Divergence of Predictive Density to Assess Convergence of Bayesian Non-Parametric DPMM Sampler — PlotConvergenceData","text":"","code":"PlotConvergenceData(output_data, n_initial = NA)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotConvergenceData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot KL Divergence of Predictive Density to Assess Convergence of Bayesian Non-Parametric DPMM Sampler — PlotConvergenceData","text":"output_data return value one Bayesian non-parametric DPMM summarisation functions, .e., PolyaUrnBivarDirichlet WalkerBivarDirichlet. n_initial number (thinned) realisations use 'initial' predictive shared density. predictive density compared predictive obtained subsequent realisation (thinned) DPMM output. specified, minimum 1000 realisations, 1 / 10 total number realisations, used.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotConvergenceData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot KL Divergence of Predictive Density to Assess Convergence of Bayesian Non-Parametric DPMM Sampler — PlotConvergenceData","text":"None","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotConvergenceData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot KL Divergence of Predictive Density to Assess Convergence of Bayesian Non-Parametric DPMM Sampler — PlotConvergenceData","text":"","code":"# Plot results for the example two_normal data # NOTE: This does not show meaningful results as n_iter # is too small. Try increasing n_iter to 1e5. polya_urn_output <- PolyaUrnBivarDirichlet(     two_normals$c14_age,     two_normals$c14_sig,     intcal20,     n_iter = 500,     show_progress = FALSE) PlotConvergenceData(polya_urn_output)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotGelmanRubinDiagnosticMultiChain.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for Multiple Independent MCMC Chains — PlotGelmanRubinDiagnosticMultiChain","title":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for Multiple Independent MCMC Chains — PlotGelmanRubinDiagnosticMultiChain","text":"plots histogram potential scale reduction factors (PSRF) individual posterior calendar age estimates multiple independent MCMC chains. Achieved comparing within-chain variance -chains variance n_burn iterations. PSRF sample's posterior calendar age calculated. chain converged target posterior distribution, PSRF close 1 samples (stringent condition values less 1.1). information read vignette: vignette(\"determining-convergence\", package = \"carbondate\")","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotGelmanRubinDiagnosticMultiChain.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for Multiple Independent MCMC Chains — PlotGelmanRubinDiagnosticMultiChain","text":"","code":"PlotGelmanRubinDiagnosticMultiChain(output_data_list, n_burn = NA)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotGelmanRubinDiagnosticMultiChain.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for Multiple Independent MCMC Chains — PlotGelmanRubinDiagnosticMultiChain","text":"output_data_list list, item containing return value one updating functions e.g. PolyaUrnBivarDirichlet, WalkerBivarDirichlet PPcalibrate. minimum number elements list 2. n_burn number MCMC iterations discarded burn-. relates total number iterations n_iter running original update functions (thinned output_data). MCMC iterations used calculations PSRF. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PPcalibrate) leave 100 (thinned) values output_data.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotGelmanRubinDiagnosticMultiChain.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for Multiple Independent MCMC Chains — PlotGelmanRubinDiagnosticMultiChain","text":"None","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotGelmanRubinDiagnosticMultiChain.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for Multiple Independent MCMC Chains — PlotGelmanRubinDiagnosticMultiChain","text":"","code":"# Plot results for the example data - n_iter is too small for convergence # Try increasing n_iter to see the values of the PSRF decrease po <- list() for (i in 1:3) {     set.seed(i)     po[[i]] <- PolyaUrnBivarDirichlet(         two_normals$c14_age,         two_normals$c14_sig,         intcal20,         n_iter=400,         show_progress = FALSE) } PlotGelmanRubinDiagnosticMultiChain(po)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotGelmanRubinDiagnosticSingleChain.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for a Single MCMC Chain — PlotGelmanRubinDiagnosticSingleChain","title":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for a Single MCMC Chain — PlotGelmanRubinDiagnosticSingleChain","text":"plots histogram potential scale reduction factors (PSRF) individual posterior calendar age estimates within single MCMC chain. Achieved splitting chain segments n_burn comparing within-chain variance -chains variance segments. PSRF sample's posterior calendar age calculated. chain converged target posterior distribution, PSRF close 1 samples (stringent condition values less 1.1). information read vignette: vignette(\"determining-convergence\", package = \"carbondate\")","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotGelmanRubinDiagnosticSingleChain.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for a Single MCMC Chain — PlotGelmanRubinDiagnosticSingleChain","text":"","code":"PlotGelmanRubinDiagnosticSingleChain(output_data, n_burn = NA, n_segments = 3)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotGelmanRubinDiagnosticSingleChain.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for a Single MCMC Chain — PlotGelmanRubinDiagnosticSingleChain","text":"output_data return value one updating functions, e.g., PolyaUrnBivarDirichlet, WalkerBivarDirichlet PPcalibrate. n_burn number MCMC iterations discarded burn-. relates total number iterations n_iter running original update functions (thinned output_data). MCMC iterations used calculations PSRF. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PPcalibrate) leave 100 (thinned) values output_data. n_segments number segments split chain . Default 3, must number 2 10.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotGelmanRubinDiagnosticSingleChain.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for a Single MCMC Chain — PlotGelmanRubinDiagnosticSingleChain","text":"None","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotGelmanRubinDiagnosticSingleChain.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Histogram of the Gelman-Rubin Convergence Diagnostic for a Single MCMC Chain — PlotGelmanRubinDiagnosticSingleChain","text":"","code":"# Plot results for the example data - n_iter is too small for convergence # Try increasing n_iter to see the values of the PSRF decrease polya_urn_output <- PolyaUrnBivarDirichlet(     two_normals$c14_age,     two_normals$c14_sig,     intcal20,     n_iter = 500,     show_progress = FALSE) PlotGelmanRubinDiagnosticSingleChain(polya_urn_output)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotNumberOfClusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Number of Calendar Age Clusters Estimated in Bayesian Non-Parametric DPMM Output — PlotNumberOfClusters","title":"Plot Number of Calendar Age Clusters Estimated in Bayesian Non-Parametric DPMM Output — PlotNumberOfClusters","text":"Given output one Bayesian non-parametric summarisation functions (either PolyaUrnBivarDirichlet WalkerBivarDirichlet) plot estimated number calendar age clusters represented \\({}^{14}\\)C samples. information read vignette: vignette(\"Non-parametric-summed-density\", package = \"carbondate\")","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotNumberOfClusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Number of Calendar Age Clusters Estimated in Bayesian Non-Parametric DPMM Output — PlotNumberOfClusters","text":"","code":"PlotNumberOfClusters(output_data, n_burn = NA, n_end = NA)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotNumberOfClusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Number of Calendar Age Clusters Estimated in Bayesian Non-Parametric DPMM Output — PlotNumberOfClusters","text":"output_data return value one Bayesian non-parametric DPMM functions, e.g. PolyaUrnBivarDirichlet WalkerBivarDirichlet, list, item containing one return values. Optionally, output data can extra list item named label used set label plot legend. n_burn number MCMC iterations discarded burn-(.e., considered occurring MCMC converged). relates number iterations (n_iter) running original update functions (thinned output_data). MCMC iterations used calculations. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PolyaUrnBivarDirichlet WalkerBivarDirichlet) leave 100 (thinned) values output_data. n_end last iteration original MCMC chain use calculations. Assumed total number iterations performed, .e. n_iter, given.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotNumberOfClusters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Number of Calendar Age Clusters Estimated in Bayesian Non-Parametric DPMM Output — PlotNumberOfClusters","text":"None","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/PlotNumberOfClusters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Number of Calendar Age Clusters Estimated in Bayesian Non-Parametric DPMM Output — PlotNumberOfClusters","text":"","code":"# NOTE: these examples are shown with a small n_iter to speed up execution. # When you run ensure n_iter gives convergence (try function default).  polya_urn_output <- PolyaUrnBivarDirichlet(     two_normals$c14_age,     two_normals$c14_sig,     intcal20,     n_iter = 500,     n_thin = 2,     show_progress = FALSE)  PlotNumberOfClusters(polya_urn_output)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotNumberOfInternalChanges.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Number of Changepoints in Rate of Sample Occurrence for Poisson Process Model — PlotNumberOfInternalChanges","title":"Plot Number of Changepoints in Rate of Sample Occurrence for Poisson Process Model — PlotNumberOfInternalChanges","text":"Given output Poisson process fitting function PPcalibrate, plot posterior distribution number internal changepoints underlying rate sample occurrence (.e., \\(\\lambda(t)\\)) period study. information read vignette: vignette(\"Poisson-process-modelling\", package = \"carbondate\")","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotNumberOfInternalChanges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Number of Changepoints in Rate of Sample Occurrence for Poisson Process Model — PlotNumberOfInternalChanges","text":"","code":"PlotNumberOfInternalChanges(output_data, n_burn = NA, n_end = NA)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotNumberOfInternalChanges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Number of Changepoints in Rate of Sample Occurrence for Poisson Process Model — PlotNumberOfInternalChanges","text":"output_data return value updating function PPcalibrate. Optionally, output data can extra list item named label used set label plot legend. n_burn number MCMC iterations discarded burn-(.e., considered occurring MCMC converged). relates number iterations (n_iter) running original update functions (thinned output_data). MCMC iterations used calculations. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PPcalibrate) leave 100 (thinned) values output_data. n_end last iteration original MCMC chain use calculations. Assumed total number iterations performed, .e. n_iter, given.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotNumberOfInternalChanges.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Number of Changepoints in Rate of Sample Occurrence for Poisson Process Model — PlotNumberOfInternalChanges","text":"None","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotNumberOfInternalChanges.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Number of Changepoints in Rate of Sample Occurrence for Poisson Process Model — PlotNumberOfInternalChanges","text":"","code":"# NOTE: This example is shown with a small n_iter to speed up execution. # Try n_iter and n_posterior_samples as the function defaults.  pp_output <- PPcalibrate(     pp_uniform_phase$c14_age,     pp_uniform_phase$c14_sig,     intcal20,     n_iter = 1000,     show_progress = FALSE)  PlotNumberOfInternalChanges(pp_output)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorChangePoints.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Calendar Ages of Changes in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorChangePoints","title":"Plot Calendar Ages of Changes in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorChangePoints","text":"Given output Poisson process fitting function PPcalibrate, plot posterior density estimates calendar ages internal changepoints rate sample occurrence \\(\\lambda(t)\\). density estimates calculated conditional upon number internal changepoints within period study (specified input function). conditioned number changes, n_change, code extract realisations posterior MCMC sampler number internal changepoints estimate \\(\\lambda(t)\\). provide density estimates (ordered) calendar ages internal changepoints. density estimates obtained using Gaussian kernel. Note: graphs become harder interpret specified number changepoints increases information read vignette: vignette(\"Poisson-process-modelling\", package = \"carbondate\")","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorChangePoints.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Calendar Ages of Changes in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorChangePoints","text":"","code":"PlotPosteriorChangePoints(   output_data,   n_changes = c(1, 2, 3),   plot_cal_age_scale = \"BP\",   n_burn = NA,   n_end = NA,   kernel_bandwidth = NA,   plot_lwd = 2 )"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorChangePoints.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Calendar Ages of Changes in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorChangePoints","text":"output_data return value updating function PPcalibrate. Optionally, output data can extra list item named label used set label plot legend. n_changes Number internal changepoints condition , plot . vector can contain 4 elements, values range 1 6. given, c(1, 2, 3) used. plot_cal_age_scale (Optional) calendar scale use x-axis. Allowed values \"BP\", \"AD\" \"BC\". default \"BP\" corresponding plotting cal yr BP. n_burn number MCMC iterations discarded burn-(.e., considered occurring MCMC converged). relates number iterations (n_iter) running original update functions (thinned output_data). MCMC iterations used calculations. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PPcalibrate) leave 100 (thinned) values output_data. n_end last iteration original MCMC chain use calculations. Assumed total number iterations performed, .e. n_iter, given. kernel_bandwidth (Optional) bandwidth used (Gaussian) kernel smoothing calendar age densities. given, 1/50th overall calendar age range used. plot_lwd line width use plotting posterior mean (confidence intervals). Default 2 (add emphasis).","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorChangePoints.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Calendar Ages of Changes in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorChangePoints","text":"None","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorChangePoints.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Calendar Ages of Changes in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorChangePoints","text":"","code":"# NOTE: This example is shown with a small n_iter to speed up execution. # Try n_iter and n_posterior_samples as the function defaults.  pp_output <- PPcalibrate(     pp_uniform_phase$c14_age,     pp_uniform_phase$c14_sig,     intcal20,     n_iter = 1000,     show_progress = FALSE)  # Plot the posterior change points for only 2 or 3 internal changes PlotPosteriorChangePoints(pp_output, n_changes = c(2, 3))   # Changing the calendar age plotting scale to cal AD PlotPosteriorChangePoints(pp_output, n_changes = c(2, 3),     plot_cal_age_scale = \"AD\")"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorHeights.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Heights of Segments in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorHeights","title":"Plot Heights of Segments in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorHeights","text":"Given output Poisson process fitting function PPcalibrate, plot posterior density estimates heights (.e., values) piecewise-constant rate \\(\\lambda(t)\\) used model sample occurrence. density estimates calculated conditional upon number internal changepoints within period study (specified input function). conditioned number changes, n_change, code extract realisations posterior MCMC sampler number internal changepoints estimate \\(\\lambda(t)\\). provide density estimates heights (.e., value) rate function determined (ordered) changepoints. density estimates obtained using Gaussian kernel. Note: graphs become harder interpret specified number changepoints increases information read vignette: vignette(\"Poisson-process-modelling\", package = \"carbondate\")","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorHeights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Heights of Segments in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorHeights","text":"","code":"PlotPosteriorHeights(   output_data,   n_changes = c(1, 2, 3),   n_burn = NA,   n_end = NA,   kernel_bandwidth = NA,   plot_lwd = 2 )"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorHeights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Heights of Segments in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorHeights","text":"output_data return value updating function PPcalibrate. Optionally, output data can extra list item named label used set label plot legend. n_changes Number internal changepoints condition , plot . vector can contain 4 elements, values range 1 6. given, c(1, 2, 3) used. n_burn number MCMC iterations discarded burn-(.e., considered occurring MCMC converged). relates number iterations (n_iter) running original update functions (thinned output_data). MCMC iterations used calculations. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PPcalibrate) leave 100 (thinned) values output_data. n_end last iteration original MCMC chain use calculations. Assumed total number iterations performed, .e. n_iter, given. kernel_bandwidth (Optional) bandwidth used (Gaussian) kernel smoothing calendar age densities. given, 1/50th maximum height used. plot_lwd line width use plotting posterior mean (confidence intervals). Default 2 (add emphasis).","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorHeights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Heights of Segments in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorHeights","text":"None","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorHeights.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Heights of Segments in Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorHeights","text":"","code":"# NOTE: This example is shown with a small n_iter to speed up execution. # Try n_iter and n_posterior_samples as the function defaults.  pp_output <- PPcalibrate(     pp_uniform_phase$c14_age,     pp_uniform_phase$c14_sig,     intcal20,     n_iter = 1000,     show_progress = FALSE)  # Plot the posterior heights for only 2 or 3 internal changes PlotPosteriorHeights(pp_output, n_changes = c(2, 3))"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorMeanRate.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Posterior Mean Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorMeanRate","title":"Plot Posterior Mean Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorMeanRate","text":"Given output Poisson process fitting function PPcalibrate calculate plot posterior mean rate sample occurrence (.e., underlying Poisson process rate \\(\\lambda(t)\\)) together specified probability intervals, given calendar age grid (provided cal yr BP). show original set radiocarbon determinations (modelling/summarising), chosen calibration curve, estimated posterior rate occurrence \\(\\lambda(t)\\) plot. Can also optionally show posterior mean individual sample's calendar age estimate. option also provided calculate posterior mean rate conditional upon number internal changepoints within period study (specified input function). Note: interested value posterior mean rate grid, without accompanying plot, can use FindPosteriorMeanRate instead. information read vignette: vignette(\"Poisson-process-modelling\", package = \"carbondate\")","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorMeanRate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Posterior Mean Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorMeanRate","text":"","code":"PlotPosteriorMeanRate(   output_data,   n_posterior_samples = 5000,   n_changes = NULL,   calibration_curve = NULL,   plot_14C_age = TRUE,   plot_cal_age_scale = \"BP\",   show_individual_means = TRUE,   show_confidence_intervals = TRUE,   interval_width = \"2sigma\",   bespoke_probability = NA,   denscale = 3,   resolution = 1,   n_burn = NA,   n_end = NA,   plot_pretty = TRUE,   plot_lwd = 2 )"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorMeanRate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Posterior Mean Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorMeanRate","text":"output_data return value updating function PPcalibrate. Optionally, output data can extra list item named label used set label plot legend. n_posterior_samples Number samples draw, removed n_burn, (thinned) MCMC realisations stored output_data estimate rate \\(\\lambda(t)\\). samples may repeats number , post burn-, realisations less n_posterior_samples. given, 5000 used. n_changes (Optional) wish condition calculation posterior mean number internal changepoints. function, specified, n_changes must single integer. calibration_curve usually required since name calibration curve variable saved output data. However, variable name longer environment pass calibration curve . provided, dataframe contain least 3 columns entitled calendar_age, c14_age c14_sig. format matches intcal20. plot_14C_age Whether use radiocarbon age (\\({}^{14}\\)C yr BP) units y-axis plot. Defaults TRUE. FALSE uses F\\({}^{14}\\)C concentration instead. plot_cal_age_scale (Optional) calendar scale use x-axis. Allowed values \"BP\", \"AD\" \"BC\". default \"BP\" corresponding plotting cal yr BP. show_individual_means (Optional) Whether calculate show mean posterior calendar age estimated individual \\({}^{14}\\)C sample plot rug x-axis. Default TRUE. show_confidence_intervals Whether show pointwise confidence intervals (chosen probability level) plot. Default TRUE. interval_width confidence intervals show calibration curve predictive density. Choose one \"1sigma\" (68.3%), \"2sigma\" (95.4%) \"bespoke\". Default \"2sigma\". bespoke_probability probability use confidence interval \"bespoke\" chosen . E.g., 0.95 chosen, 95% confidence interval calculated. Ignored \"bespoke\" chosen. denscale (Optional) Whether scale vertical range Poisson process mean rate plot relative calibration curve plot. Default 3 means maximum mean rate 1/3 height plot. resolution distance calendar ages calculate value rate \\(\\lambda(t)\\). ages created regular grid automatically covers calendar period specified output_data. Default 1. n_burn number MCMC iterations discarded burn-(.e., considered occurring MCMC converged). relates number iterations (n_iter) running original update functions (thinned output_data). MCMC iterations used calculations. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PPcalibrate) leave 100 (thinned) values output_data. n_end last iteration original MCMC chain use calculations. Assumed total number iterations performed, .e. n_iter, given. plot_pretty logical, defaulting TRUE. set TRUE select pretty plotting margins (create sufficient space axis titles rotates y-axis labels). FALSE implement current user values. plot_lwd line width use plotting posterior mean (confidence intervals). Default 2 (add emphasis).","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorMeanRate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Posterior Mean Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorMeanRate","text":"list, item containing data frame calendar_age_BP, rate_mean confidence intervals rate - rate_ci_lower rate_ci_upper.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPosteriorMeanRate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Posterior Mean Rate of Sample Occurrence for Poisson Process Model — PlotPosteriorMeanRate","text":"","code":"# NOTE: All these examples are shown with a small n_iter and n_posterior_samples # to speed up execution. # Try n_iter and n_posterior_samples as the function defaults.  pp_output <- PPcalibrate(     pp_uniform_phase$c14_age,     pp_uniform_phase$c14_sig,     intcal20,     n_iter = 1000,     show_progress = FALSE)  # Default plot with 2 sigma interval PlotPosteriorMeanRate(pp_output, n_posterior_samples = 100)   # Decrease the line width of the posterior mean PlotPosteriorMeanRate(pp_output, n_posterior_samples = 100, plot_lwd = 1)   # Specify an 80% confidence interval PlotPosteriorMeanRate(     pp_output,     interval_width = \"bespoke\",     bespoke_probability = 0.8,     n_posterior_samples = 100)   # Plot the posterior rate conditional on 2 internal changes PlotPosteriorMeanRate(     pp_output,     n_changes = 2,     interval_width = \"bespoke\",     bespoke_probability = 0.8,     n_posterior_samples = 100) #> Warning: Only 16 posterior samples with 2 internal changes, so results may not be robust. Try running the original MCMC for longer, or increasing n_posterior_samples"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPredictiveCalendarAgeDensity.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — PlotPredictiveCalendarAgeDensity","title":"Plot Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — PlotPredictiveCalendarAgeDensity","text":"Given output one Bayesian non-parametric summarisation functions (either PolyaUrnBivarDirichlet WalkerBivarDirichlet) calculate plot predictive (summarised/shared) calendar age density probability intervals given calendar age grid (provided cal yr BP). show original set radiocarbon determinations (summarising), chosen calibration curve, summarised predictive calendar age density plot. Can also optionally show SPD estimate. Note: interested estimated value predictive density grid, without accompanying plot, can use FindPredictiveCalendarAgeDensity instead. information read vignette: vignette(\"Non-parametric-summed-density\", package = \"carbondate\")","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPredictiveCalendarAgeDensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — PlotPredictiveCalendarAgeDensity","text":"","code":"PlotPredictiveCalendarAgeDensity(   output_data,   n_posterior_samples = 5000,   calibration_curve = NULL,   plot_14C_age = TRUE,   plot_cal_age_scale = \"BP\",   show_SPD = FALSE,   show_confidence_intervals = TRUE,   interval_width = \"2sigma\",   bespoke_probability = NA,   denscale = 3,   resolution = 1,   n_burn = NA,   n_end = NA,   plot_pretty = TRUE,   plot_lwd = 2 )"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPredictiveCalendarAgeDensity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — PlotPredictiveCalendarAgeDensity","text":"output_data return value one Bayesian non-parametric DPMM functions, e.g. PolyaUrnBivarDirichlet WalkerBivarDirichlet, list, item containing one return values. Optionally, output data can extra list item named label used set label plot legend. n_posterior_samples Number samples draw, removed n_burn, (thinned) realisations stored DPMM outputs estimate predictive calendar age density. samples may repeats number , post burn-, realisations less n_posterior_samples. given, 5000 used. calibration_curve usually required since name calibration curve variable saved output data. However, variable name longer environment pass calibration curve . provided, dataframe contain least 3 columns entitled calendar_age, c14_age c14_sig. format matches intcal20. plot_14C_age Whether use radiocarbon age (\\({}^{14}\\)C yr BP) units y-axis plot. Defaults TRUE. FALSE uses F\\({}^{14}\\)C concentration instead. plot_cal_age_scale calendar scale use x-axis. Allowed values \"BP\", \"AD\" \"BC\". default \"BP\" corresponding plotting cal yr BP. show_SPD Whether calculate show summed probability distribution plot (optional). Default FALSE. show_confidence_intervals Whether show pointwise confidence intervals (chosen probability level) plot. Default TRUE. interval_width confidence intervals show calibration curve predictive density. Choose one \"1sigma\" (68.3%), \"2sigma\" (95.4%) \"bespoke\". Default \"2sigma\". bespoke_probability probability use confidence interval \"bespoke\" chosen . E.g., 0.95 chosen, 95% confidence interval calculated. Ignored \"bespoke\" chosen. denscale Whether scale vertical range summarised calendar age density plot relative calibration curve plot (optional). Default 3 means maximum predictive density 1/3 height plot. resolution distance calendar ages calculate predictive shared density. ages created regular grid automatically covers calendar period given set \\({}^{14}\\)C samples. Default 1. n_burn number MCMC iterations discarded burn-(.e., considered occurring MCMC converged). relates number iterations (n_iter) running original update functions (thinned output_data). MCMC iterations used calculations. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PolyaUrnBivarDirichlet WalkerBivarDirichlet) leave 100 (thinned) values output_data. n_end last iteration original MCMC chain use calculations. Assumed total number iterations performed, .e. n_iter, given. plot_pretty logical, defaulting TRUE. set TRUE select pretty plotting margins (create sufficient space axis titles rotates y-axis labels). FALSE implement current user values. plot_lwd line width use plotting posterior mean (confidence intervals). Default 2 (add emphasis).","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPredictiveCalendarAgeDensity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — PlotPredictiveCalendarAgeDensity","text":"list, item containing data frame calendar_age_BP, density_mean confidence intervals density density_ci_lower density_ci_upper set output data.","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/PlotPredictiveCalendarAgeDensity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Predictive Estimate of Shared Calendar Age Density from Bayesian Non-Parametric DPMM Output — PlotPredictiveCalendarAgeDensity","text":"","code":"# NOTE: All these examples are shown with a small n_iter and n_posterior_samples # to speed up execution. # Try n_iter and n_posterior_samples as the function defaults.  polya_urn_output <- PolyaUrnBivarDirichlet(     two_normals$c14_age,     two_normals$c14_sig,     intcal20,     n_iter = 500,     show_progress = FALSE) walker_output <- WalkerBivarDirichlet(     two_normals$c14_age,     two_normals$c14_sig,     intcal20,     n_iter = 500,     show_progress = FALSE)  # Plot results for a single calibration PlotPredictiveCalendarAgeDensity(polya_urn_output, n_posterior_samples = 50)   # Plot results from two calibrations on the same plot PlotPredictiveCalendarAgeDensity(     list(walker_output, polya_urn_output), n_posterior_samples = 50)   # Plot and show the 80% confidence interval, show the SPD, add a custom label polya_urn_output$label = \"My plot\" PlotPredictiveCalendarAgeDensity(     polya_urn_output,     n_posterior_samples = 50,     interval_width = \"bespoke\",     bespoke_probability = 0.8,     show_SPD = TRUE)"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotRateIndividualRealisation.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Individual Realisations of Posterior Rate of Sample Occurrence for Poisson Process Model — PlotRateIndividualRealisation","title":"Plot Individual Realisations of Posterior Rate of Sample Occurrence for Poisson Process Model — PlotRateIndividualRealisation","text":"Given output Poisson process fitting function PPcalibrate plot individual realisations MCMC rate sample occurrence (.e., realisations underlying Poisson process rate \\(\\lambda(t)\\)), given calendar age grid (provided cal yr BP). Specify either n_realisations want select random set realisations, realisations want provide vector specific realisations.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotRateIndividualRealisation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Individual Realisations of Posterior Rate of Sample Occurrence for Poisson Process Model — PlotRateIndividualRealisation","text":"","code":"PlotRateIndividualRealisation(   output_data,   n_realisations = 10,   plot_realisations_colour = NULL,   realisations = NULL,   calibration_curve = NULL,   plot_14C_age = TRUE,   plot_cal_age_scale = \"BP\",   interval_width = \"2sigma\",   bespoke_probability = NA,   denscale = 3,   resolution = 1,   n_burn = NA,   n_end = NA,   plot_pretty = TRUE,   plot_lwd = 2 )"},{"path":"https://tjheaton.github.io/carbondate/reference/PlotRateIndividualRealisation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Individual Realisations of Posterior Rate of Sample Occurrence for Poisson Process Model — PlotRateIndividualRealisation","text":"output_data return value updating function PPcalibrate. Optionally, output data can extra list item named label used set label plot legend. n_realisations Number randomly sampled realisations drawn MCMC posterior plotted. Default 10. plot_realisations_colour colours used plot individual realisations. Default greyscale (otherwise length number realisations). realisations Specific indices realisations (thinned version) plot user want sample realisations randomly). specified override n_realisations. calibration_curve usually required since name calibration curve variable saved output data. However, variable name longer environment pass calibration curve . provided, dataframe contain least 3 columns entitled calendar_age, c14_age c14_sig. format matches intcal20. plot_14C_age Whether use radiocarbon age (\\({}^{14}\\)C yr BP) units y-axis plot. Defaults TRUE. FALSE uses F\\({}^{14}\\)C concentration instead. plot_cal_age_scale (Optional) calendar scale use x-axis. Allowed values \"BP\", \"AD\" \"BC\". default \"BP\" corresponding plotting cal yr BP. interval_width confidence intervals show calibration curve. Choose one \"1sigma\" (68.3%), \"2sigma\" (95.4%) \"bespoke\". Default \"2sigma\". bespoke_probability probability use confidence interval \"bespoke\" chosen . E.g., 0.95 chosen, 95% confidence interval calculated. Ignored \"bespoke\" chosen. denscale (Optional) Whether scale vertical range Poisson process mean rate plot relative calibration curve plot. Default 3 means maximum mean rate 1/3 height plot. resolution distance calendar ages calculate value rate \\(\\lambda(t)\\). ages created regular grid automatically covers calendar period specified output_data. Default 1. n_burn number MCMC iterations discarded burn-(.e., considered occurring MCMC converged). relates number iterations (n_iter) running original update functions (thinned output_data). MCMC iterations used calculations. given, first half MCMC chain discarded. Note: maximum value function allow n_iter - 100 * n_thin (n_iter n_thin arguments given PPcalibrate) leave 100 (thinned) values output_data. n_end last iteration original MCMC chain use calculations. Assumed total number iterations performed, .e. n_iter, given. plot_pretty logical, defaulting TRUE. set TRUE select pretty plotting margins (create sufficient space axis titles rotates y-axis labels). FALSE implement current user values. plot_lwd line width use plotting posterior mean (confidence intervals). Default 2 (add emphasis).","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotRateIndividualRealisation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Individual Realisations of Posterior Rate of Sample Occurrence for Poisson Process Model — PlotRateIndividualRealisation","text":"None","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PlotRateIndividualRealisation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Individual Realisations of Posterior Rate of Sample Occurrence for Poisson Process Model — PlotRateIndividualRealisation","text":"","code":"#' # NOTE: All these examples are shown with a small n_iter and n_posterior_samples # to speed up execution. # Try n_iter and n_posterior_samples as the function defaults.  pp_output <- PPcalibrate(     pp_uniform_phase$c14_age,     pp_uniform_phase$c14_sig,     intcal20,     n_iter = 1000,     show_progress = FALSE)  # Plot 10 random realisations in greyscale PlotRateIndividualRealisation(     pp_output,     n_realisations = 10)   # Plot three random realisations with specific colours PlotRateIndividualRealisation(     pp_output,     n_realisations = 3,     plot_realisations_colour = c(\"red\", \"green\", \"purple\"))   # Plot some specific realisations PlotRateIndividualRealisation(     pp_output,     realisations = c(60, 73, 92),     plot_realisations_colour = c(\"red\", \"green\", \"purple\"))"},{"path":"https://tjheaton.github.io/carbondate/reference/PolyaUrnBivarDirichlet.html","id":null,"dir":"Reference","previous_headings":"","what":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Polya Urn Updating) — PolyaUrnBivarDirichlet","title":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Polya Urn Updating) — PolyaUrnBivarDirichlet","text":"function calibrates sets multiple radiocarbon (\\({}^{14}\\)C) determinations, simultaneously summarises resultant calendar age information. achieved using Bayesian non-parametric density estimation, providing statistically-rigorous alternative summed probability distributions (SPDs). takes input set \\({}^{14}\\)C determinations associated \\(1\\sigma\\) uncertainties, well radiocarbon age calibration curve used. samples assumed arise (unknown) shared calendar age distribution \\(f(\\theta)\\) like estimate, alongside performing calibration sample. function models underlying distribution \\(f(\\theta)\\) Dirichlet process mixture model (DPMM), whereby samples considered arise unknown number distinct clusters. Fitting achieved via MCMC. returns estimates calendar age individual radiocarbon sample; broader output (including means variances underpinning calendar age clusters) can used library functions provide predictive estimate shared calendar age density \\(f(\\theta)\\). information read vignette: vignette(\"Non-parametric-summed-density\", package = \"carbondate\") Note: library provides two slightly-different update schemes MCMC. particular function, updating DPMM achieved Polya Urn approach (Neal 2000) recommended updating approach based testing. alternative, slice-sampled, approach can found WalkerBivarDirichlet References:  Heaton, TJ. 2022. “Non-parametric Calibration Multiple Related Radiocarbon Determinations Calendar Age Summarisation.” Journal Royal Statistical Society Series C: Applied Statistics 71 (5):1918-56. https://doi.org/10.1111/rssc.12599.  Neal, RM. 2000. “Markov Chain Sampling Methods Dirichlet Process Mixture Models.” Journal Computational Graphical Statistics 9 (2):249 https://doi.org/10.2307/1390653.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PolyaUrnBivarDirichlet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Polya Urn Updating) — PolyaUrnBivarDirichlet","text":"","code":"PolyaUrnBivarDirichlet(   rc_determinations,   rc_sigmas,   calibration_curve,   F14C_inputs = FALSE,   n_iter = 1e+05,   n_thin = 10,   use_F14C_space = TRUE,   slice_width = NA,   slice_multiplier = 10,   n_clust = min(10, length(rc_determinations)),   show_progress = TRUE,   sensible_initialisation = TRUE,   lambda = NA,   nu1 = NA,   nu2 = NA,   A = NA,   B = NA,   alpha_shape = NA,   alpha_rate = NA,   mu_phi = NA,   calendar_ages = NA )"},{"path":"https://tjheaton.github.io/carbondate/reference/PolyaUrnBivarDirichlet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Polya Urn Updating) — PolyaUrnBivarDirichlet","text":"rc_determinations vector observed radiocarbon determinations. Can provided either \\({}^{14}\\)C ages (\\({}^{14}\\)C yr BP) F\\({}^{14}\\)C concentrations. rc_sigmas vector (1-sigma) measurement uncertainties radiocarbon determinations. Must length rc_determinations given units. calibration_curve dataframe must contain one column calendar_age_BP, also columns c14_age c14_sig f14c f14c_sig (sets). format matches curves supplied package, e.g., intcal20, intcal13, contain 5 columns. F14C_inputs TRUE provided rc_determinations F\\({}^{14}\\)C concentrations FALSE radiocarbon ages. Defaults FALSE. n_iter number MCMC iterations (optional). Default 100,000. n_thin much thin MCMC output (optional). store every n_thin\\({}^\\textrm{th}\\) iteration. 1 thinning, larger number result thinning. Default 10. Must choose integer greater 1. Overall number MCMC realisations stored \\(n_{\\textrm{}} = \\textrm{floor}( n_{\\textrm{iter}}/n_{\\textrm{thin}}) + 1\\) choose n_thin large ensure enough samples posterior use later inference. use_F14C_space TRUE (default) calculations within function carried F\\({}^{14}\\)C space. FALSE carried \\({}^{14}\\)C age space. recommend selecting TRUE , old samples, calibrating F\\({}^{14}\\)C space removes potential affect asymmetry radiocarbon age uncertainty. Note: flag can set independently format/scale rc_determinations originally provided. slice_width Parameter slice sampling (optional). given value chosen intelligently based spread initial calendar ages. Must given sensible_initialisation FALSE. slice_multiplier Integer parameter slice sampling (optional). Default 10. Limits slice size slice_multiplier * slice_width. n_clust number clusters initialise sampler (optional). Must less length rc_determinations. Default 10 length rc_determinations less 10. show_progress Whether show progress bar console execution. Default TRUE. sensible_initialisation Whether use sensible values initialise sampler automated (adaptive) prior \\(\\mu_{\\phi}\\) (, B) informed observed rc_determinations. TRUE (recommended default), remaining arguments ignored. lambda, nu1, nu2 Hyperparameters prior mean \\(\\phi_j\\) precision \\(\\tau_j\\) individual calendar age cluster \\(j\\): $$(\\phi_j, \\tau_j)|\\mu_{\\phi} \\sim \\textrm{NormalGamma}(\\mu_{\\phi}, \\lambda, \\nu_1, \\nu_2)$$ \\(\\mu_{\\phi}\\) overall cluster centering. Required sensible_initialisation FALSE. , B Prior \\(\\mu_{\\phi}\\) giving mean precision overall centering \\(\\mu_{\\phi} \\sim N(, B^{-1})\\). Required sensible_initialisation FALSE. alpha_shape, alpha_rate Shape rate hyperparameters specify prior Dirichlet Process (DP) concentration, \\(\\alpha\\). concentration \\(\\alpha\\) determines number clusters expect observe among \\(n\\) sampled objects. model places prior \\(\\alpha \\sim \\Gamma(\\eta_1, \\eta_2)\\), \\(\\eta_1, \\eta_2\\) alpha_shape alpha_rate. small \\(\\alpha\\) means DPMM concentrated (.e. expect fewer calendar age clusters) large alpha means less less concentrated (.e. many clusters). Required sensible_initialisation FALSE. mu_phi Initial value overall cluster centering \\(\\mu_{\\phi}\\). Required sensible_initialisation FALSE. calendar_ages initial estimate underlying calendar ages (optional). supplied, must vector length rc_determinations.  Required sensible_initialisation FALSE.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/PolyaUrnBivarDirichlet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Polya Urn Updating) — PolyaUrnBivarDirichlet","text":"list 10 items. first 8 items contain output model, one dimension size \\(n_{\\textrm{}} = \\textrm{floor}( n_{\\textrm{iter}}/n_{\\textrm{thin}}) + 1\\). rows items store state MCMC every \\(n_{\\textrm{thin}}\\)\\({}^\\textrm{th}\\) iteration: cluster_identifiers list length \\(n_{\\textrm{}}\\) entry gives cluster allocation (integer 1 n_clust) observation relevant MCMC iteration. Information state calendar age clusters (means precisions) can found output items. alpha double vector length \\(n_{\\textrm{}}\\) giving Dirichlet Process concentration parameter \\(\\alpha\\). n_clust integer vector length \\(n_{\\textrm{}}\\) giving current number clusters model. phi list length \\(n_{\\textrm{}}\\) entry giving vector length n_clust means current calendar age clusters \\(\\phi_j\\). tau list length \\(n_{\\textrm{}}\\) entry giving vector length n_clust precisions current calenadar age cluster \\(\\tau_j\\). observations_per_cluster list length \\(n_{\\textrm{}}\\) entry giving vector length n_clust number observations cluster. calendar_ages \\(n_{\\textrm{}}\\) \\(n_{\\textrm{obs}}\\) integer matrix. Gives current estimate calendar age individual observation. mu_phi vector length \\(n_{\\textrm{}}\\) giving overall centering \\(\\mu_{\\phi}\\) calendar age clusters. \\(n_{\\textrm{obs}}\\) number radiocarbon observations .e. length rc_determinations. remaining items give information input data, input parameters (calculated using sensible_initialisation) update_type update_type string always value \"Polya Urn\". input_data list containing \\({}^{14}\\)C data used, name calibration curve used. input_parameters list containing values fixed hyperparameters lambda, nu1, nu2, , B, alpha_shape, alpha_rate mu_phi, slice parameters slice_width slice_multiplier.","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/PolyaUrnBivarDirichlet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Polya Urn Updating) — PolyaUrnBivarDirichlet","text":"","code":"# Note these examples are shown with a small n_iter to speed up execution. # When you run ensure n_iter gives convergence (try function default).  # Basic usage making use of sensible initialisation to set most values and # using a saved example data set and the IntCal20 curve. polya_urn_output <- PolyaUrnBivarDirichlet(     two_normals$c14_age,     two_normals$c14_sig,     intcal20,     n_iter = 100,     show_progress = FALSE)  # The radiocarbon determinations can be given as F14C concentrations polya_urn_output <- PolyaUrnBivarDirichlet(     two_normals$f14c,     two_normals$f14c_sig,     intcal20,     F14C_inputs = TRUE,     n_iter = 100,     show_progress = FALSE)"},{"path":"https://tjheaton.github.io/carbondate/reference/WalkerBivarDirichlet.html","id":null,"dir":"Reference","previous_headings":"","what":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Walker Updating) — WalkerBivarDirichlet","title":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Walker Updating) — WalkerBivarDirichlet","text":"function calibrates sets multiple radiocarbon (\\({}^{14}\\)C) determinations, simultaneously summarises resultant calendar age information. achieved using Bayesian non-parametric density estimation, providing statistically-rigorous alternative summed probability distributions (SPDs). takes input set \\({}^{14}\\)C determinations associated \\(1\\sigma\\) uncertainties, well radiocarbon age calibration curve used. samples assumed arise (unknown) shared calendar age distribution \\(f(\\theta)\\) like estimate, alongside performing calibration sample. function models underlying distribution \\(f(\\theta)\\) Dirichlet process mixture model (DPMM), whereby samples considered arise unknown number distinct clusters. Fitting achieved via MCMC. returns estimates calendar age individual radiocarbon sample; broader output (weights, means variances underpinning calendar age clusters) can used library functions provide predictive estimate shared calendar age density \\(f(\\theta)\\). information read vignette: vignette(\"Non-parametric-summed-density\", package = \"carbondate\") Note: library provides two slightly-different update schemes MCMC. particular function, updating DPMM achieved slice sampling (Walker 2007). recommend use alternative , implemented PolyaUrnBivarDirichlet Reference:  Heaton, TJ. 2022. “Non-parametric Calibration Multiple Related Radiocarbon Determinations Calendar Age Summarisation.” Journal Royal Statistical Society Series C: Applied Statistics 71 (5):1918-56. https://doi.org/10.1111/rssc.12599.  Walker, SG. 2007. “Sampling Dirichlet Mixture Model Slices.” Communications Statistics - Simulation Computation 36 (1):45-54. https://doi.org/10.1080/03610910601096262.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/WalkerBivarDirichlet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Walker Updating) — WalkerBivarDirichlet","text":"","code":"WalkerBivarDirichlet(   rc_determinations,   rc_sigmas,   calibration_curve,   F14C_inputs = FALSE,   n_iter = 1e+05,   n_thin = 10,   use_F14C_space = TRUE,   slice_width = NA,   slice_multiplier = 10,   show_progress = TRUE,   sensible_initialisation = TRUE,   lambda = NA,   nu1 = NA,   nu2 = NA,   A = NA,   B = NA,   alpha_shape = NA,   alpha_rate = NA,   mu_phi = NA,   calendar_ages = NA,   n_clust = min(10, length(rc_determinations)) )"},{"path":"https://tjheaton.github.io/carbondate/reference/WalkerBivarDirichlet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Walker Updating) — WalkerBivarDirichlet","text":"rc_determinations vector observed radiocarbon determinations. Can provided either \\({}^{14}\\)C ages (\\({}^{14}\\)C yr BP) F\\({}^{14}\\)C concentrations. rc_sigmas vector (1-sigma) measurement uncertainties radiocarbon determinations. Must length rc_determinations given units. calibration_curve dataframe must contain one column calendar_age_BP, also columns c14_age c14_sig f14c f14c_sig (sets). format matches curves supplied package, e.g., intcal20, intcal13, contain 5 columns. F14C_inputs TRUE provided rc_determinations F\\({}^{14}\\)C concentrations FALSE radiocarbon ages. Defaults FALSE. n_iter number MCMC iterations (optional). Default 100,000. n_thin much thin MCMC output (optional). store every n_thin\\({}^\\textrm{th}\\) iteration. 1 thinning, larger number result thinning. Default 10. Must choose integer greater 1. Overall number MCMC realisations stored \\(n_{\\textrm{}} = \\textrm{floor}( n_{\\textrm{iter}}/n_{\\textrm{thin}}) + 1\\) choose n_thin large ensure enough samples posterior use later inference. use_F14C_space TRUE (default) calculations within function carried F\\({}^{14}\\)C space. FALSE carried \\({}^{14}\\)C age space. recommend selecting TRUE , old samples, calibrating F\\({}^{14}\\)C space removes potential affect asymmetry radiocarbon age uncertainty. Note: flag can set independently format/scale rc_determinations originally provided. slice_width Parameter slice sampling (optional). given value chosen intelligently based spread initial calendar ages. Must given sensible_initialisation FALSE. slice_multiplier Integer parameter slice sampling (optional). Default 10. Limits slice size slice_multiplier * slice_width. show_progress Whether show progress bar console execution. Default TRUE. sensible_initialisation Whether use sensible values initialise sampler automated (adaptive) prior \\(\\mu_{\\phi}\\) (, B) informed observed rc_determinations. TRUE (recommended default), remaining arguments ignored. lambda, nu1, nu2 Hyperparameters prior mean \\(\\phi_j\\) precision \\(\\tau_j\\) individual calendar age cluster \\(j\\): $$(\\phi_j, \\tau_j)|\\mu_{\\phi} \\sim \\textrm{NormalGamma}(\\mu_{\\phi}, \\lambda, \\nu_1, \\nu_2)$$ \\(\\mu_{\\phi}\\) overall cluster centering. Required sensible_initialisation FALSE. , B Prior \\(\\mu_{\\phi}\\) giving mean precision overall centering \\(\\mu_{\\phi} \\sim N(, B^{-1})\\). Required sensible_initialisation FALSE. alpha_shape, alpha_rate Shape rate hyperparameters specify prior Dirichlet Process (DP) concentration, \\(\\alpha\\). concentration \\(\\alpha\\) determines number clusters expect observe among \\(n\\) sampled objects. model places prior \\(\\alpha \\sim \\Gamma(\\eta_1, \\eta_2)\\), \\(\\eta_1, \\eta_2\\) alpha_shape alpha_rate. small \\(\\alpha\\) means DPMM concentrated (.e. expect fewer calendar age clusters) large alpha means less less concentrated (.e. many clusters). Required sensible_initialisation FALSE. mu_phi Initial value overall cluster centering \\(\\mu_{\\phi}\\). Required sensible_initialisation FALSE. calendar_ages initial estimate underlying calendar ages (optional). supplied, must vector length rc_determinations.  Required sensible_initialisation FALSE. n_clust number clusters initialise sampler (optional). Must less length rc_determinations. Default 10 length rc_determinations less 10.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/WalkerBivarDirichlet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Walker Updating) — WalkerBivarDirichlet","text":"list 11 items. first 8 items contain output model, one dimension size \\(n_{\\textrm{}} = \\textrm{floor}( n_{\\textrm{iter}}/n_{\\textrm{thin}}) + 1\\). rows items store state MCMC every \\(n_{\\textrm{thin}}\\)\\({}^\\textrm{th}\\) iteration: cluster_identifiers \\(n_{\\textrm{}}\\) \\(n_{\\textrm{obs}}\\) integer matrix. Provides cluster allocation (integer 1 n_clust) observation relevant MCMC iteration. Information state calendar age clusters (means, precisions, weights) can found output items. alpha double vector length \\(n_{\\textrm{}}\\) giving Dirichlet Process concentration parameter \\(\\alpha\\). n_clust integer vector length \\(n_{\\textrm{}}\\) giving current number clusters model. phi list length \\(n_{\\textrm{}}\\) entry giving vector means current calendar age clusters \\(\\phi_j\\). tau list length \\(n_{\\textrm{}}\\) entry giving vector precisions current calendar age clusters \\(\\tau_j\\). weight list length \\(n_{\\textrm{}}\\) entry giving mixing weights calendar age cluster. calendar_ages \\(n_{\\textrm{}}\\) \\(n_{\\textrm{obs}}\\) integer matrix. Gives current estimate calendar age individual observation. mu_phi vector length \\(n_{\\textrm{}}\\) giving overall centering \\(\\mu_{\\phi}\\) calendar age clusters. \\(n_{\\textrm{obs}}\\) number radiocarbon observations, .e., length rc_determinations. remaining items give information input data, input parameters (calculated using sensible_initialisation) update_type update_type string always value \"Walker\". input_data list containing \\({}^{14}\\)C data used, name calibration curve used. input_parameters list containing values fixed hyperparameters lambda, nu1, nu2, , B, alpha_shape, alpha_rate, slice parameters slice_width slice_multiplier.","code":""},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/WalkerBivarDirichlet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calibrate and Summarise Multiple Radiocarbon Samples via a Bayesian Non-Parametric DPMM (with Walker Updating) — WalkerBivarDirichlet","text":"","code":"# NOTE: These examples are shown with a small n_iter to speed up execution. # When you run ensure n_iter gives convergence (try function default).  walker_output <- WalkerBivarDirichlet(     two_normals$c14_age,     two_normals$c14_sig,     intcal20,     n_iter = 100,     show_progress = FALSE)  # The radiocarbon determinations can be given as F14C concentrations walker_output <- WalkerBivarDirichlet(     two_normals$f14c,     two_normals$f14c_sig,     intcal20,     F14C_inputs = TRUE,     n_iter = 100,     show_progress = FALSE)"},{"path":"https://tjheaton.github.io/carbondate/reference/alces.html","id":null,"dir":"Reference","previous_headings":"","what":"Example real-life data - Alces in Yukon and Alaska — alces","title":"Example real-life data - Alces in Yukon and Alaska — alces","text":"58 radiocarbon determinations collated Dale Guthrie, R. related Alces (moose) Yukon Alaska. Samples restricted 25,000–6000 \\({}^{14}\\)C yrs BP. Reference:  Dale Guthrie, R. New carbon dates link climatic change human colonization Pleistocene extinctions. Nature 441, 207–209 (2006). https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/alces.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example real-life data - Alces in Yukon and Alaska — alces","text":"","code":"alces"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/alces.html","id":"alces","dir":"Reference","previous_headings":"","what":"alces","title":"Example real-life data - Alces in Yukon and Alaska — alces","text":"data frame 58 rows 7 columns: lab_code sample code \\({}^{14}\\)C laboratory site_code site/museum code location location sample c14_age observed \\({}^{14}\\)C ages samples (\\({}^{14}\\)C yr BP) c14_sig uncertainty observed \\({}^{14}\\)C ages reported radiocarbon laboratory f14c observed F\\({}^{14}\\)C concentrations f14c_sig uncertainty observed F\\({}^{14}\\)C concentrations reported radiocarbon laboratory","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/alces.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example real-life data - Alces in Yukon and Alaska — alces","text":"https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/armit.html","id":null,"dir":"Reference","previous_headings":"","what":"Example real-life data - Population Decline in Iron Age Ireland — armit","title":"Example real-life data - Population Decline in Iron Age Ireland — armit","text":"2021 radiocarbon determinations collated Armit et al. archaeological groups operating Ireland, investigate whether wetter environment around 2700 cal yr BP led population collapse. Reference:  Armit, ., Swindles, G.T., Becker, K., Plunkett, G., Blaauw, M., 2014. Rapid climate change cause population collapse end European Bronze Age. Proceedings National Academy Sciences 111, 17045–17049.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/armit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example real-life data - Population Decline in Iron Age Ireland — armit","text":"","code":"armit"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/armit.html","id":"armit","dir":"Reference","previous_headings":"","what":"armit","title":"Example real-life data - Population Decline in Iron Age Ireland — armit","text":"data frame 2021 rows 4 columns: c14_age observed \\({}^{14}\\)C ages samples (\\({}^{14}\\)C yr BP) c14_sig uncertainty observed \\({}^{14}\\)C ages reported radiocarbon laboratory f14c observed F\\({}^{14}\\)C concentrations f14c_sig uncertainty observed F\\({}^{14}\\)C concentrations reported radiocarbon laboratory","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/armit.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example real-life data - Population Decline in Iron Age Ireland — armit","text":"http://doi.org/10.1073/pnas.1408028111","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/bison.html","id":null,"dir":"Reference","previous_headings":"","what":"Example real-life data - Bison in Yukon and Alaska — bison","title":"Example real-life data - Bison in Yukon and Alaska — bison","text":"64 radiocarbon determinations collated Dale Guthrie, R. related Bison Yukon Alaska. Samples restricted 25,000–6000 \\({}^{14}\\)C yrs BP.Reference:  Dale Guthrie, R. New carbon dates link climatic change human colonization Pleistocene extinctions. Nature 441, 207–209 (2006). https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/bison.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example real-life data - Bison in Yukon and Alaska — bison","text":"","code":"bison"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/bison.html","id":"bison","dir":"Reference","previous_headings":"","what":"bison","title":"Example real-life data - Bison in Yukon and Alaska — bison","text":"data frame 64 rows 7 columns: lab_code sample code \\({}^{14}\\)C laboratory site_code site/museum code location location sample c14_age observed \\({}^{14}\\)C ages samples (\\({}^{14}\\)C yr BP) c14_sig uncertainty observed \\({}^{14}\\)C ages reported radiocarbon laboratory f14c observed F\\({}^{14}\\)C concentrations f14c_sig uncertainty observed F\\({}^{14}\\)C concentrations reported radiocarbon laboratory","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/bison.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example real-life data - Bison in Yukon and Alaska — bison","text":"https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/buchanan.html","id":null,"dir":"Reference","previous_headings":"","what":"Example real-life data - Palaeo-Indian demography — buchanan","title":"Example real-life data - Palaeo-Indian demography — buchanan","text":"628 radiocarbon determinations collated Buchanan et al. representing ages distinct archaeological  sites found across Canada North America time palaeoindians. Reference:  Buchanan, B., Collard, M., Edinborough, K., 2008. Paleoindian demography extraterrestrial impact hypothesis. Proceedings National Academy Sciences 105, 11651–11654.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/buchanan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example real-life data - Palaeo-Indian demography — buchanan","text":"","code":"buchanan"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/buchanan.html","id":"buchanan","dir":"Reference","previous_headings":"","what":"buchanan","title":"Example real-life data - Palaeo-Indian demography — buchanan","text":"data frame 628 rows 4 columns: c14_age observed \\({}^{14}\\)C ages samples (\\({}^{14}\\)C yr BP) c14_sig uncertainty observed \\({}^{14}\\)C ages reported radiocarbon laboratory f14c observed F\\({}^{14}\\)C concentrations f14c_sig uncertainty observed F\\({}^{14}\\)C concentrations reported radiocarbon laboratory","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/buchanan.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example real-life data - Palaeo-Indian demography — buchanan","text":"http://doi.org/10.1073/pnas.0803762105","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/cervus.html","id":null,"dir":"Reference","previous_headings":"","what":"Example real-life data - Cervus in Yukon and Alaska — cervus","title":"Example real-life data - Cervus in Yukon and Alaska — cervus","text":"63 radiocarbon determinations collated Dale Guthrie, R. related Cervus (wapiti) Yukon Alaska. Samples restricted 25,000–6000 \\({}^{14}\\)C yrs BP. Reference:  Dale Guthrie, R. New carbon dates link climatic change human colonization Pleistocene extinctions. Nature 441, 207–209 (2006). https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/cervus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example real-life data - Cervus in Yukon and Alaska — cervus","text":"","code":"cervus"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/cervus.html","id":"cervus","dir":"Reference","previous_headings":"","what":"cervus","title":"Example real-life data - Cervus in Yukon and Alaska — cervus","text":"data frame 63 rows 7 columns: lab_code sample code \\({}^{14}\\)C laboratory site_code site/museum code location location sample c14_age observed \\({}^{14}\\)C ages samples (\\({}^{14}\\)C yr BP) c14_sig uncertainty observed \\({}^{14}\\)C ages reported radiocarbon laboratory f14c observed F\\({}^{14}\\)C concentrations f14c_sig uncertainty observed F\\({}^{14}\\)C concentrations reported radiocarbon laboratory","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/cervus.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example real-life data - Cervus in Yukon and Alaska — cervus","text":"https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/equus.html","id":null,"dir":"Reference","previous_headings":"","what":"Example real-life data - Equus in Yukon and Alaska — equus","title":"Example real-life data - Equus in Yukon and Alaska — equus","text":"84 radiocarbon determinations collated Dale Guthrie, R. related Equus (horse) Yukon Alaska. Samples restricted 25,000–6000 \\({}^{14}\\)C yrs BP. Reference:  Dale Guthrie, R. New carbon dates link climatic change human colonization Pleistocene extinctions. Nature 441, 207–209 (2006). https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/equus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example real-life data - Equus in Yukon and Alaska — equus","text":"","code":"equus"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/equus.html","id":"equus","dir":"Reference","previous_headings":"","what":"equus","title":"Example real-life data - Equus in Yukon and Alaska — equus","text":"data frame 84 rows 7 columns: lab_code sample code \\({}^{14}\\)C laboratory site_code site/museum code location location sample c14_age observed \\({}^{14}\\)C ages samples (\\({}^{14}\\)C yr BP) c14_sig uncertainty observed \\({}^{14}\\)C ages reported radiocarbon laboratory f14c observed F\\({}^{14}\\)C concentrations f14c_sig uncertainty observed F\\({}^{14}\\)C concentrations reported radiocarbon laboratory","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/equus.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example real-life data - Equus in Yukon and Alaska — equus","text":"https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/human.html","id":null,"dir":"Reference","previous_headings":"","what":"Example real-life data - Humans in Yukon and Alaska — human","title":"Example real-life data - Humans in Yukon and Alaska — human","text":"46 radiocarbon determinations collated Dale Guthrie, R. related archaeological sites (.e., evidence human existence) Alaska. Samples restricted 25,000–6000 \\({}^{14}\\)C yrs BP. Reference:  Dale Guthrie, R. New carbon dates link climatic change human colonization Pleistocene extinctions. Nature 441, 207–209 (2006). https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/human.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example real-life data - Humans in Yukon and Alaska — human","text":"","code":"human"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/human.html","id":"human","dir":"Reference","previous_headings":"","what":"human","title":"Example real-life data - Humans in Yukon and Alaska — human","text":"data frame 46 rows 7 columns: lab_code sample code \\({}^{14}\\)C laboratory site_code site/museum code location location sample c14_age observed \\({}^{14}\\)C ages samples (\\({}^{14}\\)C yr BP) c14_sig uncertainty observed \\({}^{14}\\)C ages reported radiocarbon laboratory f14c observed F\\({}^{14}\\)C concentrations f14c_sig uncertainty observed F\\({}^{14}\\)C concentrations reported radiocarbon laboratory","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/human.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example real-life data - Humans in Yukon and Alaska — human","text":"https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal04.html","id":null,"dir":"Reference","previous_headings":"","what":"IntCal04 calibration curve — intcal04","title":"IntCal04 calibration curve — intcal04","text":"IntCal04 Northern Hemisphere radiocarbon age calibration curve calendar grid spanning 26,000–0 cal yr BP (Present, 0 cal yr BP corresponds 1950 CE). Note: dataset provides \\({}^{14}\\)C ages F\\({}^{14}\\)C values calendar age grid. different \\({}^{14}\\)C ages \\({\\Delta}^{14}\\)C values provided oxcal .14c files.Reference:  PJ Reimer, MGL Baillie, E Bard, Bayliss, JW Beck, C Bertrand, PG Blackwell, CE Buck, G Burr, KB Cutler, PE Damon, RL Edwards, RG Fairbanks, M Friedrich, TP Guilderson, KA Hughen, B Kromer, FG McCormac, S Manning, C Bronk Ramsey, RW Reimer, S Remmele, JR Southon, M Stuiver, S Talamo, FW Taylor, J van der Plicht, CE Weyhenmeyer. 2004. Intcal04 Terrestrial Radiocarbon Age Calibration, 0–26 Cal Kyr BP. Radiocarbon 46(3):1029-1058 https://doi.org/10.1017/S0033822200032999.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal04.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IntCal04 calibration curve — intcal04","text":"","code":"intcal04"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/intcal04.html","id":"intcal-","dir":"Reference","previous_headings":"","what":"intcal04","title":"IntCal04 calibration curve — intcal04","text":"data frame 3,301 rows 5 columns providing IntCal04 radiocarbon age calibration curve calendar grid spanning 26,000–0 cal yr BP: calendar_age calendar age (cal yr BP) c14_age \\({}^{14}\\)C age (\\({}^{14}\\)C yr BP) c14_sig (1-\\(\\sigma\\)) uncertainty \\({}^{14}\\)C age f14c \\({}^{14}\\)C age expressed F\\({}^{14}\\)C concentration f14c_sig (1-\\(\\sigma\\)) uncertainty F\\({}^{14}\\)C concentration","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal04.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"IntCal04 calibration curve — intcal04","text":"https://doi.org/10.1017/S0033822200032999","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal09.html","id":null,"dir":"Reference","previous_headings":"","what":"IntCal09 calibration curve — intcal09","title":"IntCal09 calibration curve — intcal09","text":"IntCal09 Northern Hemisphere radiocarbon age calibration curve calendar grid spanning 50,000–0 cal yr BP (Present, 0 cal yr BP corresponds 1950 CE). Note: dataset provides \\({}^{14}\\)C ages F\\({}^{14}\\)C values calendar age grid. different \\({}^{14}\\)C ages \\({\\Delta}^{14}\\)C values provided oxcal .14c files.Reference:  PJ Reimer, MGL Baillie, E Bard, Bayliss, JW Beck, PG Blackwell, C Bronk Ramsey, CE Buck, GS Burr, RL Edwards, M Friedrich, PM Grootes, TP Guilderson, Hajdas, TJ Heaton, AG Hogg, KA Hughen, KF Kaiser, B Kromer, FG McCormac, SW Manning, RW Reimer, DA Richards, JR Southon, S Talamo, CSM Turney, J van der Plicht, CE Weyhenmeyer. 2009. IntCal09 Marine09 Radiocarbon Age Calibration Curves, 0–50,000 Years cal BP Radiocarbon 51(4):1111-1150 https://doi.org/10.1017/S0033822200034202.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal09.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IntCal09 calibration curve — intcal09","text":"","code":"intcal09"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/intcal09.html","id":"intcal-","dir":"Reference","previous_headings":"","what":"intcal09","title":"IntCal09 calibration curve — intcal09","text":"data frame 3,521 rows 5 columns providing IntCal09 radiocarbon age calibration curve calendar grid spanning 50,000–0 cal yr BP: calendar_age calendar age (cal yr BP) c14_age \\({}^{14}\\)C age (\\({}^{14}\\)C yr BP) c14_sig (1-\\(\\sigma\\)) uncertainty \\({}^{14}\\)C age f14c \\({}^{14}\\)C age expressed F\\({}^{14}\\)C concentration f14c_sig (1-\\(\\sigma\\)) uncertainty F\\({}^{14}\\)C concentration","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal09.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"IntCal09 calibration curve — intcal09","text":"http://doi.org/10.1017/S0033822200034202","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal13.html","id":null,"dir":"Reference","previous_headings":"","what":"IntCal13 calibration curve — intcal13","title":"IntCal13 calibration curve — intcal13","text":"IntCal13 Northern Hemisphere radiocarbon age calibration curve calendar grid spanning 50,000–0 cal yr BP (Present, 0 cal yr BP corresponds 1950 CE). Note: dataset provides \\({}^{14}\\)C ages F\\({}^{14}\\)C values calendar age grid. different \\({}^{14}\\)C ages \\({\\Delta}^{14}\\)C values provided oxcal .14c files.Reference:  Reimer PJ, Bard E, Bayliss , Beck JW, Blackwell PG, Bronk Ramsey C, Buck CE, Cheng H, Edwards RL, Friedrich M, Grootes PM, Guilderson TP, Haflidason H, Hajdas , Hatt? C, Heaton TJ, Hogg AG, Hughen KA, Kaiser KF, Kromer B, Manning SW, Niu M, Reimer RW, Richards DA, Scott EM, Southon JR, Turney CSM, van der Plicht J. 2013. IntCal13 Marine13 radiocarbon age calibration curves 0–50000 years calBP. Radiocarbon 55(4) https://doi.org/10.2458/azu_js_rc.55.16947.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal13.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IntCal13 calibration curve — intcal13","text":"","code":"intcal13"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/intcal13.html","id":"intcal-","dir":"Reference","previous_headings":"","what":"intcal13","title":"IntCal13 calibration curve — intcal13","text":"data frame 5,141 rows 5 columns providing IntCal13 radiocarbon age calibration curve calendar grid spanning 50,000–0 cal yr BP: calendar_age calendar age (cal yr BP) c14_age \\({}^{14}\\)C age (\\({}^{14}\\)C yr BP) c14_sig (1-\\(\\sigma\\)) uncertainty \\({}^{14}\\)C age f14c \\({}^{14}\\)C age expressed F\\({}^{14}\\)C concentration f14c_sig (1-\\(\\sigma\\)) uncertainty F\\({}^{14}\\)C concentration","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal13.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"IntCal13 calibration curve — intcal13","text":"http://doi.org/10.2458/azu_js_rc.55.16947","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal20.html","id":null,"dir":"Reference","previous_headings":"","what":"IntCal20 calibration curve — intcal20","title":"IntCal20 calibration curve — intcal20","text":"IntCal20 Northern Hemisphere radiocarbon age calibration curve calendar grid spanning 55,000–0 cal yr BP (Present, 0 cal yr BP corresponds 1950 CE). Note: dataset provides \\({}^{14}\\)C ages F\\({}^{14}\\)C values calendar age grid. different \\({}^{14}\\)C ages \\({\\Delta}^{14}\\)C values provided oxcal .14c files.Reference:  Reimer PJ, Austin WEN, Bard E, Bayliss , Blackwell PG, Bronk Ramsey C, Butzin M, Cheng H, Edwards RL, Friedrich M, Grootes PM, Guilderson TP, Hajdas , Heaton TJ, Hogg AG, Hughen KA, Kromer B, Manning SW, Muscheler R, Palmer JG, Pearson C, van der Plicht J, Reimer RW, Richards DA, Scott EM, Southon JR, Turney CSM, Wacker L, Adolphi F, Büntgen U, Capano M, Fahrni S, Fogtmann-Schulz , Friedrich R, Köhler P, Kudsk S, Miyake F, Olsen J, Reinig F, Sakamoto M, Sookdeo , Talamo S. 2020. IntCal20 Northern Hemisphere radiocarbon age calibration curve (0-55 cal kBP). Radiocarbon 62 https://doi.org/10.1017/RDC.2020.41.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal20.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IntCal20 calibration curve — intcal20","text":"","code":"intcal20"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/intcal20.html","id":"intcal-","dir":"Reference","previous_headings":"","what":"intcal20","title":"IntCal20 calibration curve — intcal20","text":"data frame 9,501 rows 5 columns providing IntCal20 radiocarbon age calibration curve calendar grid spanning 55,000–0 cal yr BP: calendar_age calendar age (cal yr BP) c14_age \\({}^{14}\\)C age (\\({}^{14}\\)C yr BP) c14_sig (1-\\(\\sigma\\)) uncertainty \\({}^{14}\\)C age f14c \\({}^{14}\\)C age expressed F\\({}^{14}\\)C concentration f14c_sig (1-\\(\\sigma\\)) uncertainty F\\({}^{14}\\)C concentration","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal20.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"IntCal20 calibration curve — intcal20","text":"http://doi.org/10.1017/RDC.2020.41","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal98.html","id":null,"dir":"Reference","previous_headings":"","what":"IntCal98 calibration curve — intcal98","title":"IntCal98 calibration curve — intcal98","text":"IntCal98 Northern Hemisphere radiocarbon age calibration curve calendar grid spanning 24,000–0 cal yr BP (Present, 0 cal yr BP corresponds 1950 CE). Note: dataset provides \\({}^{14}\\)C ages F\\({}^{14}\\)C values calendar age grid. different \\({}^{14}\\)C ages \\({\\Delta}^{14}\\)C values provided oxcal .14c files.Reference:  M. Stuiver, P. J. Reimer, E. Bard, J. W. Beck, G. S. Burr, K. . Hughen, B. Kromer, F. G. McCormac, J. v. d. Plicht M. Spurk. 1998. INTCAL98 Radiocarbon Age Calibration, 24,000–0 cal BP. Radiocarbon 40(3):1041-1083 https://doi.org/10.1017/S0033822200019123.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal98.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IntCal98 calibration curve — intcal98","text":"","code":"intcal98"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/intcal98.html","id":"intcal-","dir":"Reference","previous_headings":"","what":"intcal98","title":"IntCal98 calibration curve — intcal98","text":"data frame 1,538 rows 5 columns providing IntCal98 radiocarbon age calibration curve calendar grid spanning 24,000–0 cal yr BP: calendar_age calendar age (cal yr BP) c14_age \\({}^{14}\\)C age (\\({}^{14}\\)C yr BP) c14_sig (1-\\(\\sigma\\)) uncertainty \\({}^{14}\\)C age f14c \\({}^{14}\\)C age expressed F\\({}^{14}\\)C concentration f14c_sig (1-\\(\\sigma\\)) uncertainty F\\({}^{14}\\)C concentration","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/intcal98.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"IntCal98 calibration curve — intcal98","text":"https://doi.org/10.1017/S0033822200019123","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/kerr.html","id":null,"dir":"Reference","previous_headings":"","what":"Example real-life data - Irish Rath — kerr","title":"Example real-life data - Irish Rath — kerr","text":"255 radiocarbon determinations collated Kerr McCormick related building use raths Ireland early-medieval period. Reference:  Kerr, T., McCormick, F., 2014. Statistics, sunspots settlement: influences sum probability curves. Journal Archaeological Science 41, 493–501.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/kerr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example real-life data - Irish Rath — kerr","text":"","code":"kerr"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/kerr.html","id":"kerr","dir":"Reference","previous_headings":"","what":"kerr","title":"Example real-life data - Irish Rath — kerr","text":"data frame 255 rows 4 columns: c14_age observed \\({}^{14}\\)C ages samples (\\({}^{14}\\)C yr BP) c14_sig uncertainty observed \\({}^{14}\\)C ages reported radiocarbon laboratory f14c observed F\\({}^{14}\\)C concentrations f14c_sig uncertainty observed F\\({}^{14}\\)C concentrations reported radiocarbon laboratory","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/kerr.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example real-life data - Irish Rath — kerr","text":"http://doi.org/10.1016/j.jas.2013.09.002","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/mammuthus.html","id":null,"dir":"Reference","previous_headings":"","what":"Example real-life data - Mammuthus in Yukon and Alaska — mammuthus","title":"Example real-life data - Mammuthus in Yukon and Alaska — mammuthus","text":"117 radiocarbon determinations collated Dale Guthrie, R. related Mammuthus (mammoth) Yukon Alaska. Samples restricted 25,000–6000 \\({}^{14}\\)C yrs BP. Reference:  Dale Guthrie, R. New carbon dates link climatic change human colonization Pleistocene extinctions. Nature 441, 207–209 (2006). https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/mammuthus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example real-life data - Mammuthus in Yukon and Alaska — mammuthus","text":"","code":"mammuthus"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/mammuthus.html","id":"mammuthus","dir":"Reference","previous_headings":"","what":"mammuthus","title":"Example real-life data - Mammuthus in Yukon and Alaska — mammuthus","text":"data frame 117 rows 7 columns: lab_code sample code \\({}^{14}\\)C laboratory site_code site/museum code location location sample c14_age observed \\({}^{14}\\)C ages samples (\\({}^{14}\\)C yr BP) c14_sig uncertainty observed \\({}^{14}\\)C ages reported radiocarbon laboratory f14c observed F\\({}^{14}\\)C concentrations f14c_sig uncertainty observed F\\({}^{14}\\)C concentrations reported radiocarbon laboratory","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/mammuthus.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example real-life data - Mammuthus in Yukon and Alaska — mammuthus","text":"https://doi.org/10.1038/nature04604","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/pp_uniform_phase.html","id":null,"dir":"Reference","previous_headings":"","what":"Example artificial data - Uniform Phase — pp_uniform_phase","title":"Example artificial data - Uniform Phase — pp_uniform_phase","text":"40 simulated radiocarbon determinations underlying calendar ages drawn (uniformly random) period  550–500 cal yr BP. $$f(\\theta) = U[550, 500]$$ observational uncertainty determination set 15 \\({}^{14}\\)C yrs.  corresponding \\({}^{14}\\)C ages simulated based upon IntCal20 calibration curve (convolved 15 \\({}^{14}\\)C yr measurement uncertainty): $$X_i | \\theta_i \\sim N(m(\\theta_i), \\rho(\\theta_i)^2 + 15^2),$$ \\(m(\\theta_i)\\) \\(\\rho(\\theta_i)\\) IntCal20 pointwise means uncertainties.  dataset matches used package vignette illustrate Poisson process modelling.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/pp_uniform_phase.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example artificial data - Uniform Phase — pp_uniform_phase","text":"","code":"pp_uniform_phase"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/pp_uniform_phase.html","id":"pp-uniform-phase","dir":"Reference","previous_headings":"","what":"pp_uniform_phase","title":"Example artificial data - Uniform Phase — pp_uniform_phase","text":"data frame 40 rows 4 columns: c14_age simulated \\({}^{14}\\)C age (\\({}^{14}\\)C yr BP) c14_sig (fixed) \\({}^{14}\\)C age measurement uncertainty used simulation (set 15 \\({}^{14}\\)C yrs) f14c corresponding simulated values F\\({}^{14}\\)C concentration f14c_sig (fixed) corresponding F\\({}^{14}\\)C measurement uncertainty used simulation","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/shcal04.html","id":null,"dir":"Reference","previous_headings":"","what":"SHCal04 calibration curve — shcal04","title":"SHCal04 calibration curve — shcal04","text":"SHCal04 Southern Hemisphere radiocarbon age calibration curve calendar grid spanning 11,000–0 cal yr BP (Present, 0 cal yr BP corresponds 1950 CE). Note: dataset provides \\({}^{14}\\)C ages F\\({}^{14}\\)C values calendar age grid. different \\({}^{14}\\)C ages \\({\\Delta}^{14}\\)C values provided oxcal .14c files.Reference:  FG McCormac, AG Hogg, PG Blackwell, CE Buck, TFG Higham, PJ Reimer 2004. SHCal04 Southern Hemisphere Calibration 0–11.0 cal kyr BP. Radiocarbon 46(3):1087–1092 https://doi.org/10.1017/S0033822200033014.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/shcal04.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SHCal04 calibration curve — shcal04","text":"","code":"shcal04"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/shcal04.html","id":"shcal-","dir":"Reference","previous_headings":"","what":"shcal04","title":"SHCal04 calibration curve — shcal04","text":"data frame 2,202 rows 5 columns providing SHCal04 radiocarbon age calibration curve calendar grid spanning 11,000–0 cal yr BP: calendar_age calendar age (cal yr BP) c14_age \\({}^{14}\\)C age (\\({}^{14}\\)C yr BP) c14_sig (1-\\(\\sigma\\)) uncertainty \\({}^{14}\\)C age f14c \\({}^{14}\\)C age expressed F\\({}^{14}\\)C concentration f14c_sig (1-\\(\\sigma\\)) uncertainty F\\({}^{14}\\)C concentration","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/shcal04.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"SHCal04 calibration curve — shcal04","text":"http://doi.org/10.1017/S0033822200033014","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/shcal13.html","id":null,"dir":"Reference","previous_headings":"","what":"SHCal13 calibration curve — shcal13","title":"SHCal13 calibration curve — shcal13","text":"SHCal13 Southern Hemisphere radiocarbon age calibration curve calendar grid spanning 50,000–0 cal yr BP (Present, 0 cal yr BP corresponds 1950 CE). Note: dataset provides \\({}^{14}\\)C ages F\\({}^{14}\\)C values calendar age grid. different \\({}^{14}\\)C ages \\({\\Delta}^{14}\\)C values provided oxcal .14c files.Reference:  Alan G Hogg, Quan Hua, Paul G Blackwell, Caitlin E Buck, Thomas P Guilderson, Timothy J  Heaton, Mu Niu, Jonathan G Palmer, Paula J Reimer, Ron W Reimer, Christian S M Turney, Susan R H Zimmerman. 2013. SHCal13 Southern Hemisphere Calibration, 0-50,000 Years cal BP. Radiocarbon 55(4):1889–1903 https://doi.org/10.2458/azu_js_rc.55.16783.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/shcal13.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SHCal13 calibration curve — shcal13","text":"","code":"shcal13"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/shcal13.html","id":"shcal-","dir":"Reference","previous_headings":"","what":"shcal13","title":"SHCal13 calibration curve — shcal13","text":"data frame 5,141 rows 5 columns providing SHCal13 radiocarbon age calibration curve calendar grid spanning 50,000–0 cal yr BP: calendar_age calendar age (cal yr BP) c14_age \\({}^{14}\\)C age (\\({}^{14}\\)C yr BP) c14_sig (1-\\(\\sigma\\)) uncertainty \\({}^{14}\\)C age f14c \\({}^{14}\\)C age expressed F\\({}^{14}\\)C concentration f14c_sig (1-\\(\\sigma\\)) uncertainty F\\({}^{14}\\)C concentration","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/shcal13.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"SHCal13 calibration curve — shcal13","text":"http://doi.org/10.2458/azu_js_rc.55.16783","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/shcal20.html","id":null,"dir":"Reference","previous_headings":"","what":"SHCal20 calibration curve — shcal20","title":"SHCal20 calibration curve — shcal20","text":"SHCal20 Southern Hemisphere radiocarbon age calibration curve calendar grid spanning 55,000–0 cal yr BP (Present, 0 cal yr BP corresponds 1950 CE). Note: dataset provides \\({}^{14}\\)C ages F\\({}^{14}\\)C values calendar age grid. different \\({}^{14}\\)C ages \\({\\Delta}^{14}\\)C values provided oxcal .14c files.Reference:  Hogg AG, Heaton TJ, Hua Q, Palmer JG, Turney CSM, Southon J, Bayliss , Blackwell PG, Boswijk G, Bronk Ramsey C, Pearson C, Petchey F, Reimer P, Reimer R, Wacker L. 2020. SHCal20 Southern Hemisphere calibration, 0–55,000 years cal BP. Radiocarbon 62 https://doi.org/10.1017/RDC.2020.59.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/shcal20.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SHCal20 calibration curve — shcal20","text":"","code":"shcal20"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/shcal20.html","id":"shcal-","dir":"Reference","previous_headings":"","what":"shcal20","title":"SHCal20 calibration curve — shcal20","text":"data frame 9,501 rows 5 columns providing SHCal20 radiocarbon age calibration curve calendar grid spanning 55,000–0 cal yr BP: calendar_age calendar age (cal yr BP) c14_age \\({}^{14}\\)C age (\\({}^{14}\\)C yr BP) c14_sig (1-\\(\\sigma\\)) uncertainty \\({}^{14}\\)C age f14c \\({}^{14}\\)C age expressed F\\({}^{14}\\)C concentration f14c_sig (1-\\(\\sigma\\)) uncertainty F\\({}^{14}\\)C concentration","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/shcal20.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"SHCal20 calibration curve — shcal20","text":"http://doi.org/10.1017/RDC.2020.59","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/two_normals.html","id":null,"dir":"Reference","previous_headings":"","what":"Example artificial data - Mixture of Normal Phases — two_normals","title":"Example artificial data - Mixture of Normal Phases — two_normals","text":"50 simulated radiocarbon determinations underlying calendar ages drawn mixture two normals: $$f(\\theta) = 0.45 N(3500, 200^2) + 0.55 N(5000, 100^2) $$ .e., mixture normal centred around 3500 cal yr BP; another (slightly concentrated/narrower) normal centred around 5000 cal yr BP.  corresponding 50 radiocarbon ages simulated using IntCal20 calibration curve incorporating uncertainty calibration curve hypothetical measurement uncertainty: $$X_i | \\theta_i \\sim N(m(\\theta_i), \\rho(\\theta_i)^2 + \\sigma_{,\\textrm{lab}}^2),$$ \\(m(\\theta_i)\\) \\(\\rho(\\theta_i)\\) IntCal20 pointwise means uncertainties; \\(\\sigma_{,\\textrm{lab}}\\), simulated laboratory measurement uncertainty, fixed common value 25 \\({}^{14}\\)C yrs.  dataset included simply give quick--run examples.","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/two_normals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example artificial data - Mixture of Normal Phases — two_normals","text":"","code":"two_normals"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/reference/two_normals.html","id":"two-normals","dir":"Reference","previous_headings":"","what":"two_normals","title":"Example artificial data - Mixture of Normal Phases — two_normals","text":"data frame 50 rows 4 columns: c14_age simulated \\({}^{14}\\)C age (\\({}^{14}\\)C yr BP) c14_sig (fixed) \\({}^{14}\\)C age measurement uncertainty used simulation (set 25 \\({}^{14}\\)C yrs) f14c corresponding simulated values F\\({}^{14}\\)C concentration f14c_sig (fixed) corresponding F\\({}^{14}\\)C measurement uncertainty used simulation","code":""},{"path":"https://tjheaton.github.io/carbondate/reference/two_normals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Example artificial data - Mixture of Normal Phases — two_normals","text":"","code":"# Plotting calendar age density underlying two_normals # Useful for comparisons against estimation techniques weights_true <- c(0.45, 0.55) cluster_means_true_calBP <- c(3500, 5000) cluster_precisions_true <- 1 / c(200, 100)^2  # Create mixture density truedens <- function(t, w, truemean, trueprec) {   dens <- 0   for(i in 1:length(w)) {     dens <- dens + w[i] * dnorm(t, mean = truemean[i], sd = 1/sqrt(trueprec[i]))   }   dens }  # Visualise mixture curve(truedens(   x,   w = weights_true,   truemean = cluster_means_true_calBP,   trueprec = cluster_precisions_true),   from = 2500, to = 7000, n = 401,   xlim = c(7000, 2500),   xlab = \"Calendar Age (cal yr BP)\",   ylab = \"Density\",   col = \"red\" )"},{"path":[]},{"path":"https://tjheaton.github.io/carbondate/news/index.html","id":"carbondate-110","dir":"Changelog","previous_headings":"","what":"carbondate 1.1.0","title":"carbondate 1.1.0","text":"CRAN release: 2025-04-08 Added plot_lwd argument alter width lines plotting PP DPMM. Added PlotRateIndividualRealisation() function plot individual posterior realisations Poisson Process rate. Edited PlotPosteriorMeanRate() function users can plot posterior mean time conditioned specified number changes rate. recommend unless user independent knowledge number changes. conditioning done specifying n_changes argument. recommended default NULL (conditioning). Updated website explain can access posterior directly.","code":""},{"path":"https://tjheaton.github.io/carbondate/news/index.html","id":"carbondate-101","dir":"Changelog","previous_headings":"","what":"carbondate 1.0.1","title":"carbondate 1.0.1","text":"CRAN release: 2024-01-31 Fixing CRAN comments.","code":""},{"path":"https://tjheaton.github.io/carbondate/news/index.html","id":"carbondate-100","dir":"Changelog","previous_headings":"","what":"carbondate 1.0.0","title":"carbondate 1.0.0","text":"First release. Added NEWS.md file track changes package.","code":""}]
