<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Once a joint calibration function (any of PolyaUrnBivarDirichlet, WalkerBivarDirichlet
or PPcalibrate) has been run to calibrate a set of related radiocarbon
determinations, this function plots the posterior calendar age estimate for a given single
determination. Shown are a (direct) histogram of the posterior calendar ages generated by the MCMC
chain and also a (smoothed) kernel density estimate obtained using a Gaussian kernel. The highest
posterior density (HPD) interval is also shown for the interval width specified (default 2\(\sigma\)).
For more information read the vignettes: 
vignette("Non-parametric-summed-density", package = "carbondate") 
vignette("Poisson-process-modelling", package = "carbondate")
Note: The output of this function will provide different results from independent calibration
of the determination. By jointly, and simultaneously, calibrating all the related \({}^{14}\)C determinations
using the library functions we are able to share the available calendar information between the samples. This should result in improved
individual calibration.'><title>Plot Posterior Calendar Age Estimate for an Individual Determination after Joint Calibration — PlotCalendarAgeDensityIndividualSample • carbondate</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Posterior Calendar Age Estimate for an Individual Determination after Joint Calibration — PlotCalendarAgeDensityIndividualSample"><meta property="og:description" content='Once a joint calibration function (any of PolyaUrnBivarDirichlet, WalkerBivarDirichlet
or PPcalibrate) has been run to calibrate a set of related radiocarbon
determinations, this function plots the posterior calendar age estimate for a given single
determination. Shown are a (direct) histogram of the posterior calendar ages generated by the MCMC
chain and also a (smoothed) kernel density estimate obtained using a Gaussian kernel. The highest
posterior density (HPD) interval is also shown for the interval width specified (default 2\(\sigma\)).
For more information read the vignettes: 
vignette("Non-parametric-summed-density", package = "carbondate") 
vignette("Poisson-process-modelling", package = "carbondate")
Note: The output of this function will provide different results from independent calibration
of the determination. By jointly, and simultaneously, calibrating all the related \({}^{14}\)C determinations
using the library functions we are able to share the available calendar information between the samples. This should result in improved
individual calibration.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">carbondate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/carbondate.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Independent_calibration.html">Independent and Joint Radiocarbon Calibration</a>
    <a class="dropdown-item" href="../articles/Against_SPDs.html">Why Not to Use SPDs</a>
    <a class="dropdown-item" href="../articles/Non-parametric-summed-density.html">Non-Parametric Joint Density Estimation</a>
    <a class="dropdown-item" href="../articles/Poisson-process-modelling.html">Poisson Process Modelling</a>
    <a class="dropdown-item" href="../articles/determining-convergence.html">Determining Convergence</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TJHeaton/carbondate/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot Posterior Calendar Age Estimate for an Individual Determination after Joint Calibration</h1>
      <small class="dont-index">Source: <a href="https://github.com/TJHeaton/carbondate/blob/HEAD/R/PlotCalendarAgeDensityIndividualSample.R" class="external-link"><code>R/PlotCalendarAgeDensityIndividualSample.R</code></a></small>
      <div class="d-none name"><code>PlotCalendarAgeDensityIndividualSample.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Once a joint calibration function (any of <a href="PolyaUrnBivarDirichlet.html">PolyaUrnBivarDirichlet</a>, <a href="WalkerBivarDirichlet.html">WalkerBivarDirichlet</a>
or <a href="PPcalibrate.html">PPcalibrate</a>) has been run to calibrate a set of related radiocarbon
determinations, this function plots the posterior calendar age estimate for a given single
determination. Shown are a (direct) histogram of the posterior calendar ages generated by the MCMC
chain and also a (smoothed) kernel density estimate obtained using a Gaussian kernel. The highest
posterior density (HPD) interval is also shown for the interval width specified (default 2\(\sigma\)).</p>
<p>For more information read the vignettes: <br><code><a href="../articles/Non-parametric-summed-density.html">vignette("Non-parametric-summed-density", package = "carbondate")</a></code> <br><code><a href="../articles/Poisson-process-modelling.html">vignette("Poisson-process-modelling", package = "carbondate")</a></code></p>
<p><strong>Note:</strong> The output of this function will provide different results from independent calibration
of the determination. By jointly, and simultaneously, calibrating all the related \({}^{14}\)C determinations
using the library functions we are able to share the available calendar information between the samples. This should result in improved
individual calibration.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PlotCalendarAgeDensityIndividualSample</span><span class="op">(</span></span>
<span>  <span class="va">ident</span>,</span>
<span>  <span class="va">output_data</span>,</span>
<span>  calibration_curve <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_14C_age <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_cal_age_scale <span class="op">=</span> <span class="st">"BP"</span>,</span>
<span>  hist_resolution <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  density_resolution <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  interval_width <span class="op">=</span> <span class="st">"2sigma"</span>,</span>
<span>  bespoke_probability <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  n_burn <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  n_end <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  show_hpd_ranges <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_unmodelled_density <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_pretty <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>ident</dt>
<dd><p>The individual determination for which you want to plot the posterior
density estimate of the calendar age.</p></dd>


<dt>output_data</dt>
<dd><p>The return value either from one of the Bayesian non-parametric DPMM
functions (<a href="PolyaUrnBivarDirichlet.html">PolyaUrnBivarDirichlet</a> or <a href="WalkerBivarDirichlet.html">WalkerBivarDirichlet</a>); or
from the Poisson process modelling function (<a href="PPcalibrate.html">PPcalibrate</a>).</p></dd>


<dt>calibration_curve</dt>
<dd><p>This is usually not required since the name of the
calibration curve variable is saved in the output data. However, if the
variable with this name is no longer in your environment then you should pass
the calibration curve here. If provided, this should be a dataframe which
should contain at least 3 columns entitled <code>calendar_age</code>, <code>c14_age</code> and <code>c14_sig</code>.
This format matches <a href="intcal20.html">intcal20</a>.</p></dd>


<dt>plot_14C_age</dt>
<dd><p>Whether to use the radiocarbon age (\({}^{14}\)C yr BP) as
the units of the y-axis in the plot. Defaults to <code>TRUE</code>. If <code>FALSE</code> uses
F\({}^{14}\)C concentration instead.</p></dd>


<dt>plot_cal_age_scale</dt>
<dd><p>The calendar scale to use for the x-axis. Allowed values are
"BP", "AD" and "BC". The default is "BP" corresponding to plotting in cal yr BP.</p></dd>


<dt>hist_resolution</dt>
<dd><p>The distance between histogram breaks when plotting the individual
posterior calendar age density. Default is 5.</p></dd>


<dt>density_resolution</dt>
<dd><p>The distance between calendar ages for the returned smoothed calendar age
probability. Default is 1.</p></dd>


<dt>interval_width</dt>
<dd><p>The confidence intervals to show for the calibration curve and
for the highest posterior density ranges.
Choose from one of "1sigma" (68.3%), "2sigma" (95.4%) and "bespoke". Default is "2sigma".</p></dd>


<dt>bespoke_probability</dt>
<dd><p>The probability to use for the confidence interval
if <code>"bespoke"</code> is chosen above. E.g., if 0.95 is chosen, then the 95% confidence
interval is calculated. Ignored if <code>"bespoke"</code> is not chosen.</p></dd>


<dt>n_burn</dt>
<dd><p>The number of MCMC iterations that should be discarded as burn-in (i.e.,
considered to be occurring before the MCMC has converged). This relates to the number
of iterations (<code>n_iter</code>) when running the original update functions (not the thinned <code>output_data</code>).
Any MCMC iterations before this are not used in the calculations. If not given, the first half of
the MCMC chain is discarded. Note: The maximum value that the function will allow is
<code>n_iter - 100 * n_thin</code> (where <code>n_iter</code> and <code>n_thin</code> are the arguments given to
<a href="PolyaUrnBivarDirichlet.html">PolyaUrnBivarDirichlet</a> or <a href="WalkerBivarDirichlet.html">WalkerBivarDirichlet</a>)
which would leave only 100 of the (thinned) values in <code>output_data</code>.</p></dd>


<dt>n_end</dt>
<dd><p>The iteration number of the last sample in <code>output_data</code> to use in the calculations.
Assumed to be the total number of (thinned) realisations stored if not given.</p></dd>


<dt>show_hpd_ranges</dt>
<dd><p>Set to <code>TRUE</code> to also show the highest posterior density (HPD) range
on the plot.</p></dd>


<dt>show_unmodelled_density</dt>
<dd><p>Set to <code>TRUE</code> to also show the unmodelled density (i.e., the
result of independent calibration using <a href="CalibrateSingleDetermination.html">CalibrateSingleDetermination</a>) on the plot.
Default is <code>FALSE</code>.</p></dd>


<dt>plot_pretty</dt>
<dd><p>logical, defaulting to <code>TRUE</code>. If set <code>TRUE</code> then will select pretty plotting
margins (that create sufficient space for axis titles and rotates y-axis labels). If <code>FALSE</code> will
implement current user values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data frame with one column <code>calendar_age_BP</code> containing the calendar ages, and the other
column <code>probability</code> containing the (smoothed) kernel density estimate of the probability at that
calendar age.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="CalibrateSingleDetermination.html">CalibrateSingleDetermination</a> for independent calibration of a sample against
a calibration curve.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># NOTE 1: These examples are shown with a small n_iter to speed up execution.</span></span></span>
<span class="r-in"><span><span class="co"># When you run ensure n_iter gives convergence (try function default).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># NOTE 2: The examples only show application to  PolyaUrnBivarDirichlet output.</span></span></span>
<span class="r-in"><span><span class="co"># The function can also be used with WalkerBivarDirichlet and PPcalibrate output.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">polya_urn_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="PolyaUrnBivarDirichlet.html">PolyaUrnBivarDirichlet</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">two_normals</span><span class="op">$</span><span class="va">c14_age</span>,</span></span>
<span class="r-in"><span>    <span class="va">two_normals</span><span class="op">$</span><span class="va">c14_sig</span>,</span></span>
<span class="r-in"><span>    <span class="va">intcal20</span>,</span></span>
<span class="r-in"><span>    n_iter <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>    n_thin <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    show_progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Result for 15th determination</span></span></span>
<span class="r-in"><span><span class="fu">PlotCalendarAgeDensityIndividualSample</span><span class="op">(</span><span class="fl">15</span>, <span class="va">polya_urn_output</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PlotCalendarAgeDensityIndividualSample-1.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now change to show 1 sigma interval for HPD range and calibration curve</span></span></span>
<span class="r-in"><span><span class="co"># and plot in yr AD</span></span></span>
<span class="r-in"><span><span class="fu">PlotCalendarAgeDensityIndividualSample</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fl">15</span>,</span></span>
<span class="r-in"><span>    <span class="va">polya_urn_output</span>,</span></span>
<span class="r-in"><span>    plot_cal_age_scale <span class="op">=</span> <span class="st">"AD"</span>,</span></span>
<span class="r-in"><span>    interval_width <span class="op">=</span> <span class="st">"1sigma"</span>,</span></span>
<span class="r-in"><span>    show_hpd_ranges <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    show_unmodelled_density <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PlotCalendarAgeDensityIndividualSample-2.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot and then assign the returned probability</span></span></span>
<span class="r-in"><span><span class="va">posterior_dens</span> <span class="op">&lt;-</span> <span class="fu">PlotCalendarAgeDensityIndividualSample</span><span class="op">(</span><span class="fl">15</span>, <span class="va">polya_urn_output</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PlotCalendarAgeDensityIndividualSample-3.png" alt="" width="700" height="700"></span>
<span class="r-in"><span><span class="co"># Use this to find the mean posterior calendar age</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean</a></span><span class="op">(</span><span class="va">posterior_dens</span><span class="op">$</span><span class="va">calendar_age_BP</span>, <span class="va">posterior_dens</span><span class="op">$</span><span class="va">probability</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4995.079</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Timothy J Heaton, Sara Al-assam.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

