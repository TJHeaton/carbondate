<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='This function calibrates sets of multiple radiocarbon (\({}^{14}\)C)
determinations, and simultaneously summarises the resultant calendar age information.
This is achieved using Bayesian non-parametric density estimation,
providing a statistically-rigorous alternative to summed probability
distributions (SPDs).
It takes as an input a set of \({}^{14}\)C determinations and associated \(1\sigma\)
uncertainties, as well as the radiocarbon age calibration curve to be used. The samples
are assumed to arise from an (unknown) shared calendar age distribution \(f(\theta)\) that
we would like to estimate, alongside performing calibration of each sample.
The function models the underlying distribution \(f(\theta)\) as a Dirichlet process
mixture model (DPMM), whereby the samples are considered to arise from an unknown number of
distinct clusters. Fitting is achieved via MCMC.
It returns estimates for the calendar age of each individual radiocarbon sample; and broader
output (the weights, means and variances of the underpinning calendar age clusters)
that can be used by other library functions to provide a predictive estimate of the
shared calendar age density \(f(\theta)\).
For more information read the vignette: 
vignette("Non-parametric-summed-density", package = "carbondate")
Note: The library provides two slightly-different update schemes for the MCMC. In this particular function, updating of the DPMM is achieved by slice sampling
(Walker 2007). We recommend use of the alternative to this, implemented at PolyaUrnBivarDirichlet
Reference: 
Heaton, TJ. 2022. “Non-parametric Calibration of Multiple Related Radiocarbon
Determinations and their Calendar Age Summarisation.” Journal of the Royal Statistical
Society Series C: Applied Statistics 71 (5):1918-56. https://doi.org/10.1111/rssc.12599. 
Walker, SG. 2007. “Sampling the Dirichlet Mixture Model with Slices.” Communications in
Statistics - Simulation and Computation 36 (1):45-54. https://doi.org/10.1080/03610910601096262.'><title>Calibrate and Summarise Multiple Radiocarbon Samples via
a Bayesian Non-Parametric DPMM (with Walker Updating) — WalkerBivarDirichlet • carbondate</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calibrate and Summarise Multiple Radiocarbon Samples via
a Bayesian Non-Parametric DPMM (with Walker Updating) — WalkerBivarDirichlet"><meta property="og:description" content='This function calibrates sets of multiple radiocarbon (\({}^{14}\)C)
determinations, and simultaneously summarises the resultant calendar age information.
This is achieved using Bayesian non-parametric density estimation,
providing a statistically-rigorous alternative to summed probability
distributions (SPDs).
It takes as an input a set of \({}^{14}\)C determinations and associated \(1\sigma\)
uncertainties, as well as the radiocarbon age calibration curve to be used. The samples
are assumed to arise from an (unknown) shared calendar age distribution \(f(\theta)\) that
we would like to estimate, alongside performing calibration of each sample.
The function models the underlying distribution \(f(\theta)\) as a Dirichlet process
mixture model (DPMM), whereby the samples are considered to arise from an unknown number of
distinct clusters. Fitting is achieved via MCMC.
It returns estimates for the calendar age of each individual radiocarbon sample; and broader
output (the weights, means and variances of the underpinning calendar age clusters)
that can be used by other library functions to provide a predictive estimate of the
shared calendar age density \(f(\theta)\).
For more information read the vignette: 
vignette("Non-parametric-summed-density", package = "carbondate")
Note: The library provides two slightly-different update schemes for the MCMC. In this particular function, updating of the DPMM is achieved by slice sampling
(Walker 2007). We recommend use of the alternative to this, implemented at PolyaUrnBivarDirichlet
Reference: 
Heaton, TJ. 2022. “Non-parametric Calibration of Multiple Related Radiocarbon
Determinations and their Calendar Age Summarisation.” Journal of the Royal Statistical
Society Series C: Applied Statistics 71 (5):1918-56. https://doi.org/10.1111/rssc.12599. 
Walker, SG. 2007. “Sampling the Dirichlet Mixture Model with Slices.” Communications in
Statistics - Simulation and Computation 36 (1):45-54. https://doi.org/10.1080/03610910601096262.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">carbondate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/carbondate.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Independent_calibration.html">Independent and Joint Radiocarbon Calibration</a>
    <a class="dropdown-item" href="../articles/Against_SPDs.html">Why Not to Use SPDs</a>
    <a class="dropdown-item" href="../articles/Non-parametric-summed-density.html">Non-Parametric Joint Density Estimation</a>
    <a class="dropdown-item" href="../articles/Poisson-process-modelling.html">Poisson Process Modelling</a>
    <a class="dropdown-item" href="../articles/determining-convergence.html">Determining Convergence</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TJHeaton/carbondate/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calibrate and Summarise Multiple Radiocarbon Samples via
a Bayesian Non-Parametric DPMM (with Walker Updating)</h1>
      <small class="dont-index">Source: <a href="https://github.com/TJHeaton/carbondate/blob/HEAD/R/WalkerBivarDirichlet.R" class="external-link"><code>R/WalkerBivarDirichlet.R</code></a></small>
      <div class="d-none name"><code>WalkerBivarDirichlet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calibrates sets of multiple radiocarbon (\({}^{14}\)C)
determinations, and simultaneously summarises the resultant calendar age information.
This is achieved using Bayesian non-parametric density estimation,
providing a statistically-rigorous alternative to summed probability
distributions (SPDs).</p>
<p>It takes as an input a set of \({}^{14}\)C determinations and associated \(1\sigma\)
uncertainties, as well as the radiocarbon age calibration curve to be used. The samples
are assumed to arise from an (unknown) shared calendar age distribution \(f(\theta)\) that
we would like to estimate, alongside performing calibration of each sample.</p>
<p>The function models the underlying distribution \(f(\theta)\) as a Dirichlet process
mixture model (DPMM), whereby the samples are considered to arise from an unknown number of
distinct clusters. Fitting is achieved via MCMC.</p>
<p>It returns estimates for the calendar age of each individual radiocarbon sample; and broader
output (the weights, means and variances of the underpinning calendar age clusters)
that can be used by other library functions to provide a predictive estimate of the
shared calendar age density \(f(\theta)\).</p>
<p>For more information read the vignette: <br><code><a href="../articles/Non-parametric-summed-density.html">vignette("Non-parametric-summed-density", package = "carbondate")</a></code></p>
<p><strong>Note:</strong> The library provides two slightly-different update schemes for the MCMC. In this particular function, updating of the DPMM is achieved by slice sampling
(Walker 2007). We recommend use of the alternative to this, implemented at <a href="PolyaUrnBivarDirichlet.html">PolyaUrnBivarDirichlet</a></p>
<p><strong>Reference:</strong> <br>
Heaton, TJ. 2022. “Non-parametric Calibration of Multiple Related Radiocarbon
Determinations and their Calendar Age Summarisation.” <em>Journal of the Royal Statistical
Society Series C: Applied Statistics</em> <strong>71</strong> (5):1918-56. https://doi.org/10.1111/rssc.12599. <br>
Walker, SG. 2007. “Sampling the Dirichlet Mixture Model with Slices.” <em>Communications in
Statistics - Simulation and Computation</em> <strong>36</strong> (1):45-54. https://doi.org/10.1080/03610910601096262.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">WalkerBivarDirichlet</span><span class="op">(</span></span>
<span>  <span class="va">rc_determinations</span>,</span>
<span>  <span class="va">rc_sigmas</span>,</span>
<span>  <span class="va">calibration_curve</span>,</span>
<span>  F14C_inputs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  n_thin <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  use_F14C_space <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  slice_width <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  slice_multiplier <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  show_progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sensible_initialisation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lambda <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  nu1 <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  nu2 <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  A <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  B <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  alpha_shape <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  alpha_rate <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  mu_phi <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  calendar_ages <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  n_clust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rc_determinations</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>rc_determinations</dt>
<dd><p>A vector of observed radiocarbon determinations. Can be provided either as
\({}^{14}\)C ages (in \({}^{14}\)C yr BP) or as F\({}^{14}\)C concentrations.</p></dd>


<dt>rc_sigmas</dt>
<dd><p>A vector of the (1-sigma) measurement uncertainties for the
radiocarbon determinations. Must be the same length as <code>rc_determinations</code> and
given in the same units.</p></dd>


<dt>calibration_curve</dt>
<dd><p>A dataframe which must contain one column <code>calendar_age_BP</code>, and also
columns <code>c14_age</code> and <code>c14_sig</code> or <code>f14c</code> and <code>f14c_sig</code> (or both sets).
This format matches the curves supplied with this package, e.g., <a href="intcal20.html">intcal20</a>,
<a href="intcal13.html">intcal13</a>, which contain all 5 columns.</p></dd>


<dt>F14C_inputs</dt>
<dd><p><code>TRUE</code> if the provided <code>rc_determinations</code> are F\({}^{14}\)C
concentrations and <code>FALSE</code> if they are radiocarbon ages. Defaults to <code>FALSE</code>.</p></dd>


<dt>n_iter</dt>
<dd><p>The number of MCMC iterations (optional). Default is 100,000.</p></dd>


<dt>n_thin</dt>
<dd><p>How much to thin the MCMC output (optional). Will store every
<code>n_thin</code>\({}^\textrm{th}\) iteration. 1 is no thinning, while a larger number will result
in more thinning. Default is 10. Must choose an integer greater than 1. Overall
number of MCMC realisations stored will be \(n_{\textrm{out}} =
\textrm{floor}( n_{\textrm{iter}}/n_{\textrm{thin}}) + 1\) so do not choose
<code>n_thin</code> too large to ensure there are enough samples from the posterior to
use for later inference.</p></dd>


<dt>use_F14C_space</dt>
<dd><p>If <code>TRUE</code> (default) the calculations within the function are carried
out in F\({}^{14}\)C space. If <code>FALSE</code> they are carried out in \({}^{14}\)C
age space. We recommend selecting <code>TRUE</code> as, for very old samples, calibrating in
F\({}^{14}\)C space removes the potential affect of asymmetry in the radiocarbon age
uncertainty.
<em>Note:</em> This flag can be set independently of the format/scale on which
<code>rc_determinations</code> were originally provided.</p></dd>


<dt>slice_width</dt>
<dd><p>Parameter for slice sampling (optional). If not given a value
is chosen intelligently based on the spread of the initial calendar ages.
Must be given if <code>sensible_initialisation</code> is <code>FALSE</code>.</p></dd>


<dt>slice_multiplier</dt>
<dd><p>Integer parameter for slice sampling (optional).
Default is 10. Limits the slice size to <code>slice_multiplier * slice_width</code>.</p></dd>


<dt>show_progress</dt>
<dd><p>Whether to show a progress bar in the console during
execution. Default is <code>TRUE</code>.</p></dd>


<dt>sensible_initialisation</dt>
<dd><p>Whether to use sensible values to initialise the sampler
and an automated (adaptive) prior on \(\mu_{\phi}\) and (A, B) that is informed
by the observed <code>rc_determinations</code>. If this is <code>TRUE</code> (the recommended default), then
all the remaining arguments below are ignored.</p></dd>


<dt>lambda, nu1, nu2</dt>
<dd><p>Hyperparameters for the prior on the mean
\(\phi_j\) and precision \(\tau_j\) of each individual calendar age
cluster \(j\):
$$(\phi_j, \tau_j)|\mu_{\phi} \sim
\textrm{NormalGamma}(\mu_{\phi}, \lambda, \nu_1, \nu_2)$$ where
\(\mu_{\phi}\) is the overall cluster centering. Required if
<code>sensible_initialisation</code> is <code>FALSE</code>.</p></dd>


<dt>A, B</dt>
<dd><p>Prior on \(\mu_{\phi}\) giving the mean and precision of the
overall centering \(\mu_{\phi} \sim N(A, B^{-1})\). Required if <code>sensible_initialisation</code> is <code>FALSE</code>.</p></dd>


<dt>alpha_shape, alpha_rate</dt>
<dd><p>Shape and rate hyperparameters that specify
the prior for the Dirichlet Process (DP) concentration, \(\alpha\). This
concentration \(\alpha\) determines the number of clusters we
expect to observe among our \(n\) sampled objects. The model
places a prior on
\(\alpha \sim \Gamma(\eta_1, \eta_2)\), where \(\eta_1, \eta_2\) are
the <code>alpha_shape</code> and <code>alpha_rate</code>. A small \(\alpha\) means the DPMM is
more concentrated (i.e. we expect fewer calendar age clusters) while a large alpha means it is less
less concentrated (i.e. many clusters). Required if <code>sensible_initialisation</code> is <code>FALSE</code>.</p></dd>


<dt>mu_phi</dt>
<dd><p>Initial value of the overall cluster centering \(\mu_{\phi}\).
Required if <code>sensible_initialisation</code> is <code>FALSE</code>.</p></dd>


<dt>calendar_ages</dt>
<dd><p>The initial estimate for the underlying calendar ages
(optional). If supplied, it must be a vector with the same length as
<code>rc_determinations</code>.  Required if <code>sensible_initialisation</code> is <code>FALSE</code>.</p></dd>


<dt>n_clust</dt>
<dd><p>The number of clusters with which to initialise the sampler (optional). Must
be less than the length of <code>rc_determinations</code>. Default is 10 or the length
of <code>rc_determinations</code> if that is less than 10.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with 11 items. The first 8 items contain output of the model, each of
which has one dimension of size \(n_{\textrm{out}} =
\textrm{floor}( n_{\textrm{iter}}/n_{\textrm{thin}}) + 1\). The rows in these items store
the state of the MCMC from every \(n_{\textrm{thin}}\)\({}^\textrm{th}\) iteration:</p>


<dl><dt><code>cluster_identifiers</code></dt>
<dd><p>An \(n_{\textrm{out}}\) by
\(n_{\textrm{obs}}\) integer matrix. Provides the cluster allocation
(an integer between 1 and <code>n_clust</code>) for each observation on the relevant MCMC iteration.
Information on the state of these calendar age clusters (means, precisions, and weights)
can be found in the other output items.</p></dd>

<dt><code>alpha</code></dt>
<dd><p>A double vector of length \(n_{\textrm{out}}\) giving the Dirichlet Process
concentration parameter \(\alpha\).</p></dd>

<dt><code>n_clust</code></dt>
<dd><p>An integer vector of length \(n_{\textrm{out}}\) giving
the current number of clusters in the model.</p></dd>

<dt><code>phi</code></dt>
<dd><p>A list of length \(n_{\textrm{out}}\) each entry giving
a vector of the means of the current calendar age clusters \(\phi_j\).</p></dd>

<dt><code>tau</code></dt>
<dd><p>A list of length \(n_{\textrm{out}}\) each entry giving
a vector of the precisions of the current calendar age clusters \(\tau_j\).</p></dd>

<dt><code>weight</code></dt>
<dd><p>A list of length \(n_{\textrm{out}}\) each entry giving
the mixing weights of each calendar age cluster.</p></dd>

<dt><code>calendar_ages</code></dt>
<dd><p>An \(n_{\textrm{out}}\) by \(n_{\textrm{obs}}\)
integer matrix. Gives the current estimate for the calendar age of each individual
observation.</p></dd>

<dt><code>mu_phi</code></dt>
<dd><p>A vector of length \(n_{\textrm{out}}\) giving the overall
centering \(\mu_{\phi}\) of the calendar age clusters.</p></dd>


</dl><p>where \(n_{\textrm{obs}}\) is the number of radiocarbon observations, i.e.,
the length of <code>rc_determinations</code>.</p>


<p>The remaining items give information about the input data, input parameters (or
those calculated using <code>sensible_initialisation</code>) and the update_type</p>


<dl><dt><code>update_type</code></dt>
<dd><p>A string that always has the value "Walker".</p></dd>

<dt><code>input_data</code></dt>
<dd><p>A list containing the \({}^{14}\)C data used, and the name of
the calibration curve used.</p></dd>

<dt><code>input_parameters</code></dt>
<dd><p>A list containing the values of the fixed
hyperparameters <code>lambda</code>, <code>nu1</code>, <code>nu2</code>, <code>A</code>, <code>B</code>, <code>alpha_shape</code>, and
<code>alpha_rate</code>, and the slice parameters <code>slice_width</code> and
<code>slice_multiplier</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="PolyaUrnBivarDirichlet.html">PolyaUrnBivarDirichlet</a> for our preferred MCMC method to update the Bayesian DPMM
(otherwise an identical model); and <a href="PlotCalendarAgeDensityIndividualSample.html">PlotCalendarAgeDensityIndividualSample</a>,
<a href="PlotPredictiveCalendarAgeDensity.html">PlotPredictiveCalendarAgeDensity</a> and <a href="PlotNumberOfClusters.html">PlotNumberOfClusters</a>
to access the model output and estimate the calendar age information. <br><br>
See also <a href="PPcalibrate.html">PPcalibrate</a> for an an alternative (similarly rigorous) approach to
calibration and summarisation of related radiocarbon determinations using a variable-rate Poisson process</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># NOTE: These examples are shown with a small n_iter to speed up execution.</span></span></span>
<span class="r-in"><span><span class="co"># When you run ensure n_iter gives convergence (try function default).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">walker_output</span> <span class="op">&lt;-</span> <span class="fu">WalkerBivarDirichlet</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">two_normals</span><span class="op">$</span><span class="va">c14_age</span>,</span></span>
<span class="r-in"><span>    <span class="va">two_normals</span><span class="op">$</span><span class="va">c14_sig</span>,</span></span>
<span class="r-in"><span>    <span class="va">intcal20</span>,</span></span>
<span class="r-in"><span>    n_iter <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>    show_progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The radiocarbon determinations can be given as F14C concentrations</span></span></span>
<span class="r-in"><span><span class="va">walker_output</span> <span class="op">&lt;-</span> <span class="fu">WalkerBivarDirichlet</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">two_normals</span><span class="op">$</span><span class="va">f14c</span>,</span></span>
<span class="r-in"><span>    <span class="va">two_normals</span><span class="op">$</span><span class="va">f14c_sig</span>,</span></span>
<span class="r-in"><span>    <span class="va">intcal20</span>,</span></span>
<span class="r-in"><span>    F14C_inputs <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    n_iter <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>    show_progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Timothy J Heaton, Sara Al-assam.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

