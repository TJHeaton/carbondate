<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find the summed probability distribution (SPD) for a set of radiocarbon observations — FindSummedProbabilityDistribution • carbondate</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find the summed probability distribution (SPD) for a set of radiocarbon observations — FindSummedProbabilityDistribution"><meta name="description" content="Takes a set of radiocarbon determinations and uncertainties, independently
calibrates each one, and then averages the resultant calendar age estimates
to give the SPD estimate.
Important: This function should not be used for inference as SPDs are not statistically rigorous.
Instead use either of:
the Bayesian non-parametric summarisation approaches PolyaUrnBivarDirichlet
or WalkerBivarDirichlet;
or the Poisson process rate approach PPcalibrate
The SPD function provided here is only intended for comparison. We provide a inbuilt plotting option to show the SPD alongside the
determinations and the calibration curve.  "><meta property="og:description" content="Takes a set of radiocarbon determinations and uncertainties, independently
calibrates each one, and then averages the resultant calendar age estimates
to give the SPD estimate.
Important: This function should not be used for inference as SPDs are not statistically rigorous.
Instead use either of:
the Bayesian non-parametric summarisation approaches PolyaUrnBivarDirichlet
or WalkerBivarDirichlet;
or the Poisson process rate approach PPcalibrate
The SPD function provided here is only intended for comparison. We provide a inbuilt plotting option to show the SPD alongside the
determinations and the calibration curve.  "></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">carbondate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/carbondate.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Independent_calibration.html">Independent and Joint Radiocarbon Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/Against_SPDs.html">Why Not to Use SPDs</a></li>
    <li><a class="dropdown-item" href="../articles/Non-parametric-summed-density.html">Non-Parametric Joint Density Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/Poisson-process-modelling.html">Poisson Process Modelling</a></li>
    <li><a class="dropdown-item" href="../articles/determining-convergence.html">Determining Convergence</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TJHeaton/carbondate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Find the summed probability distribution (SPD) for a set of radiocarbon observations</h1>
      <small class="dont-index">Source: <a href="https://github.com/TJHeaton/carbondate/blob/v1.1.0/R/FindSummedProbabilityDistribution.R" class="external-link"><code>R/FindSummedProbabilityDistribution.R</code></a></small>
      <div class="d-none name"><code>FindSummedProbabilityDistribution.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes a set of radiocarbon determinations and uncertainties, independently
calibrates each one, and then averages the resultant calendar age estimates
to give the SPD estimate. <br><br><strong>Important:</strong> This function should not be used for inference as SPDs are not statistically rigorous.
Instead use either of:</p><ul><li><p>the Bayesian non-parametric summarisation approaches <a href="PolyaUrnBivarDirichlet.html">PolyaUrnBivarDirichlet</a>
or <a href="WalkerBivarDirichlet.html">WalkerBivarDirichlet</a>;</p></li>
<li><p>or the Poisson process rate approach <a href="PPcalibrate.html">PPcalibrate</a></p></li>
</ul><p>The SPD function provided here is only intended for comparison. We provide a inbuilt plotting option to show the SPD alongside the
determinations and the calibration curve. <br><br></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FindSummedProbabilityDistribution</span><span class="op">(</span></span>
<span>  <span class="va">calendar_age_range_BP</span>,</span>
<span>  <span class="va">rc_determinations</span>,</span>
<span>  <span class="va">rc_sigmas</span>,</span>
<span>  <span class="va">calibration_curve</span>,</span>
<span>  F14C_inputs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  plot_output <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_cal_age_scale <span class="op">=</span> <span class="st">"BP"</span>,</span>
<span>  interval_width <span class="op">=</span> <span class="st">"2sigma"</span>,</span>
<span>  bespoke_probability <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  denscale <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  plot_pretty <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-calendar-age-range-bp">calendar_age_range_BP<a class="anchor" aria-label="anchor" href="#arg-calendar-age-range-bp"></a></dt>
<dd><p>A vector of length 2 with the start and end
calendar age BP to calculate the SPD over. These two values must be in order
with start value less than end value, e.g., (600, 1700) cal yr BP.
The code will extend this range (by 400 cal yrs each side) for conservativeness</p></dd>


<dt id="arg-rc-determinations">rc_determinations<a class="anchor" aria-label="anchor" href="#arg-rc-determinations"></a></dt>
<dd><p>A vector of observed radiocarbon determinations. Can be provided either as
\({}^{14}\)C ages (in \({}^{14}\)C yr BP) or as F\({}^{14}\)C concentrations.</p></dd>


<dt id="arg-rc-sigmas">rc_sigmas<a class="anchor" aria-label="anchor" href="#arg-rc-sigmas"></a></dt>
<dd><p>A vector of the (1-sigma) measurement uncertainties for the
radiocarbon determinations. Must be the same length as <code>rc_determinations</code> and
given in the same units.</p></dd>


<dt id="arg-calibration-curve">calibration_curve<a class="anchor" aria-label="anchor" href="#arg-calibration-curve"></a></dt>
<dd><p>A dataframe which must contain one column <code>calendar_age_BP</code>, and also
columns <code>c14_age</code> and <code>c14_sig</code> or <code>f14c</code> and <code>f14c_sig</code> (or both sets).
This format matches the curves supplied with this package, e.g., <a href="intcal20.html">intcal20</a>,
<a href="intcal13.html">intcal13</a>, which contain all 5 columns.</p></dd>


<dt id="arg-f-c-inputs">F14C_inputs<a class="anchor" aria-label="anchor" href="#arg-f-c-inputs"></a></dt>
<dd><p><code>TRUE</code> if the provided <code>rc_determinations</code> are F\({}^{14}\)C
concentrations and <code>FALSE</code> if they are radiocarbon ages. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p>The distance between the calendar ages at which to calculate the calendar age probability.
Default is 1.</p></dd>


<dt id="arg-plot-output">plot_output<a class="anchor" aria-label="anchor" href="#arg-plot-output"></a></dt>
<dd><p><code>TRUE</code> if you wish to plot the determinations, the calibration curve,
and the SPD on the same plot. Defaults to <code>FALSE</code></p></dd>


<dt id="arg-plot-cal-age-scale">plot_cal_age_scale<a class="anchor" aria-label="anchor" href="#arg-plot-cal-age-scale"></a></dt>
<dd><p>Only for usage when <code>plot_output = TRUE</code>.
The calendar scale to use for the x-axis. Allowed values are "BP", "AD" and "BC". The default
is "BP", corresponding to plotting in cal yr BP.</p></dd>


<dt id="arg-interval-width">interval_width<a class="anchor" aria-label="anchor" href="#arg-interval-width"></a></dt>
<dd><p>Only for usage when <code>plot_output = TRUE</code>. The confidence intervals to show for the
calibration curve. Choose from one of "1sigma" (68.3%), "2sigma" (95.4%) and "bespoke". Default is "2sigma".</p></dd>


<dt id="arg-bespoke-probability">bespoke_probability<a class="anchor" aria-label="anchor" href="#arg-bespoke-probability"></a></dt>
<dd><p>The probability to use for the confidence interval
if "bespoke" is chosen above. E.g. if 0.95 is chosen, then the 95% confidence
interval is calculated. Ignored if "bespoke" is not chosen.</p></dd>


<dt id="arg-denscale">denscale<a class="anchor" aria-label="anchor" href="#arg-denscale"></a></dt>
<dd><p>Whether to scale the vertical range of the calendar age density plot
relative to the calibration curve plot (optional). Default is 3 which means
that the maximum SPD will be at 1/3 of the height of the plot.</p></dd>


<dt id="arg-plot-pretty">plot_pretty<a class="anchor" aria-label="anchor" href="#arg-plot-pretty"></a></dt>
<dd><p>logical, defaulting to <code>TRUE</code>. If set <code>TRUE</code> then will select pretty plotting
margins (that create sufficient space for axis titles and rotates y-axis labels). If <code>FALSE</code> will
implement current user values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with one column <code>calendar_age_BP</code> containing the calendar
ages, and the other column <code>probability</code> containing the probability at that
calendar age</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="PolyaUrnBivarDirichlet.html">PolyaUrnBivarDirichlet</a>,
<a href="WalkerBivarDirichlet.html">WalkerBivarDirichlet</a> for rigorous non-parametric Bayesian alternatives; and
<a href="PPcalibrate.html">PPcalibrate</a> for a rigorous variable-rate Poisson process alternative.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># An example using 14C age BP and the IntCal 20 curve</span></span></span>
<span class="r-in"><span><span class="va">SPD</span> <span class="op">&lt;-</span> <span class="fu">FindSummedProbabilityDistribution</span><span class="op">(</span></span></span>
<span class="r-in"><span>   calendar_age_range_BP<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">1700</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rc_determinations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">602</span>, <span class="fl">805</span>, <span class="fl">1554</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rc_sigmas<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">34</span>, <span class="fl">45</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   calibration_curve<span class="op">=</span><span class="va">intcal20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">SPD</span>, type <span class="op">=</span> <span class="st">"l"</span>,</span></span>
<span class="r-in"><span>   xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">SPD</span><span class="op">$</span><span class="va">calendar_age_BP</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   xlab <span class="op">=</span> <span class="st">"Calendar Age (cal yr BP)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FindSummedProbabilityDistribution-1.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using the inbuilt plotting features</span></span></span>
<span class="r-in"><span><span class="va">SPD</span> <span class="op">&lt;-</span> <span class="fu">FindSummedProbabilityDistribution</span><span class="op">(</span></span></span>
<span class="r-in"><span>   calendar_age_range_BP<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">1700</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rc_determinations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">602</span>, <span class="fl">805</span>, <span class="fl">1554</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rc_sigmas<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">34</span>, <span class="fl">45</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   calibration_curve<span class="op">=</span><span class="va">intcal20</span>,</span></span>
<span class="r-in"><span>   plot_output <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   interval_width <span class="op">=</span> <span class="st">"bespoke"</span>,</span></span>
<span class="r-in"><span>   bespoke_probability <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FindSummedProbabilityDistribution-2.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># An different example using F14C concentrations and the IntCal 13 curve</span></span></span>
<span class="r-in"><span><span class="va">SPD</span> <span class="op">&lt;-</span> <span class="fu">FindSummedProbabilityDistribution</span><span class="op">(</span></span></span>
<span class="r-in"><span>   calendar_age_range_BP<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">2100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rc_determinations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.85</span>, <span class="fl">0.9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rc_sigmas<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.015</span>, <span class="fl">0.012</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   F14C_inputs<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   calibration_curve<span class="op">=</span><span class="va">intcal13</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">SPD</span>, type <span class="op">=</span> <span class="st">"l"</span>,</span></span>
<span class="r-in"><span>   xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">SPD</span><span class="op">$</span><span class="va">calendar_age_BP</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   xlab <span class="op">=</span> <span class="st">"Calendar Age (cal yr BP)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FindSummedProbabilityDistribution-3.png" alt="" width="700" height="700"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Timothy J Heaton, Sara Al-assam.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

